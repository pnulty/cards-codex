!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="7ea793de-f2f5-393b-98b8-915e51f8cab7")}catch(e){}}();
define(["exports","react","./c_conversions_actions_unzip","./c_extensions_extensions_utils","./e_ui_page_files_router","./c_core_i18n","./c_pap-events_previews_select_doc_page","./c_ui_sprite","./c_action_bar_action_bar_constants","./c_dig-icons_assets_ui-icon_line_slides","./c_dig-icons_assets_ui-icon_line_show","./c_dig-icons_assets_ui-icon_line_rewind","./c_dig-icons_assets_ui-icon_line_restore","./c_dig-icons_assets_ui-icon_line_upload","./c_extensions_data_selectors"],(function(e,t,n,o,i,s,r,c,a,l,p,u,d,m,A){"use strict";function f(e){return e&&e.__esModule?e:{default:e}}var h=f(t);class _ extends h.default.Component{constructor(e){super(e),this.handleMouseOver=()=>{clearTimeout(this.timer),this.timer=setTimeout((()=>{this.props.bylines&&(this.setState({show:!0}),this.props.onDidShow())}),this.props.delay)},this.handleMouseOut=()=>{this.setState({show:!1}),clearTimeout(this.timer)},this.triggerRef=h.default.createRef(),this.state={show:!1}}componentWillUnmount(){clearTimeout(this.timer)}render(){const{children:e,bylines:t,isInActionBar:n}=this.props,o=h.default.Children.only(e);return t?h.default.createElement(h.default.Fragment,null,h.default.createElement(i.Tooltip.Control,{triggerRef:this.triggerRef,open:this.state.show,placement:n?"right":"left"},(e=>{if(e)return e.length>1?h.default.createElement("ul",{className:"extensions-byline-list"},e.map((e=>h.default.createElement("li",{key:e,className:"extensions-byline-list-item"},e)))):h.default.createElement("div",{className:"extensions-byline"},e[0])})(t)),h.default.cloneElement(o,{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,ref:this.triggerRef})):o}}_.defaultProps={delay:500},_.displayName="ExtensionsBylineTooltip";class g extends h.default.Component{render(){const{unityOptions:e,legacyCloudEditorOptions:t,cloudEditorAppActions:s,bylines:m,currentSession:A,previewOption:f,openInReplayOption:g,openInDesktopOption:E,isInActionBar:y,goToFolderOption:O,wrapValuesForActionBar:I,openInNewTabOption:w,openInQuickViewOption:x}=this.props,v=e=>I?o.toActionBarValue(e):e,C=t.map((e=>{const{type:t}=e,o=t===r.OpenButtonAction.OPEN_WITH_CLOUD_DOC?"cloud_doc":"wopi";return h.default.createElement(i.Menu.ActionItem,{key:e.text,value:v(e),withLeftAccessory:e.spriteName?h.default.createElement(c.Sprite,{group:"web",name:e.spriteName,alt:""}):h.default.createElement("img",{alt:"",src:e.iconUrl,width:24,height:24})},h.default.createElement(_,{isInActionBar:y,bylines:m[o],onDidShow:n.handleShowByline(o,A),key:e.text},h.default.createElement("span",null,e.text)))})),M=e.map((e=>h.default.createElement(i.Menu.ActionItem,{key:e.text,value:v(e),withLeftAccessory:function(e){return"ow_desktop"===e.spriteName&&e.type===r.OpenButtonAction.UNITY_FILE?-1!==e.text.indexOf("Dropbox")?h.default.createElement(i.UIIcon,{src:i.DropboxLine}):h.default.createElement(i.UIIcon,{src:i.OpenLine}):h.default.createElement(c.Sprite,{group:"web",name:e.spriteName||"",alt:""})}(e)},e.text)));let S=!1;const k=s.map((e=>{S||(S=o.isWopiAction(e.appAction));const t=e.appAction.handler.editor_name;return h.default.createElement(i.Menu.ActionItem,{key:e.appAction.description,value:v(e),withLeftAccessory:h.default.createElement("img",{alt:"",src:e.appAction.icon.url,width:24,height:24})},h.default.createElement(_,{isInActionBar:y,bylines:m[t],onDidShow:n.handleShowByline(t,A),key:e.appAction.description},h.default.createElement("span",null,e.appAction.description)))})),b=f&&h.default.createElement(i.Menu.ActionItem,{key:f.text,value:v(f),withLeftAccessory:h.default.createElement(i.UIIcon,{src:p.ShowLine})},f.text),B=g&&h.default.createElement(i.Menu.ActionItem,{key:g.text,value:v(g),withLeftAccessory:h.default.createElement(i.UIIcon,{src:i.DropboxReplayLine})},g.text),F=E&&h.default.createElement(i.Menu.ActionItem,{key:E.text,value:v(E),withLeftAccessory:h.default.createElement(i.UIIcon,{src:a.mac?u.FinderLine:i.FileExplorerLine})},E.text),L=w&&h.default.createElement(i.Menu.ActionItem,{key:w.text,value:v(w),withLeftAccessory:h.default.createElement(i.UIIcon,{src:d.GlobeLine})},w.text),T=O&&h.default.createElement(i.Menu.ActionItem,{key:O.text,value:v(O),withLeftAccessory:h.default.createElement(i.UIIcon,{src:l.FolderShowLine})},O.text),U=x&&h.default.createElement(i.Menu.ActionItem,{key:x.text,value:v(x),withLeftAccessory:h.default.createElement(i.UIIcon,{src:l.SidebarShowRightLine})},x.text),N=M.length>0||C.length>0||k.length>0||!!L||!!b||!!B||!!F||!!T||!!U;return S?N&&h.default.createElement(i.Menu.Segment,{key:"open-options"},k,L,T,M,C,b,U,B,F):N&&h.default.createElement(i.Menu.Segment,{key:"open-options"},L,T,M,C,k,b,U,B,F)}}g.displayName="UnityAndCloudEditorsComponent";const E=i.requireCssWithComponent(g,["/static/metaserver/static/css/app_actions/index-vflR8Wunv.css","/static/metaserver/static/css/dig-components/index.web-vflaJWt-u.css"]);class y extends h.default.Component{constructor(e){super(e),this.createAppActionClickHandler=e=>()=>{var t,i;const{file:s,user:c,featureFlags:a,telemetryContext:l}=this.props;if(o.redirectToActionOrShowAuth(c,[s],e,a,l,void 0),"redirect"===e.handler[".tag"]){const t=n.getAppActionExtras(e);n.logEvent(this.props.currentSession,"select_action",{menu_version:2,...t})}else if("cloud_editor"===e.handler[".tag"]){const t={};o.isWopiAction(e)?(t.type=r.OpenButtonAction.OPEN_WITH,t.userAction=r.OpenInUserAction.OpenInOfficeOnline):t.type=r.OpenButtonAction.OPEN_WITH_CLOUD_DOC,n.logEvent(this.props.currentSession,"select_legacy_action",t)}null===(i=(t=this.props).onExtensionClick)||void 0===i||i.call(t,e)},this.wrapperForAction=e=>({appAction:e,handler:this.createAppActionClickHandler(e),userAction:r.OpenInUserAction.OpenWithAppAction,actionName:e.description}),this.renderActionRow=e=>{const t=e.icon;let n;n=t.is_static?o.genericAppIcon:t.url;const s=e.description,r=this.props.isInActionBar?o.toActionBarValue(this.wrapperForAction(e)):this.wrapperForAction(e);return h.default.createElement(i.Menu.ActionItem,{key:e.id,value:r,withLeftAccessory:h.default.createElement("img",{alt:"",src:n,width:24,height:24})},s)},this.renderUnpromotedActions=(e,t)=>{const{user:c,file:a,categoryIdToInfos:l,featureFlags:p,currentSession:u,telemetryContext:d,isInActionBar:m}=this.props,A=e.length>0,f={handler:()=>{const i=[...e,...t];o.showExtensionsMiniDirectoryModal(s.intl.formatMessage({id:"KVD2SP",defaultMessage:"Open or edit with these apps"}),c,a,i,l,p,d,u,void 0),n.logEvent(u,A?"select_show_more":"select_add_app",{surface:d&&d.surface,userAction:A?r.OpenInUserAction.OpenMoreApps:r.OpenInUserAction.OpenAddApps})}},_=m?o.toActionBarValue(f):f;return h.default.createElement(i.Menu.ActionItem,{key:s.intl.formatMessage({id:"R/67N/",defaultMessage:"Show more"}),value:_,withLeftAccessory:A&&!m?null:h.default.createElement(i.UIIcon,{src:i.AddCircleLine})},A?s.intl.formatMessage({id:"Gevpqz",defaultMessage:"Connect more apps"}):s.intl.formatMessage({id:"XFA09U",defaultMessage:"Connect apps"}))}}render(){const{appActions:e,openOptions:t,bylines:s,currentSession:r,isInActionBar:c}=this.props,a=n.getOpenOptionsWithLogging(t,r),{unityOptions:l,cloudEditorOptions:p,previewOption:u,openInReplayOption:d,openInDesktopOption:A,goToFolderOption:f,openInNewTabOption:_,openInQuickViewOption:g,installDropboxAppOption:y,manageAsAdminOption:O}=n.partitionOptions(a),{cloudEditors:I,installedActions:w,unpromotedActions:x}=n.partitionActions(e),v=w.length>0,C=x.length>0,M=e=>c?o.toActionBarValue(e):e;return h.default.createElement(h.default.Fragment,null,y&&h.default.createElement(i.Menu.Segment,{withLabel:y.withLabel},h.default.createElement(i.Menu.ActionItem,{key:y.text,value:M(y),withLeftAccessory:h.default.createElement(i.UIIcon,{src:m.DownloadLine})},y.text)),h.default.createElement(E,{isInActionBar:c,unityOptions:l,legacyCloudEditorOptions:p,cloudEditorAppActions:I.map((e=>this.wrapperForAction(e))),bylines:s,currentSession:r,previewOption:u,openInReplayOption:d,openInNewTabOption:_,openInDesktopOption:A,goToFolderOption:f,openInQuickViewOption:g,wrapValuesForActionBar:!!c}),O&&h.default.createElement(i.Menu.Segment,null,h.default.createElement(i.Menu.ActionItem,{key:O.text,value:M(O),withLeftAccessory:h.default.createElement(i.UIIcon,{src:i.AdminConsoleLine})},O.text)),c&&(v||C)&&h.default.createElement(i.Menu.Segment,null,w.map((e=>this.renderActionRow(e))),this.renderUnpromotedActions(w,x)),!c&&v&&h.default.createElement(i.Menu.Segment,{key:"installed-actions"},w.map((e=>this.renderActionRow(e)))),!c&&C&&h.default.createElement(i.Menu.Segment,null,this.renderUnpromotedActions(w,x)))}}y.displayName="BrowseFilePopoverContentComponent";const O=i.requireCssWithComponent(y,["/static/metaserver/static/css/app_actions/index-vflR8Wunv.css"]);class I extends h.default.Component{constructor(e){super(e),this.createActionClickHandler=e=>()=>{if("cloud_editor"===e.handler[".tag"]){const t=e.handler.editor_name;if(i.isOfficeOnlineEditor(t))return i.openWithOfficeOnline(this.props.file.file_id,t,"shared_file_popover_content"),void n.logEvent(this.props.currentSession,"select_legacy_action",{type:r.OpenButtonAction.OPEN_WITH});i.UDCL.logEvent("cloud_docs/logic_cleanup",{tags:{editor:t,function:"shared_file_popover_content_component"}});const s=o.isWopiAction(e)?r.OpenButtonAction.OPEN_WITH:r.OpenButtonAction.OPEN_WITH_CLOUD_DOC;n.logEvent(this.props.currentSession,"select_legacy_action",{type:s});const c=i.UserActionSourceType.WEB_PREVIEW,a=o.cloudEditorNameToParams(t);i.openWithCloudEditor(i.fileToOpenWithParams(this.props.file),this.props.user,a,!1,c)}}}render(){if(0===this.props.openOptions.length&&0===this.props.cloudEditorAppActions.length)return null;const e=this.props.cloudEditorAppActions.map((e=>({appAction:e,handler:this.createActionClickHandler(e),userAction:r.OpenInUserAction.OpenWithAppAction,actionName:e.description})));return h.default.createElement(E,{unityOptions:[],legacyCloudEditorOptions:this.props.openOptions,cloudEditorAppActions:e,bylines:{},wrapValuesForActionBar:!!this.props.isInActionBar})}}I.displayName="SharedFilePopoverContentComponent";const w=i.requireCssWithComponent(I,["/static/metaserver/static/css/app_actions/index-vflR8Wunv.css"]),x=e=>{const{file:t,user:s,telemetryContext:r,extraOptions:c,isInActionBar:a,previewActionHandler:l,openDesktopActionHandler:p,goToFolderActionHandler:u,replayActionHandler:d,openInNewTabActionHandler:m,quickViewActionHandler:f,onExtensionClick:_,installDropboxAppActionHandler:g,manageAsAdminActionHandler:E}=e,y=i.useAppActions().data,I=A.getOpenActionsForFile(y.actions,t),x=n.parseActionsForUserResult(y),v=x.bylines,C=y.category_infos,M=x.featureFlags,S=n.useUnity(t,s),k=o.getCategoryIdToInfos(C),b=o.getOpenOptionsForFile({file:t,unityInfo:S,extraOptions:c,user:s,isInActionBar:a,previewActionHandler:l,openDesktopActionHandler:p,goToFolderActionHandler:u,replayActionHandler:d,openInNewTabActionHandler:m,quickViewActionHandler:f,installDropboxAppActionHandler:g,manageAsAdminActionHandler:E}),B=r&&(e.currentSession||n.createTelemetryClient({component:"menu_v2"}).session({surface:r.surface,ext:n.getPiiSafeExtension(A.getFileExt(t)||""),feature_flags:M}));if(i.isBrowseFile(t)&&I&&(I.length>0||b.length>0))return h.default.createElement(O,{file:t,user:s,openOptions:b,appActions:I,bylines:v,categoryIdToInfos:k,featureFlags:M,telemetryContext:r,currentSession:B,isInActionBar:a,onExtensionClick:_});if(i.isSharedFile(t)){const{cloudEditors:e}=n.partitionActions(I||[]);return h.default.createElement(w,{openOptions:b,cloudEditorAppActions:e,file:t,user:s,currentSession:B,isInActionBar:a})}return null};x.displayName="ExtensionsPopoverContent",e.ExtensionsPopoverContent=x}));
//# sourceMappingURL=c_extensions_extensions_popover_content.js-vflsIUoQW.map

//# debugId=7ea793de-f2f5-393b-98b8-915e51f8cab7