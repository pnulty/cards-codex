!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="5239313f-4c8f-3182-adad-0492c38bce00")}catch(e){}}();
define(["require","exports","react","./e_ui_page_files_router","./c_edison_ui_spa_timing_logger","./c_action_bar_action_bar_constants","./c_core_i18n","./c_sharing_async_share_modal_util","./c_grant-access_browse_integration_async-show-grant-access","./c_api_v2_redux_file_viewer","./c_google_one_tap_lib","./c_integrations_hellosign_deep_integration_util","./c_download_components_download-warning-modal","./c_team_discovery_suggest_refresh_view_r2j_modal_utils","./c_flux_action_type","./c_pap-events_replay_shown_modal","./e_data_modules_stormcrow","./c_signup_signin_helpers"],(function(e,t,n,a,i,r,o,s,l,c,d,u,_,f,g,m,p,h){"use strict";function w(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var S=w(n);const E=({file:e,user:t,shareEmail:n,shareModalVariant:i,senderReminderVariant:r})=>(S.useEffect((()=>{if(a.isBrowseFile(e)&&(n||i&&i!==a.ShareModalVariant.closed&&t))if(i!==a.ShareModalVariant.manageAccess||n||e.is_unmounted){const i=n?n.split(","):[],o=()=>s.asyncShowPrefilledShareModal({user:t,sharePrefillEmails:i,content:e,extras:{origin:a.SHARE_ACTION_ORIGIN_TYPE.GRANT_ACCESS,senderReminderVariant:r}});l.asyncShowGrantAccess({fileOrFolder:e,user:t,prefillContacts:null!=i?i:[],actionSurface:"previews",actionElement:"grant_access",sessionId:Math.random().toString(),onFallback:o,shareModalExtras:{origin:a.SHARE_ACTION_ORIGIN_TYPE.GRANT_ACCESS}})}else s.asyncShowManageAccessModal(t,e,a.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE)}),[e,t,n,i,r]),null);E.displayName="ShareModalHandlerInternal";const v=e=>S.createElement(S.Suspense,{fallback:null},S.createElement(E,{...e}));v.displayName="ShareModalHandler";const I=({children:e})=>{const t=S.default.useRef(null),n=S.default.useRef(null);return S.default.useEffect((()=>{a.Snackbar.manager=a.Snackbar.manager?a.Snackbar.manager:t.current}),[]),S.default.createElement("div",{ref:n},e,S.default.createElement(a.SnackbarManager,{ref:t,getParentElement:()=>n.current}))};I.displayName="SnackbarManagerContainer";const P="copy_to_dropbox",b="save_as",A="save_as_action",C="download",O="from_auth",T="comment";function y(){a.shouldUseReactRouter()||window.location.pathname.startsWith("/scl/fi/")||window.location.pathname.startsWith("/s/")||a.reload()}const R=a.shouldUseReactRouter()?a.useLocation:()=>null,D=({file:t,shareModalVariant:n,onCloseUrl:s,redirectOnClose:l,isEmbedded:d,brandingInfo:p,encryptionOptions:h,sharedLinkInfo:w,shareToken:E,sharePermission:D,fileViewOrigin:k,appDownloadInterstitialDismissed:N,initialPreviewSourceContext:M,hidePageChrome:V,reduceUpsellsFromLinkOwner:F,outOfQuota:L,onMobileInterstitialDismissed:x,deviceId:U,userPresentableVerdict:G,openInAppData:B,viewer:W,joinableTeamInfo:H,senderInfo:K,grantBook:q})=>{var j;S.default.useEffect((()=>{const e=a.get_timer();null===e.timeToInteractive()&&e.markTimeToInteractive()}),[]);const Y=m.getActiveUserId(),Q=S.default.useMemo((()=>Y?W.get_user_by_id(Y):W.work_user||W.personal_user),[Y,W]),{openInHelloSignSrc:$,urlSourceContext:J,copyToDropbox:z,shareEmail:X,saveAs:Z,saveAsAction:ee,downloadParam:te,fromAuth:ne,comment:ae,senderReminderVariant:ie}=S.default.useMemo((()=>{var e,t,n;const a=new URLSearchParams(window.location.search);return{openInHelloSignSrc:null!==(e=a.get("hellosign"))&&void 0!==e?e:void 0,urlSourceContext:a.get("context"),copyToDropbox:a.has(P),shareEmail:null!==(t=a.get("share_email"))&&void 0!==t?t:void 0,saveAs:a.get(b),saveAsAction:a.get(A),downloadParam:a.get(C),fromAuth:a.get(O),comment:a.get(T),senderReminderVariant:null!==(n=a.get("sender_reminder_variant"))&&void 0!==n?n:void 0}}),[]);a.usePreviewTimingSession();const re=J===a.SourceContext.UngatedEditor?a.SourceContext.UngatedEditor:M,oe=void 0!==Q&&k===a.FileViewOriginType.SHARE_PAGE,se=k===a.FileViewOriginType.SHARED_LINK_PAGE,le=k===a.FileViewOriginType.PAPER&&d,ce=oe?a.SDKPreviewSurface.INBAND_SHARE:le?a.SDKPreviewSurface.SHARED_LINK_EMBED:se?a.SDKPreviewSurface.SHARED_LINK:void 0,[de,ue]=S.default.useState(t),_e=a.useCompatNavigate(),fe=R();S.default.useEffect((()=>(window.addEventListener("popstate",y),()=>{window.removeEventListener("popstate",y)})),[]),a.PreviewsEventLogger.mark(a.PreviewsTimingEvents.CONTAINER_CODE_START),a.usePrefetchIntegrationsData(),S.default.useEffect((()=>{i.markApplicationStart(),a.PreviewsEventLogger.mark(a.PreviewsTimingEvents.CONTAINER_MOUNT)}),[]);const ge=S.default.useMemo((()=>{if(s)return e=>{const{path:t,qargs:n}=a.DBHistory.deconstruct_url(s);if(a.shouldUseReactRouter())if("default"===(null==fe?void 0:fe.key)){const e=document.referrer;e&&e.includes("/search")?window.history.back():_e(s)}else _e(-1);else l?"fileDeleted"===e?a.redirect(t):a.redirect(s):a.DBHistory.push_state(t,n)}}),[null==fe?void 0:fe.key,_e,s,l]),me=S.default.useCallback(((e,t)=>{if(e.revision_id===de.revision_id&&a.isBrowseFile(de))if(t){const e=a.getUpdatedFile(de,t);ue(e);const n=window.location.pathname.replace(encodeURI(de.fq_path),encodeURI(e.fq_path));a.DBHistory.replace_state(n)}else null==ge||ge("fileDeleted")}),[de,ge]),pe=S.default.useCallback(((t,n,i)=>new Promise((function(t,n){e(["./c_portable_save_as_copy"],t,n)})).then((({portableSaveAsCopy:r})=>r({file:de,user:t,shareToken:n},{onNetworkRequest:()=>{new Promise((function(t,n){e(["./c_portable_save_as_copy_snackbars"],t,n)})).then((({saveCopySnackBarInProgress:e})=>{e(a.PREVIEWS_SNACKBAR_ID)}))}},!1,i)))),[de]),he=S.default.useCallback(((t,n,a,i,r,o)=>new Promise((function(t,n){e(["./c_file_actions_portable_file_conversion"],t,n)})).then((({portableFileConversion:e})=>e({file:t,sharedLinkInfo:n,sharePermission:a,shareToken:i,user:r,actionToTrigger:ee,source:o})))),[ee]),we=S.default.useCallback((()=>{const e=new URL(window.location.href);e.searchParams.delete(O),e.searchParams.delete(b),e.searchParams.delete(A),e.searchParams.delete(C),e.searchParams.delete(P),e.searchParams.delete(T),e.searchParams.delete("qr"),e.searchParams.delete("set"),e.searchParams.delete("signup_tag"),e.searchParams.delete("sharer_id"),window.history.replaceState(e.href,"",e.href)}),[]),Se=S.default.useMemo((()=>((e,t,n,a,i,o)=>"register"===e&&!!t&&!!n&&!!n.rlkey&&a.bytes<2e9&&!i&&!o&&!r.is_supported_mobile_browser())(ne,Q,E,de,Z,ae)),[ae,de,ne,Z,E,Q]);c.useStoreSharedLinkInfo({sharedLinkInfo:w,shouldRedirectToAutoSave:Se}),S.default.useEffect((()=>{we(),_.setGrantBookInSessionStorage(q);const n=Q&&te&&!r.is_mobile_or_tablet();Se?((t,n,i,r,o)=>{const s=()=>{r(t,n,a.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_AUTO_SAVE)};o?new Promise((function(t,n){e(["./c_file_viewer_common_download_utils"],t,n)})).then((function(e){return e.download_utils_esnext})).then((({initiateDownload:e})=>e(i,t,{onSuccess:s,onError:s}))):s()})(Q,E,t,pe,!!n):(J===a.SourceContext.PdfEditor&&a.UserSurvey.trackEvent("save_pdf_editor","previews"),z&&Q&&E&&pe(Q,E),Z&&Q&&he(t,w,D,E,Q,"preview"),n&&new Promise((function(t,n){e(["./c_file_viewer_common_download_utils"],t,n)})).then((function(e){return e.download_utils_esnext})).then((({postAuthSuccessAndDownload:e,logSharingTiburonEvent:n})=>{n(g.TiburonEventName.DownloadContinuedFromAuth,t,Q.id),e(t,"register"===ne,Q)})),a.get_uri().getQuery().sync_from_docsend&&function(e){setTimeout((()=>{a.Snackbar.show(S.default.createElement(a.Snackbar,{title:o.intl.formatMessage({id:"d93ce2",defaultMessage:"Always save signed documents in Dropbox? You can change this anytime in DocSend settings."}),closeButtonText:o.intl.formatMessage({id:"6NGNJV",defaultMessage:"Not now"}),actionButtonText:o.intl.formatMessage({id:"gM7OF1",defaultMessage:"Yes"}),id:"sync-from-docsend",onActionClick:()=>{e&&a.WebUserActionLog.log(e.id,a.WebUserActionLogEvent.CLICK_DOCSEND_SNACKBAR_YES,{}),window.open("https://docsend.com/settings/company/users/redirect?anchor=apps-settings","_blank")},onCloseClick:()=>{e&&a.WebUserActionLog.log(e.id,a.WebUserActionLogEvent.CLICK_DOCSEND_SNACKBAR_NOT_NOW,{})}}))}),0)}(Q))}),[]),S.default.useEffect((()=>{d&&a.setGlobalSidebarIsForbiddenFromShowing(!0)}),[d]),S.default.useEffect((()=>{if(Y&&N&&H&&H.setRedesignFeature&&H.setRedesignVariant){["V1","V2"].includes(H.setRedesignVariant)&&f.asyncShowR2jModal({surface:a.InviteLoggerActionSurface.filePreview,userId:Y,isFolder:!1,contentName:a.getFilename(t),joinableTeamInfo:H,senderInfo:K})}}),[N,H,K,t,Y]);const Ee=re===a.SourceContext.FileLocking;let ve;if($){a.UDCL.logEvent(a.PAP_NavigateTo_Sign({actionSurface:"desktop_file_context_menu"}));const e=u.isOpenWithSelfSign($);u.shouldUsePDFEditorFromDesktop(a.getExtension({fq_path:null!==(j=t.fq_path)&&void 0!==j?j:""}))?ve={source:u.getDesktopDeepLinkSource($),highlight:e?"sign":"send_for_signature"}:u.reportDILaunchAttempt("file_preview_side_bar")}const Ie="register"===ne,Pe=ce?S.default.createElement(I,null,S.default.createElement(c.FileViewerWithCSS,{closeFile:ge,file:de,previewContentOnly:V,sharedLinkInfo:w,sharePermission:D,shareToken:E,brandingInfo:p,user:Q,encryptionOptions:h,previewSurface:ce,canShowFileFlippers:!1,hideOpenInAppInterstitial:!!N,fileViewOrigin:k,sourceContext:re,outOfQuota:L,onMobileInterstitialDismissed:x,deviceId:U,hideTour:Se,fromRegister:Ie,userPresentableVerdict:G,openInAppData:B,reduceUpsellsFromLinkOwner:F}),S.default.createElement(v,{file:t,user:Q,shareEmail:X,shareModalVariant:n,senderReminderVariant:ie})):S.default.createElement(I,null,S.default.createElement(c.FileViewerWithCSS,{closeFile:ge,file:de,previewContentOnly:V,cloudDocPreviewMode:"redirect",user:Q,brandingInfo:p,encryptionOptions:h,previewSurface:a.isBackupBrowse()?a.SDKPreviewSurface.BACKUP:Ee?a.SDKPreviewSurface.FILE_LOCKING:M===a.SourceContext.EdisonDesktopPreview?a.SDKPreviewSurface.FSS_DESKTOP_PREVIEW:a.SDKPreviewSurface.STANDALONE_PREVIEW,canShowFileFlippers:!1,hideOpenInAppInterstitial:!!N,onFileChanged:me,fileViewOrigin:k,sourceContext:re,onMobileInterstitialDismissed:x,deviceId:U,editActivationParams:ve,fromRegister:Ie,userPresentableVerdict:G}),Q?S.default.createElement(v,{file:t,user:Q,shareEmail:X,shareModalVariant:n,senderReminderVariant:ie}):void 0);return d?S.default.createElement("div",{className:"embedded"},Pe):Pe};D.displayName="FileViewerContainer";const k=a.withViewer(D);const N=({context:t,isInline:n=!1,loginContinueUrl:i="",registerContinueUrl:s="",pageName:l,hidePromptOnInit:c=!1,additionalAuthParams:d={},signinTag:u="",signupTag:_,autoSignInVariant:f="OFF",showMarketingOptIn:g=!1,onBeforeRedirect:p,isFedCMOn:w=!1,disclaimerDisplayed:E})=>{const v=m.getActiveUserId(),{data:I}=a.googleOneTapPrefetchRequestPackage.useQuery({apiArg:null,pkgArg:null}),P=null==I?void 0:I.apiData;return S.default.useMemo((()=>{v||a.initFingerprintJS()}),[v]),S.default.useEffect((()=>{P&&!v&&new Promise((function(t,n){e(["./c_google_one_tap_google_one_tap_platform"],t,n)})).then((function(e){return e.google_one_tap_platform_esnext})).then((({GoogleOneTapPlatform:e})=>{const a=r.is_mobile_or_tablet();e.init({clientId:P.apiClientId,context:t,isInline:n&&!a,locale:o.intl.locale,showMarketingOptIn:P.showMarketingOptIn||g,isTest:m.isSeleniumTest()||!1,isMobile:a,loginContUrl:i||"",registerContUrl:s||"",pageName:l,dwgRefreshVariant:"V2",autoSignInVariant:f,signupContainerId:"",signinContainerId:"",referralCode:"",referralSource:"",emailHash:"",signupTag:_,hidePromptOnInit:c,additionalAuthParams:d,implicitTOSVariant:h.getTOSVariant(h.TOSType.GOOGLE_ONE_TAP,P.implicitTosVariant),signinTag:u,signupEndpoint:"",disableRedirect:!1,isFedCMEnabled:w},!1,p,E)}))}),[P,v,t,n,i,l,s]),null};N.displayName="GoogleOneTapWithoutCss";const M=e=>S.default.createElement(p.QueryClientProvider,{client:p.queryClient},S.default.createElement(N,{...e}));M.displayName="GoogleOneTapWithQueryProvider";const V=a.requireCssWithComponent(M,["/static/typescript/component_libraries/dwg-components/src/index.web-vfljDrGPB.css","/static/metaserver/static/css/google_one_tap-vflp9XDLJ.css"]);t.FileViewerContainerWithErrorBoundary=e=>{const t=sessionStorage.getItem("has_seen_interstitial"),[n,i]=S.default.useState(!!e.appDownloadInterstitialDismissed||!!t);return S.default.createElement(S.default.Fragment,null,S.default.createElement(a.ErrorPageBoundary,null,S.default.createElement(k,{...e,onMobileInterstitialDismissed:()=>{r.is_mobile_or_tablet()&&d.GSIEventManager.sendGSIEvent(d.GSIEvent.SHOW_PROMPT),i(!0)},appDownloadInterstitialDismissed:n})))},t.GoogleOneTap=V,t.locationToURL=function(e){const t=e.origin||window.location.origin,n=e.search||window.location.search||"",a=e.hash||window.location.hash||"";return`${t}${e.pathname||(n||a?"/":"")}${n}${a}`}}));
//# sourceMappingURL=c_ui_component_one_tap.js-vfl87F0r1.map

//# debugId=5239313f-4c8f-3182-adad-0492c38bce00