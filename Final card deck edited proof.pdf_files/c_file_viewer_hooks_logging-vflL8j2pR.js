!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="37b81213-e5e5-3d02-a109-61819a4f72d4")}catch(e){}}();
define(["exports","react","./e_ui_page_files_router","./c_file_viewer_hooks_lifecycle_logging","./c_core_utils_region"],(function(e,i,o,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var s=n(i);const l=[],u=(e,i)=>o.useStabilizedCallback(((o,r)=>{const n=e.get(t.filePreviewSessionIdAtom),s=t.getLoggingSession(n);s?null==i||i.log(o,t.serializeSession({...s,extra:{source_context:s.extra.source_context,preview_type:s.extra.preview_type,...r}})):l.push([o,r])})),d=()=>{const{logger:e}=o.useFileViewerContext(),i=o.useStore();return u(i,e)},v=(e,i,o)=>{const{videoFormat:t,videoDuration:r,videoTruncated:n,extra:s}=e;return{file_viewer_session_id:i.file_viewer_session_id,file_preview_session_id:i.file_preview_session_id,video_format:t,video_duration_seconds:r,video_truncated:n,source_context:i.source_context,device_type:i.device_type,preview_type:o,file_id:i.file_id,extra:s}},c=[r.VideoPreviewEvent.PlayerRendered,r.VideoPreviewEvent.FirstClickPlay,r.VideoPreviewEvent.MediaError],a=(e,i)=>{if(e&&!c.includes(i))return e.duration()||void 0},_=(e,i,r,n,s)=>{const l=(e=>{const i=t.getLoggingSession(e);if(!i)return;const{file_preview_session_id:o,file_viewer_session_id:r,ns_id:n,sj_id:s,device_type:l,file_id:u,extra:{preview_type:d,source_context:v}}=null!=i?i:{extra:{}};return o&&r&&d&&v&&l?{file_preview_session_id:o,file_viewer_session_id:r,ns_id:n,sj_id:s,device_type:l,preview_type:d,source_context:v,file_id:u}:void 0})(e);if(!e||!l)return;const u=l.preview_type;if(u!==o.PreviewType.Video&&u!==o.PreviewType.Audio)throw new o.FVError(o.FVErrorCode.InvalidLoggingSession,o.ErrorLifecycle.Unknown,"Can't log video events for non-audio/video previews.");return{args:{filePreviewSessionId:e,videoTruncated:r,videoDuration:a(n,i),extra:s},previewType:u,videoSession:l}};e.useLogBackgroundEvent=()=>{const e=d();return o.useStabilizedCallback(((i,t)=>{e(o.EventType.Background,{...t,event:i})}))},e.useLogPreviewEvent=d,e.useLogUserActionInternal=(e,i)=>{const t=u(e,i);return o.useStabilizedCallback(((e,i,r)=>{t(o.EventType.UserAction,{action:e,...i?{context:i}:{},...r})}))},e.useLogVideoEvent=(e,i)=>{const{logger:r}=o.useFileViewerContext(),n=o.useFileViewerAtomValue(t.filePreviewSessionIdAtom);return o.useStabilizedCallback(((o,t)=>{var s;const l=_(n,o,e,i,t);if(!l)return;const{args:u,previewType:d,videoSession:c}=l;null===(s=null==r?void 0:r.logVideoEvent)||void 0===s||s.call(r,o,v(u,c,d))}))},e.useLogVideoEventDuration=(e,i)=>{const{logger:r}=o.useFileViewerContext(),n=o.useFileViewerAtomValue(t.filePreviewSessionIdAtom);return o.useStabilizedCallback(((o,t,s)=>{var l;const u=_(n,o,e,i,s);if(!u)return;const{args:d,previewType:c,videoSession:a}=u;null===(l=null==r?void 0:r.logVideoEventDuration)||void 0===l||l.call(r,o,t,v(d,a,c))}))},e.useLogVideoEventQuantity=(e,i)=>{const{logger:r}=o.useFileViewerContext(),n=o.useFileViewerAtomValue(t.filePreviewSessionIdAtom);return o.useStabilizedCallback(((o,t,s)=>{var l;const u=_(n,o,e,i,s);if(!u)return;const{args:d,previewType:c,videoSession:a}=u;null===(l=null==r?void 0:r.logVideoEventQuantity)||void 0===l||l.call(r,o,t,v(d,a,c))}))},e.usePurgeQueuedEvents=()=>{const e=o.useFileViewerAtomValue(t.filePreviewSessionIdAtom),i=d();s.default.useEffect((()=>{if(e)for(;l.length;){const e=l.pop();e&&i(...e)}}),[i,e])}}));
//# sourceMappingURL=c_file_viewer_hooks_logging.js-vfluBptih.map

//# debugId=37b81213-e5e5-3d02-a109-61819a4f72d4