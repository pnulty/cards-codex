!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="014157ae-ae1e-3715-8659-c3c0c31a1a5a")}catch(e){}}();
define(["exports","./e_ui_page_files_router","react","./e_data_modules_stormcrow","./c_src_bindings_api-context","./c_src_bindings_provider","./c_core_i18n"],(function(e,t,a,r,i,n,s){"use strict";function o(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var r=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,r.get?r:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var u=o(a);class l{static initClass(){this.ACCURACY=2,this.CODEPOINT_TO_WIDTH={32:38,33:25,34:42,35:67,36:58,37:92,38:75,39:25,40:33,41:33,42:58,43:58,44:25,45:33,46:25,47:42,48:58,49:58,50:58,51:58,52:58,53:58,54:58,55:58,56:58,57:58,58:25,59:25,60:58,61:58,62:58,63:50,64:100,65:67,66:67,67:67,68:75,69:58,70:58,71:75,72:83,73:33,74:25,75:67,76:58,77:100,78:83,79:83,80:67,81:83,82:67,83:58,84:58,85:75,86:67,87:100,88:67,89:58,90:58,91:33,92:42,93:33,94:58,95:50,96:67,97:58,98:67,99:50,100:67,101:58,102:33,103:58,104:67,105:25,106:25,107:58,108:25,109:100,110:67,111:67,112:67,113:67,114:42,115:50,116:42,117:67,118:58,119:83,120:58,121:58,122:50,123:42,124:58,125:42,126:58,161:25,162:58,163:58,164:58,165:58,166:58,167:58,168:67,169:92,170:42,171:50,172:58,174:92,175:58,176:50,177:58,178:42,179:42,180:67,181:67,182:75,183:25,184:25,185:42,186:42,187:50,188:83,189:83,190:83,191:50,192:67,193:67,194:67,195:67,196:67,197:67,198:92,199:67,200:58,201:58,202:58,203:58,204:33,205:33,206:33,207:33,208:75,209:83,210:83,211:83,212:83,213:83,214:83,215:58,216:83,217:75,218:75,219:75,220:75,221:58,222:67,223:67,224:58,225:58,226:58,227:58,228:58,229:58,230:92,231:50,232:58,233:58,234:58,235:58,236:25,237:25,238:25,239:25,240:67,241:67,242:67,243:67,244:67,245:67,246:67,247:58,248:67,249:67,250:67,251:67,252:67,253:58,254:67,255:58,256:75,257:67,258:75,259:67,260:75,261:67,262:75,263:58,264:75,265:58,266:75,267:58,268:75,269:58,270:83,271:83,272:83,273:75,274:67,275:67,276:67,277:67,278:67,279:67,280:67,281:67,282:67,283:67,284:83,285:75,286:83,287:75,288:83,289:75,290:83,291:75,292:83,293:75,294:92,295:75,296:33,297:33,298:33,299:33,300:33,301:33,302:33,303:33,304:33,305:25,306:67,307:67,308:42,309:33,310:75,311:67,312:67,313:58,314:33,315:58,316:33,317:58,318:42,319:58,320:50,321:67,322:42,323:83,324:75,325:83,326:75,327:83,328:75,329:83,330:83,331:75,332:92,333:67,334:92,335:67,336:92,337:67,338:100,339:100,340:75,341:50,342:75,343:50,344:75,345:50,346:67,347:58,348:67,349:58,350:67,351:58,352:67,353:58,354:75,355:42,356:75,357:42,358:75,359:42,360:83,361:75,362:83,363:75,364:83,365:75,366:83,367:75,368:83,369:75,370:83,371:75,372:100,373:92,374:75,375:58,376:75,377:67,378:67,379:67,380:67,381:67,382:67,383:42,384:75,385:83,386:67,387:75,388:75,389:67,390:75,391:83,392:58,393:83,394:100,395:67,396:75,397:67,398:67,399:75,400:58,401:58,402:75,403:83,404:75,405:100,406:50,407:50,408:75,409:67,410:50,411:67,412:117,413:83,414:75,415:92,416:92,417:75,418:117,419:100,420:75,421:75,422:75,423:67,424:58,425:67,426:58,427:42,428:75,429:42,430:75,431:83,432:75,433:92,434:83,435:75,436:75,437:67,438:67,439:67,440:67,441:58,442:58,443:75,444:75,445:58,446:50,447:67,448:33,449:50,450:50,451:33,452:142,453:142,454:133,455:100,456:92,457:67,458:117,459:117,460:100,461:75,462:67,463:33,464:33,465:92,466:67,467:83,468:75,469:83,470:75,471:83,472:75,473:83,474:75,475:83,476:75,477:67,478:75,479:67,480:75,481:67,482:100,483:100,484:92,485:75,486:83,487:75,488:75,489:67,490:92,491:67,492:92,493:67,494:67,495:58,496:33,497:142,498:142,499:133,500:83,501:75,502:117,503:67,504:83,505:75,506:75,507:67,508:100,509:100,510:92,511:67,512:75,513:67,514:75,515:67,516:67,517:67,518:67,519:67,520:33,521:33,522:33,523:33,524:92,525:67,526:92,527:67,528:75,529:50,530:75,531:50,532:83,533:75,534:83,535:75,536:67,537:58,538:75,539:42,540:58,541:58,542:83,543:75,544:83,545:100,546:92,547:67,548:67,549:67,550:75,551:67,552:67,553:67,554:92,555:67,556:92,557:67,558:92,559:67,560:92,561:67,562:75,563:58,564:67,565:100,566:67,567:33,568:100,569:100,570:75,571:75,572:58,573:58,574:67,575:58,576:58,577:67,578:50,579:75,580:75,581:75,582:75,583:58,584:58,585:25,586:83,587:58,588:75,589:33,590:75,591:58,880:67,881:50,882:67,883:50,884:33,885:33,886:75,887:67,888:108,889:108,890:67,891:58,892:58,893:58,894:42,895:108,896:108,897:108,898:108,899:108,900:67,901:67,902:75,903:42,904:83,905:100,906:58,907:108,908:100,909:108,910:100,911:100,912:42,913:75,914:67,915:58,916:83,917:67,918:67,919:83,920:92,921:33,922:75,923:75,924:100,925:83,926:75,927:92,928:83,929:67,930:108,931:67,932:75,933:75,934:83,935:75,936:83,937:92,938:33,939:75,940:83,941:58,942:75,943:42,944:67,945:83,946:67,947:67,948:67,949:58,950:75,951:75,952:67,953:42,954:67,955:67,956:75,957:67,958:67,959:67,960:92,961:67,962:67,963:75,964:67,965:67,966:92,967:67,968:92,969:100,970:42,971:67,972:67,973:67,974:100,975:108,976:58,977:75,978:75,979:100,980:75,981:92,982:100,983:67,984:92,985:67,986:75,987:58,988:58,989:58,990:67,991:58,992:75,993:92,994:100,995:92,996:75,997:58,998:75,999:58,1e3:75,1001:75,1002:67,1003:67,1004:83,1005:58,1006:50,1007:42,1008:67,1009:67,1010:58,1011:33,1012:92,1013:58,1014:58,1015:67,1016:67,1017:75,1018:100,1019:83,1020:58,1021:75,1022:75,1023:75,1024:67,1025:67,1026:92,1027:58,1028:75,1029:67,1030:33,1031:33,1032:42,1033:108,1034:108,1035:83,1036:75,1037:83,1038:75,1039:83,1040:75,1041:67,1042:67,1043:58,1044:83,1045:67,1046:92,1047:67,1048:83,1049:83,1050:75,1051:83,1052:100,1053:83,1054:92,1055:83,1056:67,1057:75,1058:75,1059:75,1060:83,1061:75,1062:83,1063:75,1064:108,1065:108,1066:75,1067:92,1068:67,1069:75,1070:108,1071:75,1072:67,1073:67,1074:58,1075:58,1076:75,1077:67,1078:83,1079:58,1080:75,1081:75,1082:67,1083:67,1084:83,1085:75,1086:67,1087:75,1088:75,1089:58,1090:58,1091:58,1092:92,1093:67,1094:75,1095:58,1096:92,1097:100,1098:67,1099:83,1100:58,1101:58,1102:92,1103:58,1104:67,1105:67,1106:75,1107:58,1108:58,1109:58,1110:33,1111:33,1112:42,1113:92,1114:92,1115:75,1116:67,1117:75,1118:58,1119:75,1120:100,1121:75,1122:75,1123:67,1124:83,1125:83,1126:75,1127:67,1128:100,1129:92,1130:92,1131:83,1132:117,1133:108,1134:67,1135:67,1136:83,1137:83,1138:92,1139:67,1140:83,1141:67,1142:83,1143:67,1144:133,1145:125,1146:92,1147:67,1148:100,1149:75,1150:100,1151:75,1152:75,1153:58,1154:75,1155:0,1156:0,1157:0,1158:0,1159:108,1160:0,1161:0,1162:83,1163:75,1164:67,1165:58,1166:67,1167:75,1168:58,1169:58,1170:67,1171:58,1172:75,1173:67,1174:100,1175:92,1176:67,1177:58,1178:75,1179:67,1180:83,1181:75,1182:75,1183:67,1184:83,1185:75,1186:83,1187:75,1188:100,1189:83,1190:117,1191:100,1192:92,1193:75,1194:75,1195:58,1196:75,1197:58,1198:75,1199:58,1200:75,1201:58,1202:75,1203:75,1204:100,1205:83,1206:75,1207:67,1208:75,1209:67,1210:75,1211:58,1212:92,1213:75,1214:92,1215:75,1216:33,1217:92,1218:83,1219:75,1220:67,1221:83,1222:67,1223:83,1224:75,1225:83,1226:75,1227:75,1228:58,1229:100,1230:83,1231:25,1232:75,1233:67,1234:75,1235:67,1236:100,1237:100,1238:67,1239:67,1240:75,1241:67,1242:75,1243:67,1244:92,1245:83,1246:67,1247:58,1248:67,1249:58,1250:83,1251:75,1252:83,1253:75,1254:92,1255:67,1256:92,1257:67,1258:92,1259:67,1260:75,1261:58,1262:75,1263:58,1264:75,1265:58,1266:75,1267:58,1268:75,1269:58,1270:58,1271:42,1272:92,1273:83,1274:58,1275:42,1276:75,1277:58,1278:75,1279:58,2026:67,19977:108,65403:58},this._ELLIPSIS_LENGTH=new l("…").length}static em_snippet(e,t,a){return null==t&&(t=50),null==a&&(a=.75),new l(e.toString()).snippet(t,a).toString()}constructor(e){if(!(this instanceof l))return new l(e);this.s=e,this.info=this.widthInfo(),this.length=e.length?this.info[this.s.length-1]:0}widthInfo(){const e={"-1":0};for(let t=0,a=this.s.length,r=0<=a;r?t<a:t>a;r?t++:t--)e[t]=e[t-1]+this.ems(this.s.charAt(t));return e}findSpot(e){let t;if(!e)return 0;let a=0,r=this.s.length;for(;a<=r;){t=Math.floor(a/2+r/2);const i=this.info[t-1];if(i>e)r=t-1;else{if(!(i<e))return t;a=t+1}}return a>t?a:t}ems(e){const t=e.charCodeAt(0),a=l.CODEPOINT_TO_WIDTH[t];return a?a/Math.pow(10,l.ACCURACY):768<=t&&t<=879?0:65377<=t&&t<=65500?.58:11904<=t&&t<=40911||44032<=t&&t<=55215||4352<=t&&t<=4607||63744<=t&&t<=64255||65280<=t&&t<=65535||131072<=t&&t<=196607?1.08:.65}substr(e,t){const a=this.findSpot(e);if(null!=t){let r=this.findSpot(e+t);if(r-a<this.s.length){const e=this.s.charCodeAt(r-a);65024<=e&&e<=65039&&r--}return new l(this.s.substr(a,r-a))}return new l(this.s.substr(a))}toString(){return this.s}snippet(e=50,t=.75){if(this.length<=e)return this;const a=(e-=l._ELLIPSIS_LENGTH)*t,r=e-a,i=this.length-r,n=this.substr(0,a),s=this.substr(i);return new l(n.toString()+"…"+s.toString())}}l.initClass();const c=e=>"personal"!==e.role&&!!e.is_team_member,d=e=>c(e)&&!!e.is_tmr_member,g=(e,a)=>c(e)&&e.team_id===t.getOwnerTeamId(a),p=["change_options","disable_viewer_info","edit_contents","enable_viewer_info","invite_editor","invite_viewer","invite_viewer_no_comment","unshare","update_confidentiality","relinquish_membership"].map((e=>({".tag":e}))),_=["change_options","create_edit_link","create_link","create_view_link","disable_viewer_info","edit_contents","enable_viewer_info","invite_editor","invite_viewer","invite_viewer_no_comment","relinquish_membership","remove_download_policy","set_download_policy","share_link","share_message_as_comment","unshare"].map((e=>({".tag":e}))),f=["change_options","create_link","disable_viewer_info","edit_contents","enable_viewer_info","invite_editor","invite_viewer","invite_viewer_no_comment","relinquish_membership","remove_download_policy","set_download_policy","share_link","leave_a_copy","set_access_inheritance","unmount","unshare","update_confidentiality"].map((e=>({".tag":e}))),h=["leave_a_copy","make_editor","make_owner","make_viewer","make_viewer_no_comment","remove"].map((e=>({".tag":e}))),m=t.isObjectOf({path_lower:t.isString,is_confidential:t.isBoolean,is_inside_team_folder:t.isBoolean}),E=e=>m(e);var C;!function(e){e.SUCCESS="SUCCESS",e.ERROR="ERROR",e.FATAL="FATAL"}(C||(C={}));const y=(e,t)=>{const a=t.error,r=t.data;if(a&&"file_folder"===e[".tag"]){const t=a;if(t.appError){const a=function(e,t){if(!t||"file_folder"!==e[".tag"])throw new Error("No error found in Validate Folder Path Response");if("no_permission"===t[".tag"]&&E(t)){const a=Object.fromEntries(Object.entries(t).filter((([e])=>".tag"!==e)));return{".tag":"file_folder",name:e.name,...a}}if("too_many_mounts_v2"===t[".tag"]){const a=t.too_many_mounts_v2;if("total_mounts_exceeded"===a[".tag"]||"home_mounts_exceeded"===a[".tag"]||"tree_size_exceeded"===a[".tag"])return{".tag":"link_only",name:e.name,...a.metadata,tooManyMountsError:a}}else if("bad_path"===t[".tag"]){const a=t.bad_path;if("is_family"===a[".tag"]||"contains_app_folder"===a[".tag"]||"is_app_folder"===a[".tag"]||"inside_app_folder"===a[".tag"]){const t=Object.fromEntries(Object.entries(a).filter((([e])=>".tag"!==e)));return{".tag":"link_only",name:e.name,...t}}if("already_shared"===a[".tag"]){return{".tag":"shared_folder",...Object.fromEntries(Object.entries(a).filter((([e])=>".tag"!==e)))}}}return}(e,t.appError);if(a)return a}}if(r)switch(e[".tag"]){case"file":return{".tag":"file",...r.apiData};case"file_folder":return{".tag":"file_folder",...r.apiData,name:e.name};case"shared_folder":return{".tag":"shared_folder",...r.apiData};default:throw new Error("Invalid object metadata")}};const v=()=>t.sharingAccountInfoPackage.useQuery({});const S=(e,t)=>({options:e,useAction:t}),T=(e,t)=>({success:!1,type:e,value:t}),b=(e,t)=>({success:!0,type:e,value:t}),A=e=>({success:!1,type:"TypeExhaustion",value:{value:e}}),O=e=>({success:!1,type:"UncaughtException",value:{error:e}}),I=e=>{const t=e.options.name,a=e.useAction(),r=n.useLogger();return u.useCallback((async e=>{let i;r("ACTION__START",{name:t,input:e});try{i=await a(e)}catch(e){i=O(e)}return r("ACTION__COMPLETE",{name:t,input:e,output:i}),i}),[r,a,t])},R=n.define({name:"sharing.set_access_inheritance"},(e=>t=>n.handler(e.sharingSetAccessInheritance(t)))),w=(e,t)=>{const a=(null==t?void 0:t.timeout)||1e4,r=(null==t?void 0:t.interval)||1e3;return new Promise((t=>{const i=setTimeout((()=>t({status:"TIMEOUT"})),a),n=async()=>{try{const a=await e();if("COMPLETE"===a.status)return clearTimeout(i),void t(a);setTimeout(n,r)}catch(e){clearTimeout(i),t({status:"ERROR",error:e})}};n()}))},k=n.define({name:"sharing.checkShareInternalJobStatus"},(e=>t=>n.handler(e.sharingCheckShareInternalJobStatus(t)))),L=S({name:"CheckSetAccessInheritanceJobStatus"},(()=>{const e=n.useEndpoint(k);return u.useCallback((async({asyncJobId:t})=>{const a=await e({async_job_id:t});return"FATAL"===a.status?T("NetworkFailure",{response:a}):"ERROR"===a.status?T("ApiError",{response:a}):"in_progress"===a.output[".tag"]?b("InProgress",{response:{...a,output:a.output}}):"failed"===a.output[".tag"]?T("Failed",{response:{...a,output:a.output}}):"complete"===a.output[".tag"]?b("Complete",{response:{...a,output:a.output}}):A(a.output)}),[e])})),P=S({name:"PollCheckSetAccessInheritanceJobStatus"},(()=>{const e=I(L);return u.useCallback((async({asyncJobId:t,timeout:a,interval:r})=>{const i=await w((async()=>{const a=await e({asyncJobId:t});return"InProgress"===a.type?{status:"RETRY"}:{status:"COMPLETE",output:a}}),{timeout:a,interval:r});return"TIMEOUT"===i.status?T("Timeout",null):"ERROR"===i.status?O(i.error):i.output.success?b("Complete",i.output.value):i.output}),[e])})),M=S({name:"SetAccessInheritance"},(()=>{const e=n.useEndpoint(R),t=I(P);return u.useCallback((async({setAccessInheritanceArg:a,timeout:r,interval:i})=>{const n=await e(a);if("ERROR"===n.status)return T("ApiError",{response:n});if("FATAL"===n.status)return T("NetworkFailure",{response:n});if("complete"===n.output[".tag"])return b("Complete",{response:{...n,output:n.output}});if("async_job_id"!==n.output[".tag"])return A(n.output);const s=await t({asyncJobId:n.output.async_job_id,timeout:r,interval:i});return s.success?b("PollingComplete",s.value):"ApiError"===s.type?T("PollingApiError",s.value):"NetworkFailure"===s.type?T("PollingNetworkFailure",s.value):"Failed"===s.type?T("PollingFailed",s.value):"Timeout"===s.type?T("PollingTimeout",s.value):s}),[e,t])})),N=n.define({name:"sharing.share_folder"},(e=>t=>n.handler(e.sharingAlphaShareFolder(t)))),U=S({name:"CheckShareFileFolderJobStatus"},(()=>{const e=n.useEndpoint(k);return u.useCallback((async({asyncJobId:t})=>{const a=await e({async_job_id:t});return"FATAL"===a.status?T("NetworkFailure",{response:a}):"ERROR"===a.status?T("ApiError",{response:a}):"in_progress"===a.output[".tag"]?b("InProgress",{response:{...a,output:a.output}}):"failed"===a.output[".tag"]?T("Failed",{response:{...a,output:a.output}}):"complete"===a.output[".tag"]?b("Complete",{response:{...a,output:a.output}}):A(a.output)}),[e])})),F=S({name:"PollCheckShareFileFolderJobStatus"},(()=>{const e=I(U);return u.useCallback((async({asyncJobId:t,timeout:a,interval:r})=>{const i=await w((async()=>{const a=await e({asyncJobId:t});return"InProgress"===a.type?{status:"RETRY"}:{status:"COMPLETE",output:a}}),{timeout:a,interval:r});return"TIMEOUT"===i.status?T("Timeout",null):"ERROR"===i.status?O(i.error):i.output.success?b("Complete",i.output.value):i.output}),[e])})),j=S({name:"ShareFileFolder"},(()=>{const e=n.useEndpoint(N),t=I(F);return u.useCallback((async({path:a,confidentiality:r,timeout:i,interval:n})=>{const s=await e({path:a,confidentiality:r});if("ERROR"===s.status)return T("ApiError",{response:s});if("FATAL"===s.status)return T("NetworkFailure",{response:s});if("complete"===s.output[".tag"])return b("Complete",{response:{...s,output:s.output}});if("async_job_id"!==s.output[".tag"])return A(s.output);const o=await t({asyncJobId:s.output.async_job_id,timeout:i,interval:n});return o.success?b("PollingComplete",o.value):"ApiError"===o.type?T("PollingApiError",o.value):"NetworkFailure"===o.type?T("PollingNetworkFailure",o.value):"Failed"===o.type?T("PollingFailed",o.value):"Timeout"===o.type?T("PollingTimeout",o.value):o}),[e,t])})),x="sharing-notification",D=(e,a)=>{W(),t.Snackbar.complete(e,x,a)},H=e=>{t.Snackbar.close(),t.Snackbar.fail(e,x)},W=()=>t.Snackbar.close(x),q=e=>e.formatMessage({id:"b0sjjf",defaultMessage:"Learn more"});var J;e.SharingNotificationType=void 0,(J=e.SharingNotificationType||(e.SharingNotificationType={})).COMPLETED="COMPLETED",J.COMPLETED_WITH_ACTION="COMPLETED_WITH_ACTION",J.COMPLETED_WITH_UNDO="COMPLETED_WITH_UNDO",J.IN_PROGRESS="IN_PROGRESS",J.FAILURE="FAILURE",J.FAILURE_WITH_HELP="FAILURE_WITH_HELP";const Q=e=>e.formatMessage({id:"LNVaAv",defaultMessage:"Learn more"}),B=e=>e.formatMessage({id:"wRjRAs",defaultMessage:"Undo"});function G(e){return["zh","ja","ko"].includes(new Intl.Locale(e).language)}function V(e){const t=[],a=e.length;let r=0;for(;r<a;){const i=e[r];if(i>="\ud800"&&i<="\udb7f"){if(!(r<a-1))break;{const a=i+e[r+1];t.push(a),r+=2}}else t.push(i),r+=1}return t}e.AccessLevelWeight={viewer_no_comment:-10,viewer:1,editor:2,owner:3},e.EDITOR={".tag":"editor"},e.Emstring=l,e.OTHER={".tag":"other"},e.OWNER={".tag":"owner"},e.VIEWER={".tag":"viewer"},e.VIEWER_NO_COMMENT={".tag":"viewer_no_comment"},e.action=j,e.action$1=M,e.checkShareInternalJobStatus=k,e.close=W,e.convertAccountMetadataToUser=e=>({id:e.user_id,email:e.email,is_team:c(e),is_team_admin:e.is_team_admin,account_id:e.account_id,team_dbtid:e.team_id,is_tmr_member:e.is_tmr_member}),e.create=S,e.fail=H,e.failure=T,e.failureExhaustsAllTypes=A,e.failureUncaughtException=O,e.fetchLegacySharingObjectMetadataObjectIdentifier=async(e,a)=>{if(t.UDCL.logEvent("ops.sharing.fetchLegacySharingObjectMetadataObjectIdentifier",{tags:{objectType:e[".tag"],isNonUserRelativeContext:(null==a?void 0:a.toString())||"undefined"}}),"shared_folder"===e[".tag"]){const i=(await t.filesGetMetadataPackage.fetchQuery(r.queryClient,{apiArg:{path:`ns:${e.sharedFolderId}`},pkgArg:{isNonUserRelativeContext:!!a}},{staleTime:3e5})).apiData;return"folder"===i[".tag"]?{".tag":"shared_folder",sharedFolderId:e.sharedFolderId,fileId:i.id}:e}if("file_folder"===e[".tag"]){const i=(await t.filesGetMetadataPackage.fetchQuery(r.queryClient,{apiArg:{path:e.path},pkgArg:{isNonUserRelativeContext:!!a}},{staleTime:3e5})).apiData;return"folder"===i[".tag"]?{".tag":"file_folder",name:e.name,path:e.path,fileId:i.id}:e}return e},e.getAreMemberSelectorsEqual=(e,t)=>!(!e||!t)&&("dropbox_id"===e[".tag"]&&"dropbox_id"===t[".tag"]?e.dropbox_id===t.dropbox_id:"email"===e[".tag"]&&"email"===t[".tag"]?e.email===t.email:"other"===e[".tag"]&&"other"===t[".tag"]),e.getGroupInitials=e=>{const t=e.toUpperCase().split(" ").filter((e=>e));return`${t.length>0?t[0][0]:""}${t.length>1?t[t.length-1][0]:""}`},e.getIsTeam=c,e.getIsTeamAdmin=e=>c(e)&&!!e.is_team_admin,e.getSharingObjectMetadata=async function(e,a){switch(e[".tag"]){case"file":const i=await t.getSharingApiv2ResponseWithErrors(t.sharingMetadataAlphaPackage.fetchQuery(r.queryClient,{apiArg:{file:e.fileId,actions:_},pkgArg:{isNonUserRelativeContext:a}},{staleTime:3e5}));return"SUCCESS"===i.status?{status:C.SUCCESS,output:{".tag":"file",...i.output}}:"ERROR"===i.status?i:{status:C.FATAL,error:{".tag":"api_error"}};case"file_folder":const n=await t.getSharingApiv2ResponseWithErrors(t.sharingValidateFolderPathPackage.fetchQuery(r.queryClient,{apiArg:{path:e.path,actions:p,list_members_arg:{actions:h},confidentiality:{".tag":"not_confidential"}},pkgArg:{isNonUserRelativeContext:a}},{staleTime:3e5}));if("SUCCESS"===n.status){const t={".tag":"file_folder",name:e.name,...n.output};return{status:C.SUCCESS,output:t}}if("ERROR"===n.status){const t=n.error;if("no_permission"===t[".tag"]&&E(t)){const a=Object.fromEntries(Object.entries(t).filter((([e])=>".tag"!==e))),r={".tag":"file_folder",name:e.name,...a};return{status:C.SUCCESS,output:r}}if("too_many_mounts_v2"===t[".tag"]){const a=t.too_many_mounts_v2;if("total_mounts_exceeded"===a[".tag"]||"home_mounts_exceeded"===a[".tag"]||"tree_size_exceeded"===a[".tag"]){const t={".tag":"link_only",name:e.name,...a.metadata,tooManyMountsError:a};return{status:C.SUCCESS,output:t}}}else if("bad_path"===t[".tag"]){const a=t.bad_path;if("is_family"===a[".tag"]||"contains_app_folder"===a[".tag"]||"is_app_folder"===a[".tag"]||"inside_app_folder"===a[".tag"]){const t=Object.fromEntries(Object.entries(a).filter((([e])=>".tag"!==e))),r={".tag":"link_only",name:e.name,...t};return{status:C.SUCCESS,output:r}}if("already_shared"===a[".tag"]){const e={".tag":"shared_folder",...Object.fromEntries(Object.entries(a).filter((([e])=>".tag"!==e)))};return{status:C.SUCCESS,output:e}}}return{status:C.ERROR,error:n.error,statusCode:0}}return{status:C.FATAL,error:{".tag":"api_error"}};case"shared_folder":const s=await t.getSharingApiv2ResponseWithErrors(t.sharingFolderMetadataPackage.fetchQuery(r.queryClient,{apiArg:{shared_folder_id:e.sharedFolderId,actions:f},pkgArg:{isNonUserRelativeContext:a}},{staleTime:3e5}));return"SUCCESS"===s.status?{status:C.SUCCESS,output:{".tag":"shared_folder",...s.output}}:"ERROR"===s.status?{status:C.ERROR,error:s.error,statusCode:0}:{status:C.FATAL,error:{".tag":"api_error"}};default:return{status:C.ERROR,error:{".tag":"invalid_object"},statusCode:0}}},e.getUniqueId=e=>"dropbox_id"===e[".tag"]?`DBX_ID:${e.dropbox_id}`:"email"===e[".tag"]?`EMAIL:${e.email}`:"other"===e[".tag"]?"OTHER":t.exhausts(e,"UNKNOWN"),e.getUserInitials=function(e,t){if(!e)return"";const a=(e=e.toUpperCase()).trim().split(" "),r=V(a[0]),i=V(a[a.length-1]);if(a.length>=2)return G(t)?i[0]+r[0]:r[0]+i[0];const n=V(e);return G(t)&&!function(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>=128)return!1;return!0}(e)&&n.length>1?n[0]+n[1]:n[0]},e.invalidateNewApiObjectMetadata=async function(e){if(e.fileId)return t.sharingObjectMetadataPackage.invalidateQueries(r.queryClient,{file_id:e.fileId})},e.invalidateSharingAccountInfo=async function(){return t.sharingAccountInfoPackage.invalidateQueries(r.queryClient)},e.invalidateSharingObjectMetadata=async function(e){switch(e[".tag"]){case"file":return t.sharingMetadataAlphaPackage.invalidateQueries(r.queryClient,{file:e.fileId,actions:_});case"file_folder":return t.sharingValidateFolderPathPackage.invalidateQueries(r.queryClient,{path:e.path,actions:p,list_members_arg:{actions:h},confidentiality:{".tag":"not_confidential"}});case"shared_folder":return t.sharingFolderMetadataPackage.invalidateQueries(r.queryClient,{shared_folder_id:e.sharedFolderId,actions:f})}},e.isTmrMember=d,e.isUserOnSameTeamAsObject=g,e.isUserOnSameTeamAsTmrTeamFolder=(e,a)=>d(e)&&g(e,a)&&t.getIsTeamSharedFolder(a),e.poll=w,e.shareFolder=N,e.success=b,e.useAction=I,e.useLegacySharingObjectMetadata=e=>{const{isNonUserRelativeContext:a}=i.useSharingApiContext(),r=function(e,a){const r=t.sharingMetadataAlphaPackage.useQuery({apiArg:{file:"file"===e[".tag"]?e.fileId:"",actions:_},pkgArg:{isNonUserRelativeContext:a}},{staleTime:3e5,enabled:"file"===e[".tag"]}),i=t.sharingValidateFolderPathPackage.useQuery({apiArg:{path:"file_folder"===e[".tag"]?e.path:"",actions:p,list_members_arg:{actions:h},confidentiality:{".tag":"not_confidential"}},pkgArg:{isNonUserRelativeContext:a}},{staleTime:3e5,enabled:"file_folder"===e[".tag"]}),n=t.sharingFolderMetadataPackage.useQuery({apiArg:{shared_folder_id:"shared_folder"===e[".tag"]?e.sharedFolderId:"",actions:f},pkgArg:{isNonUserRelativeContext:a}},{staleTime:3e5,enabled:"shared_folder"===e[".tag"]});switch(e[".tag"]){case"file":return r;case"shared_folder":return n;case"file_folder":return i}return}(e,a);return u.useMemo((()=>{if(!r)return{isLoading:!0};const t=y(e,r);return r.isLoading||!t?{isLoading:!0}:r.error?t?{output:t,isLoading:!1,isError:!1}:{isLoading:!1,isError:!0,error:r.error.appError}:{output:t,isLoading:!1,isError:!1}}),[e,r])},e.useSharingAccountInfo=()=>{const e=v();return u.useMemo((()=>(null==e?void 0:e.isLoading)?{isLoading:!0}:(null==e?void 0:e.error)?{isLoading:!1,isError:!0}:{output:e.data.apiData,isLoading:!1,isError:!1}),[e])},e.useSharingObjectMetadata=e=>{const{isNonUserRelativeContext:a}=i.useSharingApiContext(),r=t.sharingObjectMetadataPackage.useQuery({apiArg:{file_id:e},pkgArg:{isNonUserRelativeContext:a}},{staleTime:3e5,enabled:!!e,retryDelay:e=>Math.min(1e3*2**e,3e4),retry:3});return u.useMemo((()=>e?!r||r.isLoading?{isLoading:!0}:r.error?{isLoading:!1,isError:!0,error:r.error.appError}:r.data&&r.data.apiData?{output:r.data.apiData,isLoading:!1,isError:!1}:{isLoading:!1,isError:!0,error:{".tag":"other"}}:{isLoading:!1,isError:!0,error:{".tag":"invalid_oid"}}),[r,e])},e.useShowSharingNotifcation=()=>{const a=s.useIntl(),r=n.useOpenUrl(),i=n.useSnackbar(),o=n.usePlatform()===n.Platforms.METASERVER;return u.default.useCallback((n=>{var s,l,c;if(o)switch(n.type){case e.SharingNotificationType.FAILURE:return void H(n.message);case e.SharingNotificationType.FAILURE_WITH_HELP:return void(({intl:e,title:a,onHelpButtonClick:r,helpButtonText:i})=>{const n=i||q(e);W(),t.Snackbar.show(u.default.createElement(t.Snackbar,{title:a,actionButtonText:n,onActionClick:r,variant:"fail",id:x}))})({intl:a,title:n.message,helpButtonText:null!==(s=n.helpMessage)&&void 0!==s?s:Q(a),onHelpButtonClick:()=>r(n.helpUrl)});case e.SharingNotificationType.COMPLETED:return void D(n.message);case e.SharingNotificationType.COMPLETED_WITH_ACTION:return void D(n.message,{actionButtonText:String(n.actionMessage),onActionClick:()=>n.actionOnClick()});case e.SharingNotificationType.COMPLETED_WITH_UNDO:return void(({title:e,onUndoClick:a})=>{W(),t.Snackbar.completeWithUndo(e,a,x,{timeoutDelayMs:2e4})})({title:n.message,onUndoClick:()=>n.undoOnClick()});case e.SharingNotificationType.IN_PROGRESS:return c=n.message,W(),void t.Snackbar.sync(c,!0,x)}else switch(n.type){case e.SharingNotificationType.FAILURE:return void i.showFailure({intl:a,message:n.message});case e.SharingNotificationType.FAILURE_WITH_HELP:return void i.showFailure({intl:a,message:n.message,helpMessage:null!==(l=n.helpMessage)&&void 0!==l?l:Q(a),helpUrl:n.helpUrl});case e.SharingNotificationType.COMPLETED:return void i.showCompleted({intl:a,message:n.message});case e.SharingNotificationType.COMPLETED_WITH_ACTION:return void i.showCompleted({intl:a,message:n.message,actionMessage:n.actionMessage,actionOnClick:n.actionOnClick});case e.SharingNotificationType.COMPLETED_WITH_UNDO:return void i.showCompleted({intl:a,message:n.message,actionMessage:B(a),actionOnClick:n.undoOnClick});case e.SharingNotificationType.IN_PROGRESS:return void i.showInProgress({intl:a,message:n.message})}}),[a,o,r,i])}}));
//# sourceMappingURL=c_src_utils_initials.js-vflaeHIdi.map

//# debugId=014157ae-ae1e-3715-8659-c3c0c31a1a5a