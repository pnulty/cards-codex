!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="78aadef1-01f4-3568-b7fc-5fd524ec9c45")}catch(e){}}();
define(["exports","react","./e_ui_page_files_router","./e_data_modules_stormcrow","./c_src_bindings_api-context"],(function(e,i,r,a,t){"use strict";function s(e){if(e&&e.__esModule)return e;var i=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(i,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}})),i.default=e,Object.freeze(i)}var o=s(i);function n(e){return e.ns("seen_state")}const l=["leave_a_copy","make_editor","make_owner","make_viewer","make_viewer_no_comment","remove"].map((e=>({".tag":e}))),d=e=>{if("shared_folder"===e[".tag"])return{shared_folder_id:e.sharedFolderId};if("file_folder"===e[".tag"])return{shared_folder_id:"0",path:e.path};throw new Error(`Unsupported object type: ${e[".tag"]}`)};const u=(e,i)=>{const{isNonUserRelativeContext:a}=t.useSharingApiContext();return("file"===e[".tag"]?r.sharingListFileMembersContinuePackage:r.sharingListFolderMembersContinuePackage).useQuery({apiArg:{cursor:i},pkgArg:{isNonUserRelativeContext:a}},{enabled:null!=i&&""!==i,staleTime:3e5})};const g=r.createApiv2Query({nsClient:n,rpc:"get_seen_state_info"}),f=(e,i)=>[{file_identifier:e,shared_link_details:i?{url:i}:void 0}];e.GetSeenStateRoutes=n,e.MEMBER_ACTIONS=l,e.fetchObjectMembers=async(e,i,t)=>{if("file"===e[".tag"]){const i=await r.sharingListFileMembersPackage.fetchQuery(a.queryClient,{apiArg:{file:e.fileId,actions:l,limit:100},pkgArg:{isNonUserRelativeContext:t}},{staleTime:3e5});if(i.apiData)return i.apiData}else if("shared_folder"===e[".tag"]||"file_folder"===e[".tag"]){const s=d(e),o=await r.sharingListFolderMembersPackage.fetchQuery(a.queryClient,{apiArg:{shared_folder_id:s.shared_folder_id,path:s.path,actions:l,limit:100},pkgArg:{isNonUserRelativeContext:t}},{enabled:("shared_folder"===e[".tag"]||"file_folder"===e[".tag"])&&i,staleTime:3e5});if(o.apiData)return o.apiData}},e.fetchSeenStateInfo=async(e,i,r)=>await g.fetchQuery(a.queryClient,{apiArg:{file_infos:f(e,i),limit:r}}),e.invalidateObjectMembers=async function(e){return"file"===e[".tag"]?await r.sharingListFileMembersPackage.invalidateQueries(a.queryClient):"shared_folder"===e[".tag"]||"file_folder"===e[".tag"]?await r.sharingListFolderMembersPackage.invalidateQueries(a.queryClient):void 0},e.seenStateInfoPackage=g,e.useObjectMembers=(e,i=!0,a=!0)=>{var s;const[n,g]=o.useState(),[f,c]=o.useState(),[_,v]=o.useState(),p=function(e,i){const{isNonUserRelativeContext:a}=t.useSharingApiContext(),s="file_folder"===e[".tag"]||"shared_folder"===e[".tag"]?d(e):null,o=r.sharingListFileMembersPackage.useQuery({apiArg:{file:"file"===e[".tag"]?e.fileId:"",actions:l,limit:100},pkgArg:{isNonUserRelativeContext:a}},{enabled:"file"===e[".tag"]&&i,staleTime:3e5}),n=r.sharingListFolderMembersPackage.useQuery({apiArg:{shared_folder_id:(null==s?void 0:s.shared_folder_id)||"",path:null==s?void 0:s.path,actions:l,limit:100},pkgArg:{isNonUserRelativeContext:a}},{enabled:("shared_folder"===e[".tag"]||"file_folder"===e[".tag"])&&i&&null!=s&&("shared_folder"===e[".tag"]&&!!s.shared_folder_id||"file_folder"===e[".tag"]&&!!s.path),staleTime:3e5});switch(e[".tag"]){case"file":return o;case"shared_folder":case"file_folder":return n}return}(e,a);o.useEffect((()=>{var e,r;c(null===(e=null==p?void 0:p.data)||void 0===e?void 0:e.apiData),i||g(null===(r=null==p?void 0:p.data)||void 0===r?void 0:r.apiData.cursor)}),[null==p?void 0:p.data,i]);const h=u(e,n);return o.useEffect((()=>{var e,i;if((null==h?void 0:h.isError)&&(v(null===(e=h.error)||void 0===e?void 0:e.appError),g(void 0)),null===(i=null==h?void 0:h.data)||void 0===i?void 0:i.apiData){const e=h.data.apiData;c((i=>{return i?(a=e,{groups:[...(r=i).groups,...a.groups],invitees:[...r.invitees,...a.invitees],users:[...r.users,...a.users]}):e;var r,a})),g(e.cursor),v(void 0)}}),[null==h?void 0:h.isError,null==h?void 0:h.data,null===(s=null==h?void 0:h.error)||void 0===s?void 0:s.appError]),o.useMemo((()=>{var e;const r=null==p?void 0:p.isLoading,a=!r&&!(null==p?void 0:p.isError),t=null==p?void 0:p.isError,s=null==h?void 0:h.isError,o=null==h?void 0:h.isLoading,n=!o&&!s;return r||!p?{isLoading:!0,isFirstPageLoaded:!1}:!a&&t?{isLoading:!1,isFirstPageLoaded:!1,isError:!0,error:null===(e=p.error)||void 0===e?void 0:e.appError}:a&&i?{isFirstPageOnly:!0,isLoading:!1,isFirstPageLoaded:!0,firstPage:p.data.apiData,hadContinuationError:!1}:a&&!i&&o&&f?{isLoading:!0,isFirstPageLoaded:!0,allMembers:f,hadContinuationError:!1,isFirstPageOnly:!1}:a&&!i&&n&&f?{isLoading:!1,isFirstPageLoaded:!0,allMembers:f,hadContinuationError:!1,isFirstPageOnly:!1}:a&&!i&&!o&&s&&f?{isLoading:!1,isFirstPageLoaded:!0,allMembers:f,hadContinuationError:!0,isFirstPageOnly:!1,continuationError:_}:{isLoading:!0,isFirstPageLoaded:!1}}),[p,h,i,f,_])},e.useSeenStateInfo=(e,i,r)=>g.useQuery({apiArg:{file_infos:f(e,i),limit:r}})}));
//# sourceMappingURL=c_react_query_api_helpers_queries_seen_state_info.js-vflKgJWxI.map

//# debugId=78aadef1-01f4-3568-b7fc-5fd524ec9c45