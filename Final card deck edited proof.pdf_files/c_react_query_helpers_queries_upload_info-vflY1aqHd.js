!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="984b2b35-102f-34db-b6f3-ee99c1409398")}catch(e){}}();
define(["require","exports","react","./e_ui_page_files_router","./c_conversions_actions_unzip","./c_extensions_data_selectors","./c_replay_replay_extensions","./c_pdf_editor_utils_entry_point_util","./c_action_bar_action_bar_constants","./c_google_one_tap_google_one_tap_platform","./c_action_bar_action_bar_strings","./c_file_viewer_api_navigation","./c_file_viewer_api_ui","./c_share_modal_evolution_utils_logging","./c_src_common_format_bytes","./c_sharing_sharing_pap_logging_common_util","./c_sharing_sharing_pap_logging_shared_link_util","./c_pap-events_replay_shown_modal","./e_edison","./c_bem","./c_src_sink_index","./c_core_i18n","./c_dig-components_breadcrumb_index","./c_portable_delete","./c_portable_delete_snackbars","./c_files_view_file_actions_snackbars","./c_file_viewer_api_data","./c_file_viewer_toolbar_utils","./c_viewer_helpers","./c_react_query_helpers_queries_file_content_metadata","./c_file_viewer_toolbar_action_bar","./c_file_viewer_components_preview","./c_integrations_hellosign_deep_integration_constants","./c_api_v2_redux_base_action","./c_file_viewer_components_preview_button","./c_react-use_useBeforeUnload","./e_core_exception","./c_file_viewer_preview_logger","./c_unity_features","./c_contacts_fetch","./c_core_utils_region","./c_lodash-es_lodash","./c_dig-icons_assets_ui-icon_line_redo","./c_file_viewer_keyboard_keyboard_connector","./c_file_viewer_logging_timing","./e_data_modules_stormcrow"],(function(e,t,n,a,i,o,r,s,l,c,d,u,_,m,f,p,g,v,h,y,b,E,w,S,C,M,x,A,I,T,k,N,R,D,L,O,F,P,U,B,V,z,q,H,W,K){"use strict";function j(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var G=j(n);const Q=e=>!("isDeleted"in e)||!("is_unmounted"in e)||!e.isDeleted&&!e.is_unmounted,Z=e=>{var t;return"per_node_metadata"in e&&!!(null===(t=e.per_node_metadata)||void 0===t?void 0:t.link_node)};const $=e=>{const t=`.${a.getExtension(e)}`,n=r.isReplayFileTypeWithPDFAndPSD(t);let i=!1;return".pdf"===t&&e.bytes>=r.MAX_DOCUMENT_UPLOAD_SIZE&&(i=!0),!(e instanceof a.FileSharedWithMe)&&Q(e)&&a.isBrowseFile(e)&&!a.isEncryptedFile(e)&&n&&!i},Y=()=>{var e,t,n;const{variant:i}=a.useExperimentVariant("bfd_2025_10_24_video_transcript_results_in_search"),{variant:o}=a.useExperimentVariant("bfd_dash_chat_in_fss"),{data:r}=a.useDashAccess(),s="ON"===i&&"ON_M1"===o,l=null!==(n=null===(t=null===(e=null==r?void 0:r.apiData)||void 0===e?void 0:e.feature_attributes)||void 0===t?void 0:t.has_chat_in_fss)&&void 0!==n&&n;return s&&l},X=(t,n)=>async i=>{const{Store:o,ungatedDBStore:r}=await new Promise((function(t,n){e(["./c_ungated_idx_db_access_lib"],t,n)})).then((function(e){return e.idx_db_access_lib_esnext})),s=await r.getLatestUngatedSessionKeyForStore(t===a.PreviewType.SsrDoc?o.PDF_EDIT_STORE:o.IMG_EDIT_STORE);if(s){const e=await r.getFileMetadata(s);i===a.Mode.REGISTER&&await r.saveFileMetadata(s,{...e,user_registered:"true"})}n?a.redirect(n):a.reload()};async function J({mode:t,kind:n,sharedLinkUrl:i,encryptionOptions:o,commentParams:r,loggingExtra:s,webSignInTag:l,signupTag:d,onCancel:u,authDialogPreviousElement:_,previewType:m,sharedLinkInfo:f}){if(t===a.Mode.LOGIN&&!o)throw new Error("encryptionOptions should be provided for login modal");const[{Modal:p},{LoginOrRegisterModal:g}]=await Promise.all([new Promise((function(t,n){e(["./e_ui_page_files_router"],t,n)})).then((function(e){return e.modal_esnext})),new Promise((function(t,n){e(["./c_auth_login_or_register_modal"],t,n)}))]),v=i;let h=i;const y=n===a.LoginOrRegisterKind.SHARED_LINK_UNGATED_EDIT&&m?X(m,i):void 0;if(h){const e=new URL(h);e.searchParams.set("from_auth","register"),h=e.href}p.showInstance(G.default.createElement(g,{downloadAction:null,id:"shared-link-immediate-signup-modal",initialMode:t,kind:n,onCancel:()=>{null==u||u(),p.close()},onAuthenticateSuccess:(e,t)=>{if(y)y(t);else{if(t===a.Mode.REGISTER){const e=new URL(h||window.location.href);return e.searchParams.set("from_auth","register"),void window.location.assign(e.href)}window.location.reload()}},commentParams:r,signup_tag:d||c.RegistrationSource.SHMODEL_MODAL_REGISTER,showGoogleRegistration:!0,loginContinuationUrl:v,registrationContinuationUrl:h,encryptionOptions:o,loggingExtra:s,webSignInTag:l||"file_viewer_default",authDialogPreviousElement:_,sharedLinkInfo:f}))}var ee=Object.freeze({__proto__:null,showAuthModal:J});const te=(e,t)=>{const{previewType:n,previewSurface:a,file:i,user:o,sharePermission:r,isNestedArchiveFile:s,canRestoreRevision:l,sharedLinkInfo:c}=e,{shouldShowForPreviewType:d,shouldShowForPreviewSurface:u,filterValidUser:_,filterValidFile:m}=t,f=_(o),p=m(i,r,s,l,c);if(d(n)&&u(a)&&f&&p)return{user:f,file:p}},ne=()=>!0,ae=e=>e?{user:e}:void 0,ie=e=>t=>e.includes(t),oe=e=>ie(e),re=e=>!(e instanceof a.FileSharedWithMe)&&a.isBrowseFile(e)&&!Z(e)&&Q(e),se=e=>e!==a.SDKPreviewSurface.VERSION_HISTORY,le={shouldShowForPreviewSurface:se,shouldShowForPreviewType:ne,filterValidUser:ae,filterValidFile:e=>re(e)?e:void 0},ce={shouldShowForPreviewSurface:se,shouldShowForPreviewType:ne,filterValidUser:ae,filterValidFile:(e,t,n)=>re(e)&&!n?e:void 0};function de(e){return void 0!==e&&"document"===e.type}function ue(e){return void 0!==e&&("audio"===e.type||"video"===e.type)}function _e(e){const{annotation:t}=e;return!!t&&ue(t)}const me=e=>0===e.x&&0===e.y&&1===e.width&&1===e.height,fe=(e,t=!1)=>{return e?Object.values(e).sort((n=t,(e,t)=>{const a=_e(e)?e.annotation.time:0,i=_e(t)?t.annotation.time:0;return a!==i?a-i:n?+t.timestamp-+e.timestamp:+e.timestamp-+t.timestamp})):[];var n};function pe(e){return"annotating"===e||"annotating-ax"===e||"commenting"===e}function ge(e){var t;const{data:n}=T.useFileContentMetadataQuery(e),a=null===(t=null==n?void 0:n.apiData)||void 0===t?void 0:t.metadata;if(a)return"video"===a[".tag"]?a.frame_rate:void 0}const ve=e=>e!==a.PreviewType.CloudDoc;a.injectInternalStyle("/static/typescript/component_libraries/files_components/src/sidebar/sidebar.module.out-vflo20QzF.css",(e=>"._sidebar-content_g0g9o_1{box-sizing:border-box;height:100%;padding:var(--spacing__unit--2)}._sidebar-content-icon-container_g0g9o_7{color:var(--dig-color__text__base);display:flex}._sidebar-title_g0g9o_13{margin:0}._sidebar-background_g0g9o_17{background-color:var(--dig-color__background__raised)}"));const he="_sidebar-content_g0g9o_1",ye="_sidebar-content-icon-container_g0g9o_7",be="_sidebar-title_g0g9o_13",Ee="_sidebar-background_g0g9o_17",we=({icon:e,title:t,titleAccessory:n,content:i,handleClose:o,closeLabel:r,contentClassName:s})=>{const l=a.cx(he,s);return G.createElement(a.Drawer.Container,{"data-testid":"side-bar-container"},G.createElement(a.Drawer.Header,{className:Ee},G.createElement(a.Drawer.Layout,null,G.createElement(a.Drawer.LayoutItem,null,G.createElement("div",{className:ye},e)),G.createElement(a.Drawer.LayoutItem,{width:"fill"},G.createElement(a.Text,{isBold:!0,variant:"label",tagName:"h2",className:be},t)),G.createElement(a.Drawer.LayoutItem,null,n),G.createElement(a.Drawer.LayoutItem,null,G.createElement(a.IconButton,{onClick:o,variant:"transparent"},G.createElement(a.UIIcon,{"aria-label":r,src:a.CloseLine}))))),G.createElement(a.Drawer.Body,{className:Ee},G.createElement("div",{className:l},i)))};we.displayName="Sidebar";const Se=e=>a.Snackbar.sync(E.intl.formatMessage(a.renameSnackbarProgressMessage),!1,e),Ce=e=>a.Snackbar.complete(E.intl.formatMessage(a.renameSnackbarSuccessMessage),e),Me=(e,t,n)=>a.Snackbar.fail(M.renameError(e.error),n);var xe=Object.freeze({__proto__:null,renameCompleteSnackBar:Ce,renameFailedSnackBar:Me,renameSnackBarInProgress:Se});const Ae=(e,t,n)=>{const{logUserAction:i}=a.useFileViewerContext();return G.default.useCallback(((o,r)=>"fq_path"in e&&t&&(async({file:e,newFilename:t,logUserAction:n,user:i,onFileChanged:o,actionContext:r})=>{if(!a.isBrowseFile(e))return;n(a.UserAction.RenameStart,r);const s=a.isRenameValid(t,a.getExtension(e));let l;if(s&&(Se(a.PREVIEWS_SNACKBAR_ID),l=await a.renameFile(e.fq_path,t,i,{checkFSWs:!0})),!l||l.isError||"success"!==l.result.entries[0][".tag"])return n(a.UserAction.RenameFailed,r),void Me(s?(null==l?void 0:l.isError)?l:a.createUndefinedRpcResult():{...a.createUndefinedRpcResult(),error:{".tag":"to",to:{".tag":"malformed_path",malformed_path:{}}}},e.fq_path,a.PREVIEWS_SNACKBAR_ID);const c=l.result.entries[0].success;n(a.UserAction.RenameSuccess,r),o&&c&&"file"===c[".tag"]&&o(e,{fq_path:c.path_display||e.fq_path,revision_id:c.rev,file_id:c.id}),Ce(a.PREVIEWS_SNACKBAR_ID)})({logUserAction:i,file:e,newFilename:r,user:t,actionContext:o,onFileChanged:n})),[e,i,n,t])};a.injectInternalStyle("/static/metaserver/static/js/file_viewer/title_bar/title_bar_file_breadcrumb.module.out-vfl08dPor.css",(e=>`._title-bar-file-breadcrumb_rw093_1{min-width:0}._title-bar-folder_rw093_6{margin-right:-2px}._title-bar-folder-hidden-menu_rw093_10{letter-spacing:0;margin-right:-2px;padding:0 var(--dig-spacing__micro__small)}._title-bar-folder_rw093_6 .dig-Button-content{letter-spacing:0;padding:0 var(--dig-spacing__micro__small)}._title-bar-folder-no-left-padding_rw093_21 .dig-Button-content{padding:0 var(--dig-spacing__micro__small) 0 0}._file-name-editing-container_rw093_25{border-radius:var(--dig-radius__medium);overflow:hidden}._file-name-container_rw093_30{align-items:baseline;display:flex;gap:var(--dig-spacing__micro__small);margin-left:2px;min-width:0}._file-name_rw093_25{padding-left:var(--dig-spacing__micro__small)}._file-name__font-change_rw093_42{font-family:var(--dig-type__family__title)}._folder-name_rw093_46{max-width:1000px}@-moz-document url-prefix(){@font-face{font-family:Atlas Grotesk FF;font-style:normal;font-weight:400;size-adjust:85%;src:url(${e("/static/metaserver/static/fonts/dig-fonts/atlas_grotesk/AtlasGrotesk-Regular-Web-vflk7bxjs.woff2")}) format("woff2"),url(${e("/static/metaserver/static/fonts/dig-fonts/atlas_grotesk/AtlasGrotesk-Regular-Web-vflyEJFZg.woff")}) format("woff"),url(${e("/static/metaserver/static/fonts/dig-fonts/atlas_grotesk/AtlasGrotesk-Regular-Web-vflJ3txfq.ttf")}) format("truetype");unicode-range:u+30-39}}`));const Ie="_file-name__font-change_rw093_42",Te=n.forwardRef((({fileName:e,allowRename:t,showExpandedView:o,hideFileExtension:r,file:s,user:l,onFileChanged:c},d)=>{const m=E.useIntl(),f=G.default.useRef(null),[p,g]=G.default.useState(e),v=_.useIsRenameActive(),[h,y]=G.default.useState(.5*window.innerWidth),[b,w]=G.default.useState(0),S=G.default.useRef(null),{logUserAction:C}=a.useFileViewerContext(),M=i.split_filename(e);G.default.useEffect((()=>{window.requestAnimationFrame((()=>{if(!f.current)return;f.current.focus();const t=e;let n=t.lastIndexOf(".");n<0&&(n=t.length),f.current.setSelectionRange(0,n)}))}),[e,v]),G.default.useEffect((()=>{S.current&&w(S.current.offsetWidth)}),[S,e,v]),G.default.useEffect((()=>{const e=()=>{y(.5*window.innerWidth)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[e]);const x=u.useToggleRenameStateCallback(),A=Ae(s,l,c),I=G.default.useCallback((()=>{p&&e!==p?A(a.UserActionContext.PreviewTitlebar,p):g(e),x(!1)}),[p,e,x,A]),T=G.default.useCallback((()=>{C(a.UserAction.RenameFailed,a.UserActionContext.PreviewTitlebar),g(e),x(!1)}),[e,C,x]),k=G.default.useCallback((()=>{C(a.UserAction.Rename,a.UserActionContext.PreviewTitlebar),g(e),x(!0)}),[e,C,x]);return n.useImperativeHandle(d,(()=>({handleEnter(){k()}})),[k]),v?G.default.createElement("div",{className:"_file-name-editing-container_rw093_25"},G.default.createElement("span",{ref:S,style:{position:"absolute",opacity:0,zIndex:-100}},G.default.createElement(a.Text,null,p)),G.default.createElement(a.TextInput,{"data-testid":"file-name-display-text-input",ref:f,"aria-label":m.formatMessage({id:"XlFxo+",defaultMessage:"filename"}),value:p,onChange:e=>g(e.currentTarget.value),onKeyDown:e=>{e.key===a.Key_enum.Key.Enter?(e.stopPropagation(),I()):e.key===a.Key_enum.Key.Escape&&(e.stopPropagation(),T())},onBlur:I,style:{width:b,maxWidth:h}})):o?G.default.createElement("div",{className:"_file-name-container_rw093_30",onDoubleClick:t?k:void 0,tabIndex:0},G.default.createElement(a.Text,{size:"large",isBold:!0,className:Ie},M.name),!r&&G.default.createElement(a.Text,{style:{textTransform:"uppercase"},className:a.atoms({fontFamily:"Text",fontSize:"Text Small",fontWeight:"Base",color:"Text Subtle"})},M.ext)):G.default.createElement(a.Text,{className:a.cx(Ie,"_file-name_rw093_25"),size:"large",isBold:!0,onDoubleClick:t?k:void 0},e)})),ke=({viewer:e,user:t,onFileChanged:o,inEditMode:r,file:s,breakpoint:l,shouldUseAlternateStyling:c,hideFolderAndFileExtension:d=!1,hideFolderMenu:m=!1})=>{const f=E.useIntl(),p=x.useArchiveSubpath(),g=_.useIsFullscreen(),v=u.useUpdateArchiveFileCurrentPathCallback(),h=n.useRef(null),y=G.default.useCallback(((e,t,n)=>m?G.default.createElement(a.Text,{className:`_title-bar-folder-hidden-menu_rw093_10 ${a.atoms({fontSize:"Text Small",fontWeight:"Base",color:"Text Subtle"})}`},e):G.default.createElement(w.Breadcrumb.Link,{key:"folderMenu"},G.default.createElement(a.Menu.Wrapper,null,(({getTriggerProps:i,getContentProps:o})=>{const r=o();return G.default.createElement(G.default.Fragment,null,G.default.createElement(a.Button,{className:n?"_title-bar-folder-no-left-padding_rw093_21":"_title-bar-folder_rw093_6",variant:r.open?"opacity":"borderless",size:"small",...i()},G.default.createElement(a.Text,{className:`_folder-name_rw093_46 ${a.atoms({fontSize:"Text Small",fontWeight:"Base",color:"Text Subtle"})}`},e)),G.default.createElement(a.Menu.Content,{...r},G.default.createElement(a.Menu.Segment,null,...t)))})))),[m]),b=G.default.useCallback(((e,n,i,r,l,c)=>G.default.createElement(w.Breadcrumb.Link,{href:()=>v(r.slice(1,n+1),!0),isCurrentPath:i,key:`${n}-${e}`},G.default.createElement(Te,{ref:h,file:s,user:t,onFileChanged:o,fileName:e,allowRename:!c&&!(s instanceof a.FileSharedWithMe)&&ce.filterValidFile(s)&&(!a.isBrowseFile(s)||!s.read_only),showExpandedView:!0,hideFileExtension:d||l}))),[s,d,o,v,t]),S=x.useIsNestedArchiveFile(),C=n.useMemo((()=>{const n=[],u=[],_=s instanceof a.FileSharedWithMe?s.filename:a.getFilename(s),m=!!p,E=m?[_].concat(p):[];if(!r&&!g&&t&&!(s instanceof a.FileSharedWithMe)&&a.isBrowseFile(s)){const o=I.deprecatedGetRootName(f,e,t),r=i.parent_dirs(s.fq_path).reverse();r.unshift(""),r.forEach(((s,l)=>{const d=a.browse_uri_for_fq_path(e,t,s);n.push(G.default.createElement(a.Menu.LinkItem,{key:s,href:d.toString(),onClick:()=>a.redirect(d)},i.filename(s,o))),l===r.length-1&&E.length<2&&u.push(y(i.filename(s,o),n,c))}))}const C=u;return m?E.forEach(((e,t)=>{const i=t===E.length-1;i?u.push(b(e,t,i,E,c||d,S)):n.push(G.default.createElement(a.Menu.ActionItem,{onClick:()=>v(E.slice(1,t+1),!0),key:`${t}-${e}`},e)),t===E.length-2&&u.push(y(e,n,c))})):C.push(G.default.createElement(w.Breadcrumb.Link,{isCurrentPath:!0,key:_,tabIndex:0,onKeyDown:e=>{e.key===a.Key_enum.Key.Enter&&h.current&&h.current.handleEnter()}},G.default.createElement(Te,{ref:h,file:s,user:t,onFileChanged:o,fileName:_,allowRename:!r&&!(s instanceof a.FileSharedWithMe)&&a.isBrowseFile(s),showExpandedView:!r,hideFileExtension:d}))),l===A.FileViewerBreakpoint.SM||d?C.slice(-1):C}),[e,s,p,r,g,t,l,d,f,y,c,b,S,v,o]);return G.default.createElement(w.Breadcrumb,{"aria-label":f.formatMessage({id:"vWiotS",defaultMessage:"Breadcrumb"}),alwaysShowRoot:!0,className:"_title-bar-file-breadcrumb_rw093_1","data-tooltip":"title-bar-breadcrumb"},C)};ke.displayName="TitleBarFileBreadcrumb";const Ne=(e,t)=>({type:"click",handler:e,keyboardBinding:t}),Re={...{shouldShowForPreviewSurface:oe([a.SDKPreviewSurface.BROWSE,a.SDKPreviewSurface.SEARCH,a.SDKPreviewSurface.STANDALONE_PREVIEW,a.SDKPreviewSurface.FILE_LOCKING,a.SDKPreviewSurface.RECENTS,a.SDKPreviewSurface.STARRED,a.SDKPreviewSurface.HOME,a.SDKPreviewSurface.INBAND_SHARE,a.SDKPreviewSurface.SHARED_CONTENT_LINK,a.SDKPreviewSurface.SHARED_LINK,a.SDKPreviewSurface.SHARED_COLLECTION,a.SDKPreviewSurface.HELLOSIGN,a.SDKPreviewSurface.PHOTOS,a.SDKPreviewSurface.QUICK_VIEW_BROWSE,a.SDKPreviewSurface.QUICK_VIEW_SEARCH,a.SDKPreviewSurface.FSS_DESKTOP_PREVIEW,a.SDKPreviewSurface.POLLUX_DESKTOP_PREVIEW,a.SDKPreviewSurface.POLLUX_DESKTOP_SEARCH_PREVIEW]),shouldShowForPreviewType:ne,filterValidUser:e=>({user:e})},filterValidFile:(e,t)=>s.showEditPlugin(e,t)?e:void 0},De={filterValidFile:e=>Q(e)&&!Z(e)?e:void 0,filterValidUser:ae,shouldShowForPreviewSurface:oe([a.SDKPreviewSurface.BACKUP,a.SDKPreviewSurface.BROWSE,a.SDKPreviewSurface.FILE_LOCKING,a.SDKPreviewSurface.HELLOSIGN,a.SDKPreviewSurface.HOME,a.SDKPreviewSurface.INBAND_SHARE,a.SDKPreviewSurface.PHOTOS,a.SDKPreviewSurface.RECENTS,a.SDKPreviewSurface.SEARCH,a.SDKPreviewSurface.SHARED_CONTENT_LINK,a.SDKPreviewSurface.SHARED_LINK,a.SDKPreviewSurface.SHARED_COLLECTION,a.SDKPreviewSurface.STANDALONE_PREVIEW,a.SDKPreviewSurface.STARRED,a.SDKPreviewSurface.QUICK_VIEW_BROWSE,a.SDKPreviewSurface.QUICK_VIEW_SEARCH,a.SDKPreviewSurface.FSS_DESKTOP_PREVIEW]),shouldShowForPreviewType:ne},Le=N.asyncComponent("OpenInMenuContent",(()=>new Promise((function(t,n){e(["./c_action_plugins_open_in_action_dropdown"],t,n)})))),Oe=e=>{let t,n,i;e.header&&(t=G.default.createElement(a.Modal$1.Title,null,E.intl.formatMessage(e.header))),e.body&&(n=E.intl.formatMessage(e.body)),e.bodyAddOn&&(i=E.intl.formatMessage(e.bodyAddOn));const o=e.confirmationString||D.ConfirmationModalStrings.confirmButton;return G.default.createElement(a.Modal$1,{open:e.isOpen,isCentered:!0,withCloseButton:E.intl.formatMessage(D.CommonStrings.close),onRequestClose:e.close,"data-testid":"pdf-editor-confirmation-modal"},G.default.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},t),G.default.createElement(a.Modal$1.Body,{hasVerticalSpacing:!1},n,G.default.createElement("br",null),G.default.createElement("br",null),i),G.default.createElement(a.Modal$1.Footer,null,e.additionalCloseButton&&G.default.createElement(a.Button,{variant:"opacity",onClick:e.close},E.intl.formatMessage(e.additionalCloseButton)),G.default.createElement(a.Button,{variant:"primary",onClick:()=>{e.confirmRedirect?window.open(e.confirmRedirect):e.onConfirm?e.onConfirm():e.close()},withIconLeft:e.confirmRedirect?G.default.createElement(a.UIIcon,{src:a.OpenLine}):null},E.intl.formatMessage(o))))};Oe.displayName="ConfirmationModal";a.injectInternalStyle("/static/js/file_viewer/toolbar/zoom_controls.module.out-vflZO0n7q.css",(e=>"._zoom-controls_19i79_1{align-items:center;display:flex;padding-right:0}._zoom-button-wrapper_19i79_7{padding-left:var(--dig-spacing__micro__xsmall)}._zoom-button-spacing_19i79_11{padding:0 var(--dig-spacing__micro__small)}"));const Fe=({previewType:e,callbacks:t,breakpoint:n=A.FileViewerBreakpoint.LG})=>{const{onZoomOut:i,onZoomIn:o,onZoomToPercent:r,onFitToWidthOrPage:s}=t,l=E.useIntl(),{featureConfig:c}=a.useFileViewerContext(),d=a.useCurrentPreviewMetadata(),m=_.useZoomScaleFactor(),f=l.formatMessage({id:"0ZiqhW",defaultMessage:"Zoom out"}),p=l.formatMessage({id:"yuwJIR",defaultMessage:"Zoom in"}),g=u.getWillCloudDocPreviewAsSsrDoc(c,d);return void 0!==m&&([a.PreviewType.Image,a.PreviewType.SsrDoc].includes(e)||g)?G.createElement("div",{className:"_zoom-controls_19i79_1"},G.createElement(A.ToolbarIcon,{label:f,onClick:i,icon:O.ZoomOutLine,disabled:m<=.01,variant:"borderless"}),G.createElement(A.ToolbarIcon,{label:p,onClick:o,icon:O.ZoomInLine,disabled:m>=64,variant:"borderless"}),n!==A.FileViewerBreakpoint.SM&&G.createElement("div",{className:"_zoom-button-spacing_19i79_11"},G.createElement(Ue,{scaleFactor:m,previewType:e,callbacks:{onZoomToPercent:r,onFitToWidthOrPage:s}}))):null};Fe.displayName="ZoomControls";const Pe=[.1,.25,.5,.75,1,1.25,1.5,2,4,8,16,64],Ue=({scaleFactor:e,callbacks:t})=>{const{onZoomToPercent:n,onFitToWidthOrPage:i}=t,o=E.useIntl(),{logUserAction:r}=a.useFileViewerContext(),s=o.formatNumber(e,{style:"percent",maximumFractionDigits:0}),l=o.formatMessage({id:"XHCS37",defaultMessage:"Zoom percentage dropdown button; {percentage}"},{percentage:s}),c=a.useStabilizedCallback((e=>{"fit_to_width"===e?(r(a.UserAction.ZoomFitToWidth,a.UserActionContext.PreviewToolbar),i(!0)):"fit_to_page"===e?(r(a.UserAction.ZoomFitToPage,a.UserActionContext.PreviewToolbar),i(!1)):(r(a.UserAction.ZoomChangePercentage,a.UserActionContext.PreviewToolbar),n(e))}));return G.createElement(a.Menu.Wrapper,{onSelection:c},(({getTriggerProps:t,getContentProps:n})=>G.createElement(G.Fragment,null,G.createElement(L.PreviewButton,{...t(),variant:"outline","aria-label":l,hasNoUnderline:!0,withDropdownIcon:!0},o.formatNumber(e,{style:"percent",maximumFractionDigits:0})),G.createElement(a.Menu.Content,{...n()},G.createElement(a.Menu.Segment,null,G.createElement(a.Menu.ActionItem,{value:"fit_to_width"},o.formatMessage({id:"WCG5C5",defaultMessage:"Fit to width"})),G.createElement(a.Menu.ActionItem,{value:"fit_to_page"},o.formatMessage({id:"nfpyB1",defaultMessage:"Fit to page"}))),G.createElement(a.Menu.Segment,null,Pe.map((e=>G.createElement(a.Menu.ActionItem,{key:e,value:e},o.formatNumber(e,{style:"percent",maximumFractionDigits:0})))))))))};Ue.displayName="ZoomButton";const Be=e=>{const{breakpoint:t,actionContext:n}=e,{logUserAction:i}=a.useFileViewerContext(),o=a.useCurrentPreviewMetadata().previewType,r=a.useSetFileViewerAtom(_.zoomInOrOutAtom),s=a.useStabilizedCallback((()=>{r(!1),i(a.UserAction.ZoomOut,null!=n?n:a.UserActionContext.Toolbar)})),l=a.useStabilizedCallback((()=>{r(!0),i(a.UserAction.ZoomIn,null!=n?n:a.UserActionContext.Toolbar)})),c=u.useUpdateZoomCallback(),d=a.useStabilizedCallback((e=>{e&&c({zoomType:"zoomPercent",newZoom:e})})),m=a.useStabilizedCallback((e=>{c({zoomType:"fitToPage"})}));return G.default.createElement(Fe,{previewType:o,callbacks:{onZoomOut:s,onZoomIn:l,onZoomToPercent:d,onFitToWidthOrPage:m},breakpoint:t})};let Ve;function ze(){(function(){const e=document;return null!=e.fullScreen?e.fullScreen:null!=e.webkitIsFullScreen?e.webkitIsFullScreen:null!=e.mozFullScreen?e.mozFullScreen:null!=e.msFullscreenElement||null!=e.fullscreenElement})()||(null==Ve||Ve(),We())}function qe(){null==Ve||Ve(),je()}function He(){var e;e=ze,document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),document.addEventListener("mozfullscreenchange",e),function(e){window.addEventListener("popstate",e)}(qe)}function We(){var e;e=ze,document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e),document.removeEventListener("mozfullscreenchange",e),function(e){window.removeEventListener("popstate",e)}(qe),Ve=()=>{}}function Ke({onExitFunction:e}){!function(e){Ve=e}(e),function(){const e=document.body;null!=e.requestFullscreen?e.requestFullscreen():null!=e.msRequestFullscreen?e.msRequestFullscreen():null!=e.mozRequestFullScreen?e.mozRequestFullScreen():null!=e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}(),He()}function je(){We(),function(){const e=document;e.exitFullscreen?e.exitFullscreen().catch((()=>{})):e.msExitFullscreen?e.msExitFullscreen().catch((()=>{})):e.mozCancelFullScreen?e.mozCancelFullScreen().catch((()=>{})):e.webkitExitFullscreen&&e.webkitExitFullscreen().catch((()=>{}))}()}Be.displayName="PreviewZoomControl";const Ge="file_viewer_left_sidebar_preference",Qe="file_viewer_right_sidebar_preference",Ze="file_viewer_doc_sidebar_collapsed_preference",$e="file_viewer_video_volume_preference",Ye="file_viewer_video_muted_preference",Xe="file_viewer_ui_hidden_preference",Je="file_viewer_ui_links_warning",et="file_viewer_line_numbers_hidden_preference",tt="file_viewer_finder_prompt_hidden",nt="file_viewer_shared_link_desktop_modal_hidden";function at(e){const t=a.get_uri().getQuery();return e in t?t[e]:null}function it(){return a.DBHistory.get_uri().getQuery()}function ot(e,t){const n=a.DBHistory.get_uri();null!==t?n.updateQuery(e,t):n.removeQuery(e),a.DBHistory.push_state(n.getPath(),n.getQuery())}function rt(e,t){const n=`/${a.get_uri().getPath().split("/")[1]}`,i=(n,a)=>{let i=null;if(e in a){const t=a[e];i=t instanceof Array?t.length?t[0]:null:null!=t?t:null}t(e,i)};return a.DBHistory.add_callback(n,i,!0),()=>a.DBHistory.remove_callback(n,i)}function st(e,t){t?a.safe_open_tab_and_redirect(e):a.redirect$1(e)}function lt(){a.reload()}function ct(e){const t=a.DBHistory.get_uri();a.DBHistory.replace_state(t.getPath(),e)}const dt=(e,t)=>({event_name:e,client_timestamp_ms:a.WebTimingUtil.getNow(),file_preview_session_id:t.file_preview_session_id,video_format:t.video_format,video_duration_seconds:t.video_duration_seconds,video_truncated:t.video_truncated,ns_id:t.ns_id,sj_id:t.sj_id,file_id:t.file_id,extra:JSON.stringify({...t.extra})}),ut=e=>({file_preview_session_id:e.file_preview_session_id,file_viewer_session_id:e.file_viewer_session_id,device_type:e.device_type,extra:{...e.extra,video_format:`${e.video_format}`,video_duration_seconds:`${e.video_duration_seconds}`,video_truncated:`${e.video_truncated}`,source_context:e.source_context,preview_type:e.preview_type}}),_t=(e,t,n)=>{const a=dt(e,n),i=ut(n);P.logQuantityToAMISAndUDCL(e,t,"web_audiovideo_previews",i,void 0,a)};class mt{constructor(){this.client=null}subscribe(e,t,n){const i=new a.SignedChannelState(e.app_id,e.unique_id,e.revision,e.token);this.client?this.client.update_states([i]):(this.client=new a.MetaserverBoltClient([i],t,n),this.client.start())}unsubscribe(){this.client&&(this.client.unsubscribe(),this.client=null)}}const ft="reactions";function pt(e){return{class:"previews",action:"comment",object:"file",properties:e}}function gt(e){return{class:"previews",action:"comment",object:"file_add_name",properties:e}}function vt(e){return{class:"previews",action:"comment",object:"file_area",properties:e}}function ht(e){return{class:"previews",action:"comment",object:"comment",properties:e}}function yt(e){return{class:"previews",action:"comment",object:"file_timestamp",properties:e}}function bt(e){return{class:"previews",action:"select",object:"comments_sticker_pane",properties:e}}function Et(e){return{class:"previews",action:"select",object:"comments_mentions_pane",properties:e}}const wt=["newest","oldest","unread","timestamp","page"];function St(e){return{class:"previews",action:"select",object:"comment_action",properties:e}}function Ct(e){return{class:"previews",action:"add",object:"comment_reaction",properties:e}}function Mt(e){return{class:"previews",action:"remove",object:"comment_reaction",properties:e}}var xt;t.SortType=void 0,(xt=t.SortType||(t.SortType={})).newest="newest",xt.oldest="oldest",xt.unread="unread",xt.timestamp="timestamp",xt.page="page";const At=[t.SortType.newest,t.SortType.oldest,t.SortType.unread,t.SortType.page,t.SortType.timestamp],It=[t.SortType.newest,t.SortType.oldest,t.SortType.unread],Tt=[...It,t.SortType.timestamp],kt=[...It,t.SortType.page];var Nt;t.CommentsEventName=void 0,(Nt=t.CommentsEventName||(t.CommentsEventName={})).ADD_COMMENT="add_comment",Nt.POST_COMMENT="post_comment",Nt.DELETE_COMMENT="delete_comment",Nt.REPLY_COMMENT="reply_comment",Nt.START_EDIT_COMMENT="start_edit_comment",Nt.EDIT_COMMENT="edit_comment",Nt.RESOLVE_COMMENT="resolve_comment",Nt.UNRESOLVE_COMMENT="unresolve_comment",Nt.SUBSCRIBE_COMMENTS="subscribe_comments",Nt.UNSUBSCRIBE_COMMENTS="unsubscribe_comments",Nt.DISABLE_COMMENTS="disable_comments",Nt.ENABLE_COMMENTS="enable_comments",Nt.SHOW_RESOLVED_COMMENTS="show_resolved_comments",Nt.HIDE_RESOLVED_COMMENTS="hide_resolved_comments",Nt.SORT_COMMENTS="sort_comments",Nt.ENABLE_CONTINUOUS_ANNOTATIONS="enable_continuous_annotations",Nt.DISABLE_CONTINUOUS_ANNOTATIONS="disable_continuous_annotations",Nt.ENABLE_CONTINUOUS_COMMENTING="enable_continuous_commenting",Nt.DISABLE_CONTINUOUS_COMMENTING="disable_continuous_commenting",Nt.ADD_COMMENT_START="add_comment_start",Nt.ADD_COMMENT_CANCEL="add_comment_cancel",Nt.REPLY_COMMENT_START="reply_comment_start",Nt.REPLY_COMMENT_CANCEL="reply_comment_cancel",Nt.MARK_THREAD_READ="mark_thread_read",Nt.MARK_THREAD_UNREAD="mark_thread_unread",Nt.COMMENT_ON_A_SECTION="comment_on_a_section",Nt.START_ANNOTATION_TIMESTAMP="start_annotation_timestamp",Nt.START_ANNOTATION_HIGHLIGHT="start_annotation_highlight",Nt.STICKER_START="sticker_start",Nt.ADD_EMOJI="add_emoji",Nt.STICKER_SUCCESS="sticker_success",Nt.STICKER_CANCELED="sticker_canceled",Nt.TAG_SOMEONE="tag_someone",Nt.MENTION_START="mention_start",Nt.MENTION_SUCCESS="mention_success",Nt.MENTION_CANCELED="mention_canceled",Nt.SAVE_EDIT_COMMENT="save_edit_comment",Nt.CANCEL_COMMENT="cancel_comment",Nt.VIEW_COMMENTS="view_comments",Nt.ADD_COMMENT_REACTION_START="add_comment_reaction_start",Nt.ADD_COMMENT_REACTION="add_comment_reaction",Nt.ADD_COMMENT_REACTION_SUCCESS="add_comment_reaction_success",Nt.REMOVE_COMMENT_REACTION="remove_comment_reaction",Nt.REMOVE_COMMENT_REACTION_SUCCESS="remove_comment_reaction_success",Nt.SELECT_COMMENT_MARK="select_comment_mark",Nt.ADD_NAME_START="add_name_start",Nt.ADD_NAME_CANCEL="add_name_cancel",Nt.ADD_NAME="add_name",Nt.SELECT_REPLY_COMMENTS="select_reply_comments",Nt.SELECT_ADD_COMMENTS="select_add_comments";const Rt="preview",Dt="file";const Lt="dbid:guest_id",Ot={id:Lt,name:{display:"?",initials:"?",public:"?"}},Ft=n.createContext(null),Pt=()=>G.default.useContext(Ft);a.injectInternalStyle("/static/js/comments2/plugin/annotations/layer.module.out-vfl_8EO3b.css",(e=>"._layer_34m26_1{bottom:0;left:0;pointer-events:none;position:absolute;right:0;top:0}._layer_34m26_1._interactable_34m26_10{pointer-events:auto}._comment-conductor_34m26_14._show_comment_cursor_34m26_14,._comment-conductor_34m26_14._show_comment_cursor_34m26_14:hover{cursor:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='20' height='20' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='20' height='20' rx='10' fill='%230061FE'/%3E%3Cpath fill='%230061FE' d='M0 10h10v10H0z'/%3E%3C/svg%3E\") 0 20,auto}"));const Ut="_layer_34m26_1";var Bt;function Vt(e){return{type:Bt.ActivateThread,payload:e}}function zt(e){return{type:Bt.DeactivateAllThreads,payload:e}}function qt(e,t){return{type:Bt.ConfirmDraftAnnotation,payload:{fileViewerId:e,annotationType:t}}}function Ht(e){return{type:Bt.CancelAnnotating,payload:{fileViewerId:e}}}function Wt(e){return{type:Bt.ResolveNavigationToActiveThreadAnnotation,payload:{fileViewerId:e}}}!function(e){e.ActivateThread="@@comments/activateThread",e.DeactivateAllThreads="@@comments/deactivateThread",e.BoltSubscribe="@@comments/bolt/subscribe",e.BoltUnsubscribe="@@comments/bolt/unsubscribe",e.UpdateDraftAnnotation="@@comments/updateDraftAnnotation",e.ClearDraftAnnotation="@@comments/clearDraftAnnotation",e.FocusEditor="@@comments/focusEditor",e.EditorDidFocus="@@comments/editorDidFocus",e.ResolveNavigationToActiveThreadAnnotation="@@comments/resolveNavigationToActiveThreadAnnotation",e.UpdateAnnotationMode="@@comments/UpdateCurrentAnnotationMode",e.StartAnnotating="@@comments/startAnnotating",e.ConfirmDraftAnnotation="@@comments/confirmDraftAnnotation",e.CancelAnnotating="@@comments/cancelAnnotating",e.LoggedInListCommentsResultIntoRedux="@@comments/loggedInListCommentsResultIntoRedux",e.LoggedOutListCommentsResultIntoRedux="@@comments/loggedOutListCommentsResultIntoRedux"}(Bt||(Bt={}));const Kt=E.defineMessage({id:"tgNuiG",defaultMessage:"Currently selecting {timestamp}"}),jt=G.memo((e=>{var t;const{children:n,file:i,navigationCallbacks:o}=e,r=E.useIntl(),{commentsBladeId:s}=Pt(),l=null!==(t=ge(i))&&void 0!==t?t:10,c=a.useSelector((e=>e.annotationSettings.state)),d=a.useDispatch(),u=null==o?void 0:o.seekRelative,m=_.useAudioVideoCurrentTimestamp(),f=a.useStabilizedCallback((e=>{"annotating-ax"===c&&("ArrowLeft"===e.key&&(e.stopImmediatePropagation(),e.preventDefault(),null!=l&&e.shiftKey?null==u||u(-1/l):null==u||u(-1)),"ArrowRight"===e.key&&(e.stopImmediatePropagation(),e.preventDefault(),null!=l&&e.shiftKey?null==u||u(1/l):null==u||u(1)),"Enter"===e.key&&d(qt(s))," "===e.key&&(e.stopImmediatePropagation(),e.preventDefault()))})),p=G.useRef(),g=G.useCallback((e=>{null==e||e.addEventListener("keydown",f),p.current=e||void 0}),[f]),v=G.useRef();G.useEffect((()=>{"annotating-ax"===c&&"annotating-ax"!==v.current&&p.current&&p.current.focus(),v.current=c}),[c]);const h=(e=>{const t=Math.round(e),n=String(Math.round(t%60)).padStart(2,"0"),a=String(Math.floor(t/60)%60).padStart(2,"0"),i=Math.floor(t/3600);return i>0?`${i}:${a}:${n}`:`${a}:${n}`})(m),y="annotating-ax"===c?r.formatMessage(Kt,{timestamp:h}):"";return G.createElement("div",{className:Ut,ref:g,"aria-label":y,tabIndex:-1},n)}));function Gt(e,t){let n=!0,a=null;function i(){n=!0,null!==a&&(e(...a),a=null)}return function(...o){n?(n=!1,e(...o),setTimeout(i,t)):a=o}}jt.displayName="AudioVideoAnnotationLayer",jt.displayName="AudioVideoAnnotationLayer";a.injectInternalStyle("/static/js/comments2/plugin/annotations/conductor_layer/conductor_layer.module.out-vfllqwPFm.css",(e=>"._sc-annotation-conductor-layer_vvpsd_1{bottom:0;cursor:auto;left:0;position:absolute;right:0;top:0}._sc-annotation-conductor-layer_vvpsd_1._sc-annotation-conductor-layer__can-create_vvpsd_10{cursor:crosshair;pointer-events:all}._sc-annotation-conductor-layer__can-create_vvpsd_10 img,._sc-annotation-conductor-layer__is-creating-rnd_vvpsd_21{-webkit-user-select:none;-ms-user-select:none;user-select:none}._accessibilityWarning_vvpsd_25{clip:rect(0,0,0,0)!important;border:0!important;display:none!important;height:1px!important;margin:-1px!important;overflow:hidden!important;padding:0!important;position:absolute!important;width:1px!important}"));const Qt="_sc-annotation-conductor-layer_vvpsd_1";var Zt;!function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Link=2]="Link",e[e.Creation=3]="Creation"}(Zt||(Zt={}));const $t=8;function Yt(e,t,n){const a=n?function(e,t){const n=e.x+e.width-t.width,a=e.y+e.height-t.height;return{x:Math.min(n,t.x),y:Math.min(a,t.y),width:t.width,height:t.height}}(t,e):function(e,t){const n=e.x+e.width,a=e.y+e.height,i=e.x,o=e.y,r={x:V.normalizeValue(t.x,i,n),y:V.normalizeValue(t.y,o,a)},s=V.normalizeValue(t.x+t.width,i,n),l=V.normalizeValue(t.y+t.height,o,a);return{x:r.x,y:r.y,width:s-r.x,height:l-r.y}}(t,e);return function(e,t){let{x:n,y:a,width:i,height:o}=e;const r=n+i,s=a+o,l=t.x+t.width,c=t.y+t.height;return i<=$t&&r+$t>l&&(n=r-$t,i=$t),o<=$t&&s+$t>c&&(a=s-$t,o=$t),{x:n,y:a,width:i,height:o}}(a,t)}const Xt=(e,t)=>{const n=V.createNormalizedRegion({left:e.x,top:e.y,width:0,height:0},{left:t.x,top:t.y,width:t.width,height:t.height});return{x:n.x,y:n.y,width:0,height:0}};a.injectInternalStyle("/static/js/comments2/plugin/annotations/creation_layer/creation_layer.module.out-vflYx1oHS.css",(e=>"._highlight-creation-layer_1tszl_1{bottom:0;left:0;position:absolute;right:0;top:0}._highlight-creation-layer_1tszl_1 a::selection,._highlight-creation-layer_1tszl_1 p::selection{background:var(--dig-color__highlight__yellow)}._add-annotation-highlight-button_1tszl_14{background-color:var(--color__inverse__elevated__background);box-sizing:border-box;color:var(--color__inverse__standard__text);margin-left:-4px;opacity:0;padding:4px;position:absolute;transition:opacity .1s ease-in-out,margin 0ms ease-in-out .4s;z-index:1000}._add-annotation-highlight-button__visible_1tszl_28{margin-left:0;opacity:1;pointer-events:all;transition:opacity .15s ease-in-out,margin .15s ease-in-out}._annotation-rectangle-creation-layer_1tszl_37{bottom:0;left:0;position:absolute;right:0;top:0}._annotation-rectangle-creation-draft_1tszl_45{border:2px solid var(--dig-color__utility__focus-ring);box-sizing:border-box;cursor:all-scroll;height:100px;left:0;pointer-events:all;position:absolute;top:0;width:100px}._annotation-creation-draft_1tszl_57{cursor:all-scroll;pointer-events:all}._annotation-handle_1tszl_62{background:var(--dig-color__utility__focus-ring);border-radius:50%}._annotation-edge_1tszl_69,._annotation-handle_1tszl_62{background-clip:padding-box;position:absolute}._highlight-segment-draft_1tszl_74{background:var(--dig-color__highlight__yellow);box-sizing:border-box;opacity:.5;pointer-events:none;position:absolute}"));function Jt(e){return e+1}const en=.02;function tn(e){return 100*e+"%"}function nn({x:e,y:t,width:n,height:a}){return{top:tn(t),left:tn(e),width:tn(n),height:tn(a)}}const an=e=>"image"===e.type?{type:e.regionType,regions:[e.region]}:{type:e.regionType,regions:e.regions};const on=({highlight:e,children:t})=>G.createElement("div",{className:"_highlight-creation-layer_1tszl_1"},t,e&&{highlight:e}.highlight.map(((e,t)=>G.createElement("div",{key:`sc-annotation-highlight-draft-${t}`,style:nn(e),className:"_highlight-segment-draft_1tszl_74"}))));on.displayName="AnnotationHighlightCreationLayer";class rn extends G.PureComponent{constructor(e){super(e),this.requestId=null,this.updateStyles=()=>{this.setState(((e,t)=>(this.requestId=null,{style:t.style})))},this.state={style:e.style}}componentWillUnmount(){this.requestId&&cancelAnimationFrame(this.requestId)}componentDidUpdate(){this.requestId||(this.requestId=requestAnimationFrame(this.updateStyles))}render(){return G.Children.only(this.props.children(this.state.style))}}var sn,ln;rn.displayName="RafStyle",function(e){e.TopLeft="topLeft",e.TopRight="topRight",e.BottomLeft="bottomLeft",e.BottomRight="bottomRight"}(sn||(sn={})),function(e){e.Top="top",e.Bottom="bottom",e.Left="left",e.Right="right"}(ln||(ln={}));const cn="drag";function dn(e){return 0===e.button}function un({x:e,y:t,width:n,height:a},{deltaX:i,deltaY:o},r){switch(r){case cn:return{x:e+i,y:t+o,width:n,height:a};case sn.BottomRight:return{x:i<-n?e+(n+i):e,y:o<-a?t+(a+o):t,width:Math.abs(n+i),height:Math.abs(a+o)};case sn.BottomLeft:return{x:i>n?e+n:e+i,y:o<-a?t+(a+o):t,width:Math.abs(n-i),height:Math.abs(a+o)};case sn.TopRight:return{x:i<-n?e+(n+i):e,y:o>a?t+a:t+o,width:Math.abs(n+i),height:Math.abs(a-o)};case sn.TopLeft:return{x:i>n?e+n:e+i,y:o>a?t+a:t+o,width:Math.abs(n-i),height:Math.abs(a-o)};case ln.Left:return{x:i>n?e+n:e+i,y:t,width:Math.abs(n-i),height:a};case ln.Right:return{x:i<-n?e+(n+i):e,y:t,width:Math.abs(n+i),height:a};case ln.Top:return{x:e,y:o>a?t+a:t+o,width:n,height:Math.abs(a-o)};case ln.Bottom:return{x:e,y:o<-a?t+(a+o):t,width:n,height:Math.abs(a+o)}}}function _n(e,{x:t,y:n}){return{deltaX:t-e.x,deltaY:n-e.y}}const mn=e=>e===sn.TopLeft||e===sn.TopRight||e===sn.BottomLeft||e===sn.BottomRight?"_annotation-handle_1tszl_62":e===ln.Bottom||e===ln.Top||e===ln.Left||e===ln.Right?"_annotation-edge_1tszl_69":void 0,fn=(e,t)=>e===sn.TopLeft||e===sn.TopRight||e===sn.BottomLeft||e===sn.BottomRight?function(e,t){const n=t?{width:"14px",height:"14px"}:{width:"2px",height:"2px"},a=t?"-8px":"-2px";switch(e){case sn.TopLeft:return{...n,top:a,left:a,cursor:"nw-resize"};case sn.TopRight:return{...n,top:a,right:a,cursor:"ne-resize"};case sn.BottomLeft:return{...n,bottom:a,left:a,cursor:"sw-resize"};case sn.BottomRight:return{...n,bottom:a,right:a,cursor:"se-resize"}}}(e,e===t):e===ln.Bottom||e===ln.Top||e===ln.Left||e===ln.Right?function(e){const t="-5px",n="6px",a="0",i={bottom:a,top:a,left:a,right:a};switch(e){case ln.Top:return{...i,top:t,height:n,bottom:void 0,cursor:"n-resize"};case ln.Left:return{...i,left:t,width:n,right:void 0,cursor:"w-resize"};case ln.Bottom:return{...i,bottom:t,height:n,top:void 0,cursor:"s-resize"};case ln.Right:return{...i,right:t,width:n,left:void 0,cursor:"e-resize"}}}(e):void 0;a.injectInternalStyle("/static/js/comments2/plugin/annotations/cursor/cursor.module.out-vflfD-Ncl.css",(e=>"._comment-cursor_19p38_1{background-color:var(--dig-color__primary__base);border-radius:50% 50% 50% 0}._comment-cursor__active_19p38_6{border:2px solid var(--dig-color__background__base)}"));const pn=({placement:e,isActive:t,onMouseDown:n})=>{const i=t?28:20,o=a.cx("_comment-cursor_19p38_1",{"_comment-cursor__active_19p38_6":t});return G.createElement("div",{style:{width:i,height:i,position:"absolute",left:e.x,top:e.y-i},className:o,onMouseDown:n})};pn.displayName="CommentCursor";a.injectInternalStyle("/static/js/comments2/plugin/annotations/view_layer/view_layer.module.out-vflXkPDWL.css",(e=>'._view-layer_1craq_1{bottom:0;left:0;pointer-events:none;position:absolute;right:0;top:0}._regular-rectangle-sublayer_1craq_11{opacity:.3;transition:opacity .3s ease-in-out,background-color .3s ease-in-out}._regular-highlight-sublayer_1craq_18,._regular-point-sublayer_1craq_25{opacity:1;transition:opacity .3s ease-in-out,background-color .3s ease-in-out}._hide-regular-sublayer_1craq_32 ._regular-highlight-sublayer_1craq_18,._hide-regular-sublayer_1craq_32 ._regular-point-sublayer_1craq_25,._hide-regular-sublayer_1craq_32 ._regular-rectangle-sublayer_1craq_11{opacity:0}._annotation-rectangle_1craq_44{border:2px solid var(--color__inverse__attention__border);box-sizing:border-box;position:absolute}._annotation-rectangle_1craq_44._emphasized_1craq_50{border:2px solid var(--dig-color__utility__focus-ring)}._annotation-rectangle-frame-segment_1craq_54{cursor:pointer;pointer-events:auto;position:absolute}._emphasis-sublayer_1craq_61 ._annotation-rectangle_1craq_44{opacity:0;transition:opacity .3s ease-in-out}._emphasis-sublayer_1craq_61 ._emphasized_1craq_50{opacity:1}._highlight-segment_1craq_71{box-sizing:border-box;cursor:pointer;pointer-events:auto;position:absolute}._highlight-segment_1craq_71:after{background:var(--dig-color__highlight__yellow);bottom:0;box-sizing:border-box;content:"";height:2px;left:0;opacity:1;position:absolute;right:0}._emphasis-sublayer_1craq_61 ._highlight-segment_1craq_71:after{opacity:0}._emphasis-sublayer_1craq_61 ._highlight-segment_1craq_71:before{background-color:var(--dig-color__highlight__yellow);bottom:2px;content:"";left:0;opacity:0;position:absolute;right:0;top:0;transition:opacity .3s ease-in-out}._emphasis-sublayer_1craq_61 ._emphasized_1craq_50:before{opacity:.5}._comment-mark_1craq_112{background:var(--dig-color__secondary__base);border-radius:var(--dig-spacing__micro__medium) var(--dig-spacing__micro__medium) var(--dig-spacing__micro__medium) 0;box-shadow:0 4px 12px 0 #0000001a;gap:var(--dig-spacing__dimension__8);padding:var(--dig-spacing__dimension__4);pointer-events:auto;position:absolute}._comment-mark_1craq_112,._comment-mark_1craq_112 button{cursor:pointer}._comment-mark-facepile-transparent_1craq_128{opacity:.5}._comment-mark_1craq_112._comment-mark__hovered_1craq_132{background:var(--dig-color__secondary__on-surface)}._comment-mark_1craq_112._comment-mark__facepile_1craq_136{padding-left:calc(var(--dig-spacing__dimension__8) + var(--dig-spacing__dimension__4))}._comment-mark_1craq_112._comment-mark__loading_1craq_142{padding:var(--dig-spacing__dimension__8)}._comment-mark_1craq_112._emphasized_1craq_50{border:2px solid var(--color__standard__background);border-radius:var(--dig-spacing__micro__large) var(--dig-spacing__micro__large) var(--dig-spacing__micro__large) 0;z-index:1}._comment-mark_1craq_112._emphasized_1craq_50._comment-mark__facepile_1craq_136{padding-left:calc(var(--dig-spacing__dimension__4) + var(--dig-spacing__dimension__4))}'));const gn="_emphasized_1craq_50",vn="_highlight-segment_1craq_71",hn=({rectangle:e,isEmphasized:t})=>G.createElement("div",{style:nn(e),className:a.cx("_annotation-rectangle_1craq_44",{[gn]:t}),"data-testid":"annotation-rectangle"});hn.displayName="AnnotationRectangle";const yn=({x:e,y:t,width:n,height:i,onMouseEnter:o,onMouseLeave:r})=>G.createElement("div",{style:nn({x:e,y:t,width:n,height:i}),className:a.cx("_annotation-rectangle-frame-segment_1craq_54"),onMouseEnter:o,onMouseLeave:r});yn.displayName="FrameSegment";const bn=e=>{const{rectangle:{x:t,y:n,width:a,height:i},onMouseEnter:o,onMouseLeave:r}=e;return G.createElement(G.Fragment,null,G.createElement(yn,{x:t-en,y:n-en,width:a+.04,height:.04,onMouseEnter:o,onMouseLeave:r}),G.createElement(yn,{x:t-en,y:n+i-en,width:a+.04,height:.04,onMouseEnter:o,onMouseLeave:r}),G.createElement(yn,{x:t-en,y:n+en,width:.04,height:i-.04,onMouseEnter:o,onMouseLeave:r}),G.createElement(yn,{x:t+a-en,y:n+en,width:.04,height:i-.04,onMouseEnter:o,onMouseLeave:r}))};bn.displayName="AnnotationRectangleFrame";const En=({placement:{x:e,y:t,width:n,height:a}})=>G.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},G.createElement("mask",{id:"annotation-cutout"},G.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"white"}),G.createElement("rect",{x:e+1,y:t+1,width:n-2,height:a-2,fill:"black"})),G.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"black",opacity:"0.4",mask:"url(#annotation-cutout)"}));function wn(e){const{x:t,y:n,width:a,height:i}=e;return{transform:`translate(${t}px, ${n}px)`,width:a,height:i}}En.displayName="AnnotationCutoutOverlay",En.displayName="AnnotationCutoutOverlay";const Sn=e=>e.preventDefault(),Cn=({onChangeStart:e,onRectChange:t,onChangeEnd:i,rectanglePlacement:o,pointPlacement:r,children:s,onPointChange:l,onMouseEnterDraft:c,onMouseLeaveDraft:d})=>{const[u,_]=n.useState(void 0),[m,f]=n.useState(void 0),[p,g]=n.useState(!0),v=n.useRef(null),h=n.useRef(null),y=n.useCallback((e=>p||u&&function({x:e,y:t},{clientX:n,clientY:a}){return Math.max(Math.abs(e-n),Math.abs(t-a))>5}(u.originPoint,e)),[p,u]),b=a.useStabilizedCallback((e=>{if(!u||!y(e))return;g(!0);const{clientX:n,clientY:a}=e,{originPoint:i,deltaMovement:o,originDraft:s}=u,c=_n(i,{x:n,y:a}),d=!p;if((o===sn.BottomLeft||o===sn.BottomRight||o===sn.TopLeft||o===sn.TopRight)&&s){const e=((e,t,n)=>{let a;switch(n){case sn.BottomRight:a={x:e.x,y:e.y};break;case sn.BottomLeft:a={x:e.x+e.width,y:e.y};break;case sn.TopLeft:a={x:e.x+e.width,y:e.y+e.height};break;case sn.TopRight:a={x:e.x,y:e.y+e.height}}const i=_n(a,{x:t.x,y:t.y}),{deltaX:o,deltaY:r}=i;return o>0&&r>0?sn.BottomRight:o>0&&r<0?sn.TopRight:o<0&&r>0?sn.BottomLeft:sn.TopLeft})(s,{x:n,y:a},o);f(e)}o===cn&&r?s&&(null==l||l(un(s,c,o))):s&&t(un(s,c,o),o===cn,d)})),E=a.useStabilizedCallback((()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",E),document.removeEventListener("selectstart",Sn),_(void 0),i(null==u?void 0:u.originPoint,p)})),w=n.useCallback((()=>{document.addEventListener("mousemove",b,!0),document.addEventListener("mouseup",E)}),[b,E]),S=n.useCallback((()=>{document.addEventListener("selectstart",Sn)}),[]),C=n.useCallback(((t,n,a=!1)=>{if(dn(t)){S();const{clientX:i,clientY:o}=t,r=h.current,s={x:i,y:o},l=a?{...s,width:0,height:0}:r&&function({top:e,left:t,width:n,height:a}){return{x:t,y:e,width:n,height:a}}(r.getBoundingClientRect());w(),e(),_({originPoint:s,deltaMovement:n,originDraft:l})}}),[w,S,e]),M=n.useCallback((e=>{e.currentTarget===e.target&&(C(e,cn),g(!0))}),[C]),x=n.useCallback((e=>{var t;const n=e.target,a=function(e){const t=e.target.tagName.toUpperCase();return"P"===t||"TEXT"===t}(e)||function(e){return"A"===e.target.tagName}(e),i=null===(t=h.current)||void 0===t?void 0:t.contains(n);a||i||(g(!1),C(e,sn.BottomRight,!0))}),[C]),A=n.useCallback((()=>{if(!o&&!r)return null;const e=G.default.createElement(pn,{placement:{x:0,y:o?2:0},isActive:!0,onMouseDown:M}),t=(e=>{if(e)switch(e){case sn.BottomRight:return sn.TopLeft;case sn.BottomLeft:return sn.TopRight;case sn.TopLeft:return sn.BottomRight;case sn.TopRight:return sn.BottomLeft}})(m),n=[ln.Top,ln.Left,ln.Right,ln.Bottom,sn.TopLeft,sn.TopRight,sn.BottomLeft,sn.BottomRight].map((n=>G.default.createElement("div",{style:fn(n,t),key:n,className:mn(n),onMouseDown:e=>C(e,n)},n===m&&e))),i=a.cx("_annotation-creation-draft_1tszl_57",{"_annotation-rectangle-creation-draft_1tszl_45":!!o});return G.default.createElement(rn,{style:o||r},(t=>t?G.default.createElement(G.default.Fragment,null,G.default.createElement("div",{ref:h,style:wn(t),className:i,onMouseDown:M,onMouseEnter:c,onMouseLeave:d},o&&n,r&&e),G.default.createElement(En,{placement:t})):null))}),[m,C,M,c,d,r,o]);return G.default.createElement("div",{ref:v,className:"_annotation-rectangle-creation-layer_1tszl_37",onMouseDown:x},s,A())};function Mn(e){const{top:t,left:n,width:a,height:i}=e.currentTarget.getBoundingClientRect(),{clientX:o,clientY:r}=e,[s,l]=[o-n,r-t];return{x:s/a,y:l/i}}function xn(e,t,n,a){const{x:i,y:o,width:r,height:s}=e;return{x:i*t+((null==a?void 0:a.x)||0),y:o*n+((null==a?void 0:a.y)||0),width:r*t,height:s*n}}Cn.displayName="AnnotationRectangleCreationLayer";const An="@@apiv2_redux/comments2/add_comment",In="@@apiv2_redux/comments2/add_comment_result",Tn="@@apiv2_redux/comments2/check_onboarding_status",kn="@@apiv2_redux/comments2/check_onboarding_status_result",Nn="@@apiv2_redux/comments2/delete_comment",Rn="@@apiv2_redux/comments2/delete_comment_result",Dn="@@apiv2_redux/comments2/disable_commenting",Ln="@@apiv2_redux/comments2/disable_commenting_result",On="@@apiv2_redux/comments2/edit_comment",Fn="@@apiv2_redux/comments2/edit_comment_result",Pn="@@apiv2_redux/comments2/enable_commenting",Un="@@apiv2_redux/comments2/enable_commenting_result",Bn="@@apiv2_redux/comments2/list_comments",Vn="@@apiv2_redux/comments2/list_comments_result",zn="@@apiv2_redux/comments2/list_comments_batch",qn="@@apiv2_redux/comments2/list_comments_batch_result",Hn="@@apiv2_redux/comments2/log_event",Wn="@@apiv2_redux/comments2/log_event_result",Kn="@@apiv2_redux/comments2/log_perf_event",jn="@@apiv2_redux/comments2/log_perf_event_result",Gn="@@apiv2_redux/comments2/logged_out/list_comments",Qn="@@apiv2_redux/comments2/logged_out/list_comments_result",Zn="@@apiv2_redux/comments2/logged_out/list_comments_batch",$n="@@apiv2_redux/comments2/logged_out/list_comments_batch_result",Yn="@@apiv2_redux/comments2/mark_thread_read",Xn="@@apiv2_redux/comments2/mark_thread_read_result",Jn="@@apiv2_redux/comments2/mark_thread_unread",ea="@@apiv2_redux/comments2/mark_thread_unread_result",ta="@@apiv2_redux/comments2/resolve_thread",na="@@apiv2_redux/comments2/resolve_thread_result",aa="@@apiv2_redux/comments2/subscribe",ia="@@apiv2_redux/comments2/subscribe_result",oa="@@apiv2_redux/comments2/unresolve_thread",ra="@@apiv2_redux/comments2/unresolve_thread_result",sa="@@apiv2_redux/comments2/unsubscribe",la="@@apiv2_redux/comments2/unsubscribe_result",ca=D._createAction(An),da=D._createAction(In),ua=D._createAction(kn),_a=D._createAction(Nn),ma=D._createAction(Rn),fa=D._createAction(Dn),pa=D._createAction(Ln),ga=D._createAction(On),va=D._createAction(Fn),ha=D._createAction(Pn),ya=D._createAction(Un),ba=D._createAction(Bn),Ea=D._createAction(Vn),wa=D._createAction(qn),Sa=D._createAction(Hn),Ca=D._createAction(Wn),Ma=D._createAction(jn),xa=D._createAction(Qn),Aa=D._createAction($n),Ia=D._createAction(Yn),Ta=D._createAction(Xn),ka=D._createAction(Jn),Na=D._createAction(ea),Ra=D._createAction(ta),Da=D._createAction(na),La=D._createAction(aa),Oa=D._createAction(ia),Fa=D._createAction(oa),Pa=D._createAction(ra),Ua=D._createAction(sa),Ba=D._createAction(la),Va={[An]:{endpoint:"add_comment",action:da},[Tn]:{endpoint:"check_onboarding_status",action:ua},[Nn]:{endpoint:"delete_comment",action:ma},[Dn]:{endpoint:"disable_commenting",action:pa},[On]:{endpoint:"edit_comment",action:va},[Pn]:{endpoint:"enable_commenting",action:ya},[Bn]:{endpoint:"list_comments",action:Ea},[zn]:{endpoint:"list_comments_batch",action:wa},[Hn]:{endpoint:"log_event",action:Ca},[Kn]:{endpoint:"log_perf_event",action:Ma},[Gn]:{endpoint:"logged_out/list_comments",action:xa},[Zn]:{endpoint:"logged_out/list_comments_batch",action:Aa},[Yn]:{endpoint:"mark_thread_read",action:Ta},[Jn]:{endpoint:"mark_thread_unread",action:Na},[ta]:{endpoint:"resolve_thread",action:Da},[aa]:{endpoint:"subscribe",action:Oa},[oa]:{endpoint:"unresolve_thread",action:Pa},[sa]:{endpoint:"unsubscribe",action:Ba}},za=D._createMiddleware(Va);var qa;function Ha(e){return({dispatch:t})=>n=>a=>{const i=n(a);return a.type===qa.SearchContacts?e().then((e=>{e.search(a.payload,(e=>{var n;t((n={query:a.payload,result:e[a.payload]},{type:qa.SearchContactsResult,payload:n}))}))})).catch((()=>{})):a.type===qa.WarmContacts&&e(),i}}function Wa(e,t){return e[".tag"]===t}function Ka(e){var t;if(Wa(e,"video"))return{type:"video",time:e.time||0,timeSec:e.time_sec||0};if(Wa(e,"audio"))return{type:"audio",time:e.time};if(Wa(e,"document")){const t=e.region_type[".tag"];if("highlight"!==t&&"rectangle"!==t&&"point"!==t)return;return{type:"document",regionType:t,label:e.label,regions:e.regions}}if(Wa(e,"image")){const n=null===(t=e.region_type)||void 0===t?void 0:t[".tag"];if(void 0===n)return{type:"image",region:e.region,label:e.label,regionType:"rectangle"};if("rectangle"!==n&&"point"!==n)return;return{type:"image",region:e.region,label:e.label,regionType:n}}throw new Error("Attempted to convert an annotation type that does not yet exist.")}function ja(e){return"video"===e.type?{".tag":"video",time:e.time,time_sec:e.timeSec}:"audio"===e.type?{".tag":"audio",time:e.time}:"document"===e.type?{".tag":"document",regions:e.regions,region_type:{".tag":e.regionType}}:{".tag":"image",region:{...e.region,page:1},region_type:{".tag":e.regionType}}}function Ga(e){return"image"===e.type?{type:e.regionType,regions:[e.region]}:{type:e.regionType,regions:e.regions}}function Qa(e,t){return e.type===t}function Za(e){return Qa(e,"mention")}function $a(e){return Qa(e,"style")}function Ya(e){return Qa(e,"sticker")}function Xa(e){return Qa(e,"guest")}function Ja(e){return Qa(e,"reel")}function ei(e){return Qa(e,"hyperlink")}function ti(e){const t=e.format[".tag"];if("other"===t)throw new Error('"other" is not a valid format block');return{location:e.location,style:t,type:"style"}}function ni(e){const t=e.user.type[".tag"];if("other"===t)throw new Error('"other" is not a valid user type');const n={identifier:e.user.identifier,type:t};return{location:e.location,type:"mention",user:n}}function ai(e){if(e.url&&e.location)return{location:e.location,type:"hyperlink",url:e.url}}function ii(e){const t=[...e.formatting.map(ti),...e.mentions.map(ni)];if(e.sticker){const n=function(e){if(e.url&&e.name&&e.description)return{type:"sticker",id:e.id,url:e.url,name:e.name,description:e.description}}(e.sticker);n&&t.push(n)}if(e.guest){const n=function(e){if(e.first_name||e.last_name)return{type:"guest",first_name:e.first_name,last_name:e.last_name}}(e.guest);n&&t.push(n)}if(e.reel){const n=function(e){if(e.annotation_data)return{type:"reel",annotation_data:e.annotation_data}}(e.reel);n&&t.push(n)}if(e.hyperlinks){const n=e.hyperlinks.map(ai);for(const e of n)e&&ei(e)&&t.push(e)}return t}function oi(e){const t=e.filter($a).map((e=>({format:{".tag":e.style},location:e.location}))),n=e.filter(Za).map((e=>({user:{type:{".tag":e.user.type},identifier:e.user.identifier},location:e.location}))),a=e.find(Ya),i=a?{id:a.id}:void 0,o=e.find(Xa),r=o?{first_name:o.first_name,last_name:o.last_name}:void 0,s=e.find(Ja);return{formatting:t,mentions:n,sticker:i,guest:r,reel:s?{annotation_data:s.annotation_data}:void 0,hyperlinks:e.filter(ei).map((e=>({url:e.url,location:e.location})))}}function ri(e,t){const n=t.timestamp?new Date(t.timestamp):void 0;return{isCurrent:e.ns_id===t.ns_id&&e.sjid===t.sjid,revision:{nsId:t.ns_id,sjId:t.sjid},timestamp:n}}function si(e){return e&&"file"===e.type?{ns_id:e.ns_id,sjid:e.sjid}:void 0}function li({annotation:e,content:t,stream:n}){return{annotation_data:e?ja(e):void 0,content:t.text,metadata:oi(t.metadata),revision:si(n)}}function ci(e,t){if("resolved_no_details"===e[".tag"])return{type:"no_details"};if(function(e){return"resolved_with_details"===e[".tag"]}(e))return{type:"with_details",resolver:t[e.resolver_id],resolvedTimestamp:new Date(e.resolved_timestamp)};throw new Error("Not a valid type for ResolvedInfo.")}function di(e,t,n){const a=e.comments.map((a=>function(e,t,n,a){return{author:n[e.author_id],content:{metadata:ii(e.metadata),text:e.content},deleted:e.deleted,id:e.id,threadId:t,timestamp:new Date(e.timestamp),revisionInfo:a&&e.revision?ri(a,e.revision):{isCurrent:!0},userPermissions:{canDelete:e.permissions.can_delete,canEdit:e.permissions.can_edit}}}(a,e.id,t,n))),i=e.resolved_info?{resolved:!0,resolvedInfo:ci(e.resolved_info,t)}:{resolved:!1};return{annotation:e.annotation_data?Ka(e.annotation_data):void 0,comments:a,id:e.id,read:e.read,readonly:e.readonly,isThirdParty:e.is_third_party,...i,timestamp:a[0].timestamp}}function ui(e,t,n){const a=e.map((e=>di(e,t,n)));return z.lodashExports.keyBy(a,"id")}function _i(e){return{id:e.id,name:{display:e.display_name,initials:e.initials,public:e.public_name},photoUrl:e.photo_url,isCurrentUser:e.is_current_user}}function mi(e){const t=e.map(_i);return z.lodashExports.keyBy(t,"id")}!function(e){e.WarmContacts="@@contacts/warm",e.SearchContacts="@@contacts/search",e.SearchContactsResult="@@contacts/searchResult"}(qa||(qa={}));const fi=(()=>{let e,t;const n=[];for(e=0,t=e;e<=255;e++,t=e)n.push((t+256).toString(16).substr(1));return n})();function pi(e){return e.map((e=>fi[e])).join("")}function gi(){const e=function(){const e=new Uint8Array(16);return window.crypto&&window.crypto.getRandomValues(e),e}();e[6]=15&e[6]|64,e[8]=63&e[8]|128;const t=Array.prototype.slice.call(e);return[t.slice(0,4),t.slice(4,6),t.slice(6,8),t.slice(8,10),t.slice(10,16)].map(pi).join("-")}function vi({content:e,threadId:t,author:n,actionType:a}){const i=new Date;return{id:gi(),timestamp:i,threadId:t,author:n,content:e,userPermissions:{canDelete:!1,canEdit:!1},revisionInfo:{isCurrent:!0,timestamp:i},pending:{action:a,originalValue:void 0,pendingValue:e}}}function hi(e){return{type:{".tag":"file"},identifier:{".tag":"file_path_or_id",file_path_or_id:e}}}function yi(e,t){return t?function(e){return{type:{".tag":"file"},identifier:{".tag":"shared_link_details",url:e}}}(t):hi(e)}var bi;!function(e){e[e.Disabled=0]="Disabled",e[e.ReadOnly=1]="ReadOnly",e[e.FullyEnabled=2]="FullyEnabled"}(bi||(bi={}));const Ei={},wi={fileIdentifierToBoltMap:{},boltUniqueIdToStream:{}},Si={},Ci={currentQuery:"",result:[]},Mi={},xi={},Ai={},Ii={},Ti={},ki={},Ni={},Ri={},Di={state:"annotating"},Li=e=>{const{payload:{arg:{stream:t}}}=e;return Oi(t)};function Oi(e){return"file_path_or_id"===e.identifier[".tag"]?e.identifier.file_path_or_id:"shared_link_details"===e.identifier[".tag"]?e.identifier.url:void 0}function Fi(e){const{stream:t,id:n}=e.payload.arg;return"file_path_or_id"===t.identifier[".tag"]?{fileIdOrUrl:t.identifier.file_path_or_id,threadId:n}:"shared_link_details"===t.identifier[".tag"]?{fileIdOrUrl:t.identifier.url,threadId:n}:{}}function Pi(e){var t;const{payload:{arg:{id:n,stream:{identifier:a}}}}=e,i=null===(t=e.meta)||void 0===t?void 0:t.threadId;return"file_path_or_id"===a[".tag"]?{fileIdOrUrl:a.file_path_or_id,commentId:n,threadId:i}:"shared_link_details"===a[".tag"]?{fileIdOrUrl:a.url,commentId:n,threadId:i}:{}}function Ui(e,t,n,a){return{...e,[t]:n,pending:{action:a,originalValue:e[t],pendingValue:n}}}function Bi(e,t,n,a,i){const{comments:o}=e,r=o.findIndex((e=>e.id===t)),s=o[r];if(!s)return e;const l={...s,[n]:a},c=[...o];return c.splice(r,1,l),Ui(e,"comments",c,i)}function Vi(e,t,n){return{...e,[t]:n?e.pending.originalValue:e[t],pending:void 0}}const zi={boltInfo:(e=wi,t)=>{if(t.type===Vn||t.type===Bt.LoggedInListCommentsResultIntoRedux){const{payload:{arg:n,result:a}}=t,i=Oi(n.stream);if(i&&a)return{fileIdentifierToBoltMap:{...e.fileIdentifierToBoltMap,[i]:a.bolt_info},boltUniqueIdToStream:{...e.boltUniqueIdToStream,[a.bolt_info.unique_id]:n.stream}}}return e},threads:(e=Ei,t)=>{const n=!!t.error;switch(t.type){case An:return qi(e,t);case In:return Hi(e,t,n);case Yn:case Jn:return Wi(e,t);case Xn:case ea:return Ki(e,t,n);case ta:case oa:return ji(e,t);case na:case ra:return Gi(e,t,n);case On:return Qi(e,t);case Fn:return Zi(e,t,n);case Nn:return $i(e,t);case Rn:return Yi(e,t,n);case Vn:case Qn:case Bt.LoggedInListCommentsResultIntoRedux:case Bt.LoggedOutListCommentsResultIntoRedux:return Xi(e,t);default:return e}},supportedEnhancements:(e={},t)=>{var n;if(t.type===Vn||t.type===Bt.LoggedInListCommentsResultIntoRedux){const{payload:{arg:a,result:i}}=t,o=Oi(a.stream);if(null!=o&&null!=i)return{...e,[o]:null!==(n=i.supported_enhancements)&&void 0!==n?n:{}}}return e},activeThreadID:(e=Si,t)=>{switch(t.type){case Bt.ActivateThread:return{...e,[t.payload.fileViewerId]:t.payload.threadId};case Bt.DeactivateAllThreads:return{...e,[t.payload.fileViewerId]:""};case An:if(t.meta&&t.meta.tempThreadId)return{...e,[t.meta.fileViewerId]:t.meta.tempThreadId};break;case In:const{meta:n,payload:{result:a}}=t;if(a&&n&&n.tempThreadId===e[n.fileViewerId])return{...e,[n.fileViewerId]:a.id}}return e},mentionsSearchResult:(e=Ci,t)=>{switch(t.type){case qa.SearchContacts:return{...e,currentQuery:t.payload};case qa.SearchContactsResult:if(t.payload.query===e.currentQuery)return{...e,result:t.payload.result}}return e},permissions:(e=xi,t)=>{if(t.type!==Vn&&t.type!==Qn&&t.type!==Bt.LoggedInListCommentsResultIntoRedux&&t.type!==Bt.LoggedOutListCommentsResultIntoRedux)return e;const{payload:{arg:n,result:a}}=t,i=Oi(n.stream);if(!i||!a)return e;const o=a.permissions;return{...e,[i]:o}},draftAnnotation:(e=Mi,t)=>{switch(t.type){case Bt.UpdateDraftAnnotation:{const{fileViewerId:n,annotation:a}=t.payload;return a===e[n]?e:{...e,[n]:a}}case Bt.ActivateThread:case Bt.CancelAnnotating:case Bt.ClearDraftAnnotation:{const{fileViewerId:n}=t.payload;if(!(n in e))return e;const a={...e};return delete a[n],a}case An:if(null!=t.meta){const{fileViewerId:n}=t.meta;if(!(n in e))return e;const a={...e};return delete a[n],a}}return e},annotationSettings:(e=Di,t)=>{if(t.type!==Bt.CancelAnnotating&&t.type!==Ln&&t.type!==An&&t.type!==Bt.ActivateThread&&t.type!==Bt.DeactivateAllThreads&&t.type!==Bt.StartAnnotating&&t.type!==Bt.ConfirmDraftAnnotation)return e;switch(t.type){case Bt.CancelAnnotating:return{...e,state:"annotating"};case Ln:return{...e,state:null};case An:return{...e,state:"annotating"};case Bt.ActivateThread:return null===e.state?{...e,state:"viewing"}:"viewing"!==e.state?{...e,state:"annotating"}:e;case Bt.DeactivateAllThreads:return"viewing"===e.state?{...e,state:"annotating"}:e;case Bt.StartAnnotating:return t.payload.accessible?{...e,state:"annotating-ax"}:{...e,state:"annotating"};case Bt.ConfirmDraftAnnotation:return{...e,state:"commenting"}}},editorFocusRequest:(e=Ai,{type:t,payload:n})=>{if(t===Bt.ConfirmDraftAnnotation&&!e[n.fileViewerId])return{...e,[n.fileViewerId]:!0};if(t===Bt.FocusEditor&&!e[n.fileViewerId])return{...e,[n.fileViewerId]:!0};if(t===Bt.EditorDidFocus&&e[n.fileViewerId]){const t={...e};return delete t[n.fileViewerId],t}return e},pendingNavigationToActiveThreadAnnotation:(e=Ii,{type:t,payload:n})=>{if(t===Bt.ActivateThread)return{[n.fileViewerId]:!0,...e};if(t===Bt.ResolveNavigationToActiveThreadAnnotation){const t={...e};return delete t[n.fileViewerId],t}return e},status:(e=Ti,t)=>{if(t.type===Vn||t.type===Bt.LoggedInListCommentsResultIntoRedux){const{payload:{arg:n,result:a}}=t,i=Oi(n.stream);if(i&&a)switch(a.status[".tag"]){case"disabled":return{...e,[i]:bi.Disabled};case"enabled":return{...e,[i]:bi.FullyEnabled};case"readonly":return{...e,[i]:bi.ReadOnly}}}if(t.type===Qn||t.type===Bt.LoggedOutListCommentsResultIntoRedux){const{payload:{arg:n}}=t,a=Oi(n.stream);if(a)return{...e,[a]:bi.FullyEnabled}}return e},thirdPartySource:(e=ki,t)=>{if(t.type!==Vn&&t.type!==Bt.LoggedInListCommentsResultIntoRedux)return e;const{payload:{arg:n,result:a}}=t,i=Oi(n.stream);if(!i||!a)return e;const o=a.supported_enhancements&&a.supported_enhancements.third_party_source;return{...e,[i]:o?(r=o,r[".tag"]):void 0};var r},subscriptionStatus:(e=Ni,t)=>{if(t.type!==ia&&t.type!==la)return e;const n=Li(t);if(void 0===n)return e;switch(t.type){case ia:return{...e,[n]:{isSubscribed:!0,canSubscribe:!0}};case la:return{...e,[n]:{isSubscribed:!1,canSubscribe:!0}};default:return e}},enableCommentStatus:(e=Ri,t)=>{var n;if(t.type!==Un&&t.type!==Ln&&t.type!==Vn&&t.type!==Qn&&t.type!==Bt.LoggedInListCommentsResultIntoRedux&&t.type!==Bt.LoggedOutListCommentsResultIntoRedux)return e;const a=Li(t);if(void 0===a)return e;switch(t.type){case Un:return{...e,[a]:{commentsEnabled:!0,canEnableCommenting:!0}};case Ln:return{...e,[a]:{commentsEnabled:!1,canEnableCommenting:!0}};case Vn:case Qn:case Bt.LoggedInListCommentsResultIntoRedux:case Bt.LoggedOutListCommentsResultIntoRedux:const i=t.payload.result;return i?{...e,[a]:{commentsEnabled:!("disabled"===i.status[".tag"]),canEnableCommenting:!!(null===(n=i.permissions)||void 0===n?void 0:n.can_enable_commenting)}}:e;default:return e}}},qi=(e,t)=>{const{payload:{arg:{thread_id:n,stream:a}}}=t,i=Oi(a);if(!i||!t.meta)return e;const o=e[i],{content:r,author:s,annotation:l}=t.meta;if(n){const a=o[n],{comments:c}=a,d={...a,comments:[...c,vi({content:r,threadId:n,author:s,actionType:t.type})],annotation:l||a.annotation};return{...e,[i]:{...o,[n]:{...d,pending:{action:t.type,originalValue:a,newValue:d}}}}}const{tempThreadId:c}=t.meta;if(c){const n=vi({threadId:c,author:s,content:r,actionType:t.type}),a={id:c,timestamp:new Date,read:!0,readonly:!0,resolved:!1,comments:[n],annotation:l,isThirdParty:!1},d={...a,pending:{action:t.type,originalValue:void 0,pendingValue:a}};return{...e,[i]:{...o,[c]:d}}}return e},Hi=(e,t,n)=>{const{payload:{arg:{thread_id:a,stream:i}}}=t,o=Oi(i);if(!o||!t.meta)return e;const r=e[o];if(a){const t={...r[a]},{originalValue:i}=t.pending;return t.pending=void 0,{...e,[o]:{...r,[a]:n?i:t}}}const{tempThreadId:s}=t.meta;let l=r;if(!n&&s&&s in r&&t.payload.result){l={...r},delete l[s];const e=r[s],{id:n}=t.payload.result;e.readonly=!1,e.id=n,l[n]={...e,pending:void 0}}return{...e,[o]:l}},Wi=(e,t)=>{const{fileIdOrUrl:n,threadId:a}=Fi(t);if(!n||!a)return e;const i=e[n];return{...e,[n]:{...i,[a]:Ui(i[a],"read",t.type===Yn,t.type)}}},Ki=(e,t,n)=>{const{fileIdOrUrl:a,threadId:i}=Fi(t);if(!a||!i)return e;const o=e[a];return{...e,[a]:{...o,[i]:Vi(o[i],"read",n)}}},ji=(e,t)=>{const{fileIdOrUrl:n,threadId:a}=Fi(t);if(!n||!a)return e;const i=e[n];return{...e,[n]:{...i,[a]:Ui(i[a],"resolved",t.type===ta,t.type)}}},Gi=(e,t,n)=>{const{fileIdOrUrl:a,threadId:i}=Fi(t);if(!a||!i)return e;const o=e[a];return{...e,[a]:{...o,[i]:Vi(o[i],"resolved",n)}}},Qi=(e,t)=>{const{fileIdOrUrl:n,threadId:a,commentId:i}=Pi(t);if(!(n&&a&&i&&t.meta))return e;const o=e[n],{content:r}=t.meta;return{...e,[n]:{...o,[a]:Bi(o[a],i,"content",r,t.type)}}},Zi=(e,t,n)=>{const{fileIdOrUrl:a,threadId:i,commentId:o}=Pi(t);if(!a||!i||!o)return e;const r=e[a];return{...e,[a]:{...r,[i]:Vi(r[i],"comments",n)}}},$i=(e,t)=>{const{fileIdOrUrl:n,threadId:a,commentId:i}=Pi(t);if(!n||!a||!i)return e;const o=e[n];return{...e,[n]:{...o,[a]:Bi(o[a],i,"deleted",!0,t.type)}}},Yi=(e,t,n)=>{const{fileIdOrUrl:a,threadId:i,commentId:o}=Pi(t);if(!a||!i||!o)return e;const r=e[a];return{...e,[a]:{...r,[i]:Vi(r[i],"comments",n)}}},Xi=(e,t)=>{const{payload:{arg:n,result:a}}=t,i=Oi(n.stream);return i&&a?{...e,[i]:ui(a.threads,mi(a.users))}:e},Ji=a.combineReducers(zi);function eo(e,t){for(const n of e){const e=n.comments;for(const a of e)if(a.id===t)return{comment:a,thread:n}}return null}function to({dispatch:e,user:t,getFileId:n,getUrl:a,getCommentsBladeId:i,onEditorFocused:o,showAuthModal:r,onClickAnnotation:s,reportException:l,setFocusedThreadId:c}){return{onThreadCreated:async(o,s)=>{if(t)try{await e(ca({arg:{stream:yi(n(),a()),comment:li({content:o,annotation:s}),source:{".tag":"editor"}}},{tempThreadId:gi(),content:o,annotation:s,author:t,fileViewerId:i()}))}catch(e){e instanceof Error&&l(e)}else{if(!r)throw new Error("showAuthModal or stream is not defined");r()}},onThreadActivated(t){e(Vt({fileId:n(),sharedLinkURL:a(),fileViewerId:i(),threadId:t.id,isThirdParty:t.isThirdParty}))},onAllThreadsDeactivated(){e(zt({fileViewerId:i()})),c(void 0)},onThreadRepliedTo:async(o,s)=>{if(t)e(ca({arg:{stream:yi(n(),a()),thread_id:o,comment:li({content:s})}},{content:s,author:t,fileViewerId:i()}));else{if(!r)throw new Error("showAuthModal or stream is not defined");r()}},onThreadMarkedAsRead(i){if(t)e(Ia({arg:{id:i,stream:yi(n(),a())}}));else{if(!r)throw new Error("showAuthModal or stream is not defined");r()}},onThreadMarkedAsUnread(i){if(t)e(ka({arg:{id:i,stream:yi(n(),a())}}));else{if(!r)throw new Error("showAuthModal or stream is not defined");r()}},onThreadResolved(i){if(t)e(Ra({arg:{id:i,stream:yi(n(),a())}}));else{if(!r)throw new Error("showAuthModal or stream is not defined");r()}},onThreadUnresolved(i){if(t)e(Fa({arg:{id:i,stream:yi(n(),a())}}));else{if(!r)throw new Error("showAuthModal or stream is not defined");r()}},onCommentEdited(t,i,o){e(ga({arg:{id:t,stream:yi(n(),a()),comment:li({content:i})}},{threadId:o,content:i}))},onEnableComments(){e(ha({arg:{stream:yi(n(),a())}}))},onDisableComments(){e(fa({arg:{stream:yi(n(),a())}}))},onCommentDeleted(t,i){e(_a({arg:{id:t,stream:yi(n(),a())}},{threadId:i}))},onMentionsQueryUpdated(t){var n;e((n=t,{type:qa.SearchContacts,payload:n}))},onCommentDraftCancel(){e(Ht(i()))},onEditorFocused(){var t,n;e((t=i(),{type:Bt.EditorDidFocus,payload:{fileViewerId:t}})),e((n={},{type:qa.WarmContacts,payload:n})),null==o||o()},onClickAnnotation(e){null==s||s(e)},onSubscribe(){e(La({arg:{stream:yi(n(),a())}}))},onUnsubscribe(){e(Ua({arg:{stream:yi(n(),a())}}))},onEditorStateChange:z.lodashExports.noop,onCommentActivated(t,o){const r=eo(o,t);r&&e(Vt({fileId:n(),sharedLinkURL:a(),fileViewerId:i(),threadId:r.thread.id,isThirdParty:r.thread.isThirdParty}))}}}const no={canComment:!0,canModifyThreads:!0,canShowEditor:!0,canShowEditorMeatball:!1},ao={canComment:!1,canModifyThreads:!1,canShowEditor:!1,canShowEditorMeatball:!1},io=(e,t)=>e.activeThreadID[t],oo=(e,t)=>e.threads[t],ro=(e,t,n)=>t===so(e,n),so=(e,t)=>e.activeThreadID[t],lo=(e,t)=>e.draftAnnotation[t],co=e=>e.annotationSettings.state,uo=({canCreateRectangle:e,layerSize:t,handleClick:n,onAnnotationConfirm:i,onAnnotationChange:o,onHoverPointChange:r,isActive:s,children:l,annotation:c,setShowCommentCursor:d})=>{const u=E.useIntl(),{commentsBladeId:_}=Pt(),m=a.useSelector((e=>io(e,_))),f=a.useSelector(co),p=G.useRef(null),g=G.useRef(Zt.None),v=G.useRef(!1),[h,y]=G.useState(null),[b,w]=G.useState(null),[S,C]=G.useState(),[M,x]=G.useState(!1),A=G.useMemo((()=>{if(b&&"rectangle"===b.type){return xn(b.regions[0],t.width,t.height)}return null}),[b,t]),I=G.useMemo((()=>{if(b&&"point"===b.type){return xn(b.regions[0],t.width,t.height)}return null}),[b,t]);G.useEffect((()=>{w(c)}),[c]);const T="highlight"===(null==c?void 0:c.type)?c.regions:null,k=null!==c,N=G.useCallback(((e,t)=>{if("rectangle"!==e.type&&"point"!==e.type)return;const n=e.regions[0],a=t||"point"===e.type?u.formatMessage({id:"Ycv46p",defaultMessage:"Annotation updated with position x: {x}, y: {y}"},{x:Math.round(100*n.x),y:Math.round(100*n.y)}):u.formatMessage({id:"JCBqbG",defaultMessage:"Annotation updated with size width: {width}, height: {height}"},{width:Math.round(100*n.width),height:Math.round(100*n.height)});C(a)}),[u]),R=G.useCallback((t=>{e&&t.preventDefault()}),[e]),D=G.useCallback(((t,n,a)=>{if(h&&e){d(!1);const e=function(e,t){return V.createNormalizedRegion({left:e.x,top:e.y,width:e.width,height:e.height},{left:t.x,top:t.y,width:t.width,height:t.height})}(Yt(t,h,n),h),i={type:"rectangle",regions:[e]};a?o(i):(w(i),N(i,n))}}),[h,e,d,o,N]),L=G.useCallback(((e,n,a)=>{if(!h||!b)return;const{x:i,y:o,width:r,height:s}=b.regions[0],{width:l,height:c}=t,d=.01;let u;u=a?{x:i,y:o,width:r+e*d,height:s+n*d}:{x:i+e*d,y:o+n*d,width:r,height:s};const _=xn(u,l,c,h);D(_,!a)}),[b,h,t,D]),O=G.useCallback((e=>{k&&c&&c.type===e&&o(null)}),[c,k,o]),F=G.useCallback((()=>{O("highlight")}),[O]),P=G.useCallback((()=>{O("rectangle")}),[O]),U=G.useCallback((()=>{O("point")}),[O]),B=G.useMemo((()=>Gt((e=>{null==r||r(e)}),50)),[r]),z=G.useCallback((()=>{d(!1)}),[d]),q=G.useCallback((()=>{d(!0)}),[d]),H=G.useCallback((e=>{v.current=!0;0===(void 0!==e.buttons?e.buttons:e.nativeEvent.which)&&!c&&B(Mn(e))}),[c,B]),W=G.useCallback((e=>{dn(e)&&(g.current=function(e){return function(e){return"A"===e.target.tagName}(e)?Zt.Link:function(e){const t=e.target.tagName.toUpperCase();return"P"===t||"TEXT"===t}(e)?Zt.Text:function(e,t){return e.target.classList.contains(t)}(e,Qt)||function(e){return"IMG"===e.target.tagName}(e)?Zt.Creation:Zt.None}(e),v.current=!1,x(!1))}),[]),K=G.useCallback((e=>{v.current||(T?(F(),x(!0)):m&&(null==n||n(Mn(e)),x(!0))),g.current=Zt.None}),[m,F,n,T]),j=G.useCallback((()=>{B(void 0)}),[B]),Q=G.useCallback((()=>{if(p.current&&t){const{left:e,top:n}=p.current.getBoundingClientRect(),{width:a,height:i}=t,o={x:e,y:n,width:a,height:i};return y(o),o}}),[t]),Z=G.useCallback((e=>{if(h){const t=Xt(e,h);o({type:"point",regions:[t]})}}),[h,o]),$=G.useCallback(((e,t)=>{M||(t?(o(b),null==i||i()):I||A?(U(),P()):e&&(Z(e),null==i||i()),y(null),d(!0))}),[U,P,Z,b,M,o,i,I,A,d]),Y=G.useCallback((e=>{if(!b||"rectangle"!==b.type)return;let t=!1;"Enter"===e.key?($(void 0,!0),t=!0):"ArrowUp"===e.key?(L(0,-1,e.shiftKey),t=!0):"ArrowDown"===e.key?(L(0,1,e.shiftKey),t=!0):"ArrowLeft"===e.key?(L(-1,0,e.shiftKey),t=!0):"ArrowRight"===e.key&&(L(1,0,e.shiftKey),t=!0),t&&(e.stopImmediatePropagation(),e.preventDefault())}),[b,L,$]);return G.useEffect((()=>{var t;if(s&&"annotating-ax"===f&&e){const e=Q();if(e){const n=e.width>500?200/e.width:.2,a=e.height>250?100/e.height:.1;o({type:"rectangle",regions:[{x:0,y:0,width:n,height:a}]}),null===(t=p.current)||void 0===t||t.focus()}}}),[e,o,s,f,Q]),G.useEffect((()=>{if(p.current){const e=p.current;return e.addEventListener("keydown",Y),()=>e.removeEventListener("keydown",Y)}return()=>{}}),[Y]),G.createElement(G.Fragment,null,G.createElement("div",{ref:p,onMouseDown:W,onMouseUp:K,onMouseLeave:j,onMouseMove:H,className:a.cx(Qt,{"_sc-annotation-conductor-layer__can-create_vvpsd_10":e,"_sc-annotation-conductor-layer__is-creating-rnd_vvpsd_21":h}),onDragStart:R,tabIndex:-1},G.createElement("span",{role:"alert",className:"_accessibilityWarning_vvpsd_25"},G.createElement(a.FormattedMessage,{..._o.accessibilityWarning})),G.createElement(on,{highlight:T},G.createElement(Cn,{rectanglePlacement:A,pointPlacement:I,onChangeStart:Q,onChangeEnd:$,onRectChange:D,onPointChange:t=>{if(h&&e){d(!1);const e=Xt(t,h),n={type:"point",regions:[{...e,width:0,height:0}]};w({type:"point",regions:[{...e,width:0,height:0}]}),N(n,!0)}},onMouseEnterDraft:z,onMouseLeaveDraft:q},l))),G.createElement("div",{style:{opacity:0,position:"absolute"},"aria-live":"polite"},S))};uo.displayName="AnnotationConductorLayer";const _o=E.defineMessages({accessibilityWarning:{id:"WUrnLf",defaultMessage:"Note: There may be limited functionality for screen reader users for this commenting tool."}}),mo=e=>{const{layer:t,draftAnnotation:n,ui:{scaleFactor:i},children:o,isActive:r,onClick:s,onHoverPointChange:l,handleRegionSelection:c,handleAnnotationConfirm:d,setShowCommentCursor:u}=e,_=a.useDispatch(),m=a.useSelector(co),{commentsBladeId:f}=Pt(),p=G.default.useCallback((e=>{c(e,"pageIndex"in t?t.pageIndex:null)}),[c,t]),g=pe(m);G.default.useEffect((()=>{if(g)return()=>{_(Ht(f))}}),[g,_,f]);const v=G.default.useMemo((()=>t.dimensions?{height:t.dimensions.height*i,width:t.dimensions.width*i}:void 0),[i,t.dimensions]);return v?G.default.createElement(uo,{canCreateRectangle:pe(m),annotation:n,onAnnotationChange:p,onAnnotationConfirm:d,handleClick:s,onHoverPointChange:l,layerSize:v,isActive:r,setShowCommentCursor:u},o):G.default.createElement(G.default.Fragment,null,o)};mo.displayName="AnnotationConductor";const fo=a.atom(void 0),po=a.atom(!1),go=a.atom(void 0),vo=a.atom(void 0),ho=E.defineMessage({id:"O3lKDp",defaultMessage:"and {overflowNumber, plural, one {{overflowNumber} other} other {{overflowNumber} others}}"}),yo=E.defineMessage({id:"GiBBTp",defaultMessage:"Loading new comment replies"}),bo=({thread:e,layerSize:n,onMouseEnter:i,onMouseLeave:o})=>{const{commentsBladeId:r,fileId:s,url:l,logEvent:c}=Pt(),{annotation:d,comments:u,id:_,isThirdParty:m}=e,{regions:f,type:p}=an(d),g=a.useDispatch(),v=E.useIntl(),[h,y]=G.useState(!1),[b,w]=G.useState([]),[S,C]=G.useState(28),M=G.useRef(null),x=a.useSelector((e=>ro(e,_,r))),[A,I]=a.useAtom(vo),T=_===A,[k,N]=a.useAtom(go),R=_===k,D=x||T;G.useEffect((()=>{if(u.some((e=>!!e.pending)))return void y(!0);y(!1);const e=new Set,t=[];u.forEach((n=>{n.author&&!e.has(n.author.id)&&(e.add(n.author.id),t.push(n.author))})),w(t)}),[u]);const L=G.useMemo((()=>b.length<=3?b.slice(0,3):b.slice(0,2)),[b]),O=G.useCallback((e=>{c({event:t.CommentsEventName.SELECT_COMMENT_MARK,extra:{commentsAnnotationType:p}}),e.stopPropagation(),I(_),g(Vt({fileId:s,sharedLinkURL:l,threadId:_,fileViewerId:r,isThirdParty:m}))}),[c,p,I,_,g,s,l,r,m]),F=G.useCallback((()=>{null==i||i(),N(r)}),[r,i,N]),P=G.useCallback((()=>{null==o||o(),N(void 0)}),[o,N]),U=G.useCallback((e=>{e.stopPropagation()}),[]),B=G.useMemo((()=>e.read||!!e.resolvedInfo),[e]);if(G.useEffect((()=>{M.current&&(b.length>0||h)&&C(M.current.offsetHeight)}),[D,h,b]),me(f[0]))return null;const V=a.cx("_comment-mark_1craq_112",{[gn]:D,"_comment-mark__hovered_1craq_132":R,"_comment-mark__facepile_1craq_136":!h,"_comment-mark__loading_1craq_142":h}),{x:z,y:q,width:H}=f[0];return G.createElement(a.Box,{ref:M,className:V,style:{top:tn(q-S/n.height),left:tn(z+H),position:"absolute"},"data-testid":"comment-mark-test-id",onClick:O,onMouseEnter:F,onMouseLeave:P,onMouseMove:U},h?G.createElement(a.Spinner,{size:"xsmall","aria-valuetext":v.formatMessage(yo)}):G.createElement("div",{className:a.cx({"_comment-mark-facepile-transparent_1craq_128":B})},G.createElement(a.ThemeProvider,{mode:"dark"},G.createElement(a.ThemeContainer,null,G.createElement(a.Facepile,{size:D?"small":"xsmall",hasLegacySpacing:!0},L.map((e=>G.createElement(a.Facepile.Item,{alt:e.name.display,src:e.photoUrl,key:e.id},e.name.initials))),b.length>3&&G.createElement(a.Facepile.Item,{alt:v.formatMessage(ho,{overflowNumber:b.length-L.length})},b.length-L.length))))))};function Eo(e){const{rectangle:t,isEmphasized:n,onMouseEnter:i,onMouseLeave:o}=e,r=a.cx(vn,{[gn]:n});return G.createElement("div",{style:nn(t),className:r,"data-testid":"annotation-highlight-segment",onMouseEnter:i,onMouseLeave:o})}function wo({threads:e,layerSize:t,activeThreadId:n,focusedThreadId:a,hoveredThreadId:i,setShowCommentCursor:o}){return e.map((e=>{const{id:r,annotation:s}=e,{type:l,regions:c}=an(s),d=[n,a,i].includes(r),u=()=>o(!1),_=()=>o(!0),m=t?G.createElement(bo,{thread:e,layerSize:t,onMouseEnter:u,onMouseLeave:_,key:`comment-mark-${e.id}`}):null;switch(l){case"rectangle":return G.createElement(G.Fragment,{key:r},m,G.createElement(hn,{rectangle:c[0],isEmphasized:d}),G.createElement(bn,{rectangle:c[0],onMouseEnter:u,onMouseLeave:_}));case"highlight":return G.createElement(G.Fragment,{key:r},m,c.map(((e,t)=>G.createElement(Eo,{key:`${r}-${t}`,rectangle:e,isEmphasized:d,onMouseEnter:u,onMouseLeave:_}))));case"point":return G.createElement(G.Fragment,{key:r},m)}}))}function So(e){const{threads:t,hideLayer:n,layerSize:i,handleClick:o,handleHoverPointChange:r,setShowCommentCursor:s}=e,{commentsBladeId:l}=Pt(),c=a.useSelector((e=>so(e,l))),d=a.useAtomValue(vo),u=a.useAtomValue(go),_={layerSize:i,activeThreadId:c,focusedThreadId:d,hoveredThreadId:u,setShowCommentCursor:s},m=t.filter((e=>"rectangle"===an(e.annotation).type)),f=t.filter((e=>"highlight"===an(e.annotation).type)),p=t.filter((e=>"point"===an(e.annotation).type)),g=wo({threads:m,..._}),v=wo({threads:f,..._}),h=wo({threads:p,..._}),y=wo({threads:[...m,...f,...p],..._});let b;if(i){const e=[...m,...p].filter((e=>e.id===c));if(e&&1===e.length){b=xn(an(e[0].annotation).regions[0],i.width,i.height)}}const E=G.useCallback((e=>{null==r||r(Mn(e))}),[r]),w=G.useCallback((e=>{null==o||o(Mn(e))}),[o]);return G.createElement("div",{className:"_view-layer_1craq_1","data-testid":"annotation-view-layer",onMouseMove:E,onClick:w},G.createElement("div",{className:a.cx({"_hide-regular-sublayer_1craq_32":n})},G.createElement("div",{className:"_regular-rectangle-sublayer_1craq_11"},g),G.createElement("div",{className:"_regular-highlight-sublayer_1craq_18"},v),G.createElement("div",{className:"_regular-point-sublayer_1craq_25","data-testid":"point-view-layer"},h)),G.createElement("div",{className:"_emphasis-sublayer_1craq_61","data-testid":"annotation-emphasis-sublayer"},y),b&&G.createElement(En,{placement:b}))}const Co=({threads:e,layer:{dimensions:t},draftAnnotation:n,ui:{scaleFactor:a},onClick:i,onHoverPointChange:o,setShowCommentCursor:r})=>{if(null==t)return null;const{height:s,width:l}=t;return G.createElement(So,{threads:e,hideLayer:null!=n,layerSize:{height:s*a,width:l*a},handleClick:i,handleHoverPointChange:o,setShowCommentCursor:r})};Co.displayName="AnnotationHighlights";const Mo=a.atom({});Mo.debugLabel="_reactionsAtom";const xo=a.atom((e=>e(Mo)),((e,t,n)=>{const a=e(Mo);t(Mo,{...a,...n})}));xo.debugLabel="reactionsAtom";const Ao=a.atom({});Ao.debugLabel="_reactionsBoltInfoAtom";const Io=a.atom((e=>e(Ao)),((e,t,n)=>{const a=e(Ao);t(Ao,{...a,...n})}));Io.debugLabel="reactionsBoltInfoAtom";const To=a.atom({});To.debugLabel="_reactionsUsersAtom";const ko=a.atom((e=>e(To)),((e,t,n)=>{const a=e(To);t(To,{...a,...n})}));ko.debugLabel="reactionsUsersAtom";const No=a.atom(void 0);No.debugLabel="_currentUserPidAtom";const Ro=a.atom((e=>e(No)),((e,t,n)=>t(No,n))),Do=({children:t,...i})=>{const[o,r]=n.useState(!1),s=a.useSetAtom(vo),{file:l,user:c,reportException:d,logEvent:u,apiV2Client:_,reactionsBoltIOClient:m,navigationCallbacks:f,previewType:p,showSnackbar:g,handleCopyLinkClick:v,showAuthModal:h}=i,{loggingSessionId:y}=a.useFileViewerContext(),b=a.useDispatch(),E=!c,w=a.useStickersQuery(_),[S,C]=n.useState(void 0);G.default.useEffect((()=>{void 0===S&&(async()=>{const t=await new Promise((function(t,n){e(["./c_emoji-mart_data_sets_14_native"],t,n)}));C(t)})()}),[S]);const M=n.useCallback((()=>{if(!h)throw new Error("showAuthModal must be passed for logged out user");h()}),[h]),x=n.useMemo((()=>{if(f)return p===a.PreviewType.Audio||p===a.PreviewType.Video?{type:"av",seek:f.seek,pause:f.pause}:void 0}),[f,p]),A=n.useCallback((e=>{b(Vt({fileId:l.fileId,sharedLinkURL:l.url,threadId:e.threadID,fileViewerId:y,isThirdParty:!1}))}),[l.fileId,l.url,y,b]),I=n.useCallback((()=>to({dispatch:b,user:c,getFileId:()=>l.fileId,getUrl:()=>l.url,getCommentsBladeId:()=>y,onEditorFocused:()=>{M&&E&&!o&&(r(!0),M())},seek:e=>{"av"===(null==x?void 0:x.type)&&x.seek(e)},pause:()=>{"av"===(null==x?void 0:x.type)&&x.pause()},onClickAnnotation:A,showAuthModal:M,reportException:d,setFocusedThreadId:s})),[x,b,l.fileId,l.url,y,o,E,A,d,M,c,s]),T=n.useMemo((()=>({apiV2Client:_,user:null!=c?c:Ot,isLoggedOut:E,fileId:l.fileId,fileName:l.name,url:l.url,commentsBladeId:y,navigation:x,showAuthModal:M,reportException:d,onClickAnnotation:A,logEvent:u,stickerPacks:w,actionsAdapter:I(),reactionsBoltIOClient:m,emojiData:S,previewType:p,showSnackbar:g,handleCopyLinkClick:v})),[_,c,E,l.fileId,l.name,l.url,y,x,M,d,A,u,w,I,m,S,p,g,v]);return G.default.createElement(Ft.Provider,{value:T},t)};Do.displayName="CommentsContextProvider";const Lo=(e,t)=>t||e,Oo=({children:t,...n})=>{const i=a.useDispatch(),{commentsBladeId:o,fileId:r,url:s}=Pt(),l=a.useSelector((e=>io(e,o))),c=a.useAfterDisplayPassthroughCallback({importer:async()=>{const{annotationHandleClick:t}=await new Promise((function(t,n){e(["./c_plugin_annotations_annotation_layer.after-display"],t,n)}));return{default:{fn:t}}}}),d=a.useAfterDisplayPassthroughCallback({importer:async()=>{const{handleHoverPointChange:t}=await new Promise((function(t,n){e(["./c_plugin_annotations_annotation_layer.after-display"],t,n)}));return{default:{fn:t}}}}),u=a.useSetAtom(vo),_=G.useRef(null),[m,f]=G.useState(!0),[p,g]=G.useState(!1);G.useEffect((()=>{f(p)}),[p]),G.useEffect((()=>{const e=e=>{_.current&&_.current.contains(e.target)?p||g(!0):p&&g(!1)};return document.addEventListener("mousemove",e),()=>{document.removeEventListener("mousemove",e)}}),[p]);const v=n.layer.viewportRef,h=e=>c.fn(e,n.threads,i,u,o,r,s),y=a.useSetAtom(go),b=e=>d.fn(n.threads,y,e),E=n.previewType===a.PreviewType.CloudDoc||n.previewType===a.PreviewType.SsrDoc||n.previewType===a.PreviewType.Image,w=G.createElement(a.ClickOutside,{isClickThroughPortaled:!1,shouldPropagateMouseEvents:!0,onClickOutside:e=>{var t,n;e.target&&(null===(t=v.current)||void 0===t?void 0:t.contains(e.target))&&i((n=o,{type:Bt.ClearDraftAnnotation,payload:{fileViewerId:n}}))},shouldClickOutsideWhenDefaultPrevented:!1,isActive:!!n.draftAnnotation},G.createElement("div",{ref:_,className:a.cx(Ut,"_comment-conductor_34m26_14",{_show_comment_cursor_34m26_14:E&&m})},G.createElement(mo,{...n,onClick:h,onHoverPointChange:b,setShowCommentCursor:f},t))),S=G.createElement(a.ClickOutside,{isClickThroughPortaled:!1,shouldPropagateMouseEvents:!0,onClickOutside:e=>{var t;e.target&&(null===(t=v.current)||void 0===t?void 0:t.contains(e.target))&&(i(zt({fileViewerId:o})),u(void 0))},shouldClickOutsideWhenDefaultPrevented:!1,isActive:n.threads.some((e=>l===e.id))},G.createElement("div",{className:Ut},null===n.draftAnnotation&&G.createElement(Co,{...n,onClick:h,onHoverPointChange:b,setShowCommentCursor:f})));return G.createElement(G.Fragment,null,!n.viewOnly&&w,n.displayLayers.textLayer&&G.createElement(qo,{textLayer:n.displayLayers.textLayer}),S)};Oo.displayName="BaseAnnotationLayer";const Fo=e=>{const{fileId:t,url:n,commentsBladeId:i}=Pt(),o=Lo(t,n),r=a.useSelector((e=>oo(e,o)))||{},s=a.useAtomValue(po),l=Object.values(r).filter((e=>{return null!=(t=e).annotation&&"image"===t.annotation.type&&Po(e,s);var t})),c=a.useSelector((e=>lo(e,i))),d=G.useMemo((()=>null==c||"image"!==c.type?null:Ga(c)),[c]);return G.createElement(Oo,{...e,threads:l,draftAnnotation:d,isActive:!0})};function Po(e,t){return t||!e.resolvedInfo}function Uo(e,t){if(!e||!e.regions)return!1;const n=Jt(t);return e.regions.some((e=>e.page===n))}Fo.displayName="ImageAnnotationLayer";const Bo=e=>{const{fileId:t,url:n,commentsBladeId:i}=Pt(),o=Lo(t,n),r=a.useSelector((e=>oo(e,o)))||{},s=a.useAtomValue(po),l=a.useSelector((e=>lo(e,i))),{layer:c}=e,d=_.useCurrentDocPage(),u=c.pageIndex,m=Object.values(r).filter((e=>{return null!=(t=e).annotation&&"document"===t.annotation.type&&Po(e,s)&&Uo(e.annotation,u);var t})),f=G.useMemo((()=>null!=l&&"document"===l.type&&Uo(l,u)?Ga(l):null),[l,u]);return G.createElement(Oo,{...e,threads:m,draftAnnotation:f,isActive:u===d})};Bo.displayName="DocAnnotationLayer";const Vo=e=>e.previewType===a.PreviewType.Image?G.createElement(Fo,{...e}):e.previewType===a.PreviewType.SsrDoc||e.previewType===a.PreviewType.CloudDoc?G.createElement(Bo,{...e}):e.previewType===a.PreviewType.Audio||e.previewType===a.PreviewType.Video?G.createElement(jt,{...e}):G.createElement(G.Fragment,null,e.children);Vo.displayName="AnnotationLayerInternal";const zo=e=>G.createElement(Do,{...e},G.createElement(Vo,{...e}));zo.displayName="AnnotationLayer";const qo=({textLayer:e})=>{const{commentsBladeId:t}=Pt();return a.useSelector((e=>lo(e,t)))?null:e};qo.displayName="CommentTextLayer",zo.displayName="AnnotationLayer";a.injectInternalStyle("/static/js/comments2/plugin/comments2.module.out-vfl0fhZ4w.css",(e=>"._comments-pane_1304m_1>.sc-comment-stream{width:100%}._comments-pane-blade_1304m_5{height:100%}._disabled-annotations-show-more_1304m_9{color:var(--color__attention__text);cursor:pointer}._annotation-tooltip-container_1304m_14{height:25px;position:absolute;width:30px}._iconContainer_1304m_20{display:flex;position:relative}._iconContainer__visualRefresh_1304m_25{height:24px;position:relative;width:24px}._unreadBadge_1304m_31{color:var(--dig-color__primary__on-base);position:absolute;right:-6px;top:-6px}._commentButton_1304m_38{height:100%;width:100%}"));const Ho=e=>a.useSelector((t=>e?((e,t)=>{const n=e.threads[t];return n?Object.values(n).filter((e=>!e.read&&!e.resolvedInfo&&e.comments.some((e=>!e.deleted)))).length:void 0})(t,e):void 0)),Wo=({fileId:e,sharedLinkURL:t,setHasUnreadComments:n})=>{const i=G.default.useMemo((()=>Lo(e,t)),[e,t]),o=Ho(i),r=G.default.useRef(!1);return G.default.useEffect((()=>{void 0!==o&&n&&!r.current&&(n(o>0),r.current=!0)}),[o,n]),G.default.createElement("span",{className:"_iconContainer_1304m_20"},G.default.createElement(a.UIIcon,{src:q.CommentLine,className:"_commentButton_1304m_38"}),!!o&&o>0&&G.default.createElement(a.Badge,{variant:"attention",className:"_unreadBadge_1304m_31","aria-label":"Comments notification unread count"},o))};Wo.displayName="CommentIconWithUnreadCount";function Ko({event:e,stream:t,thread_id:n,comment_id:a,is_third_party:i,error:o}){return Sa({arg:{event:o?{".tag":"comment_error"}:e,stream:t,thread_id:n,comment_id:a,is_third_party:i,oref:"dfv",product_surface:{".tag":"file_preview"},product_surface_context:{".tag":"file_preview"},error_message:o?o.message:void 0}})}const jo=({dispatch:e})=>t=>n=>{const a=t(n);if(n.type===In)e(Ko({event:n.payload.arg.thread_id?{".tag":"reply_to_comment"}:{".tag":"new_comment"},stream:n.payload.arg.stream,thread_id:n.payload.arg.thread_id,error:n.error}));else if(n.type===Xn)e(Ko({event:{".tag":"mark_thread_as_read"},stream:n.payload.arg.stream,thread_id:n.payload.arg.id,error:n.error}));else if(n.type===ea)e(Ko({event:{".tag":"mark_thread_as_unread"},stream:n.payload.arg.stream,thread_id:n.payload.arg.id,error:n.error}));else if(n.type===na)e(Ko({event:{".tag":"resolve_thread"},stream:n.payload.arg.stream,thread_id:n.payload.arg.id,error:n.error}));else if(n.type===ra)e(Ko({event:{".tag":"unresolve_thread"},stream:n.payload.arg.stream,thread_id:n.payload.arg.id,error:n.error}));else if(n.type===Rn)e(Ko({event:{".tag":"delete_comment"},stream:n.payload.arg.stream,thread_id:n.meta?n.meta.threadId:void 0,comment_id:n.payload.arg.id,error:n.error}));else if(n.type===Fn)e(Ko({event:{".tag":"edit_comment"},stream:n.payload.arg.stream,thread_id:n.meta?n.meta.threadId:void 0,comment_id:n.payload.arg.id,error:n.error}));else if(n.type===Bt.ActivateThread){const{fileId:t,isThirdParty:a,threadId:i}=n.payload,o=hi(t);e(Ko({event:{".tag":"activate_thread"},stream:o,thread_id:i,is_third_party:a}))}return a};var Go;t.CommentSurface=void 0,(Go=t.CommentSurface||(t.CommentSurface={})).FULL_PREVIEW="full_preview",Go.QUICK_VIEW="quick_view";const Qo="@@apiv2_redux/files/alpha/get_metadata",Zo="@@apiv2_redux/files/alpha/get_metadata_result",$o="@@apiv2_redux/files/alpha/upload",Yo="@@apiv2_redux/files/alpha/upload_result",Xo="@@apiv2_redux/files/browse",Jo="@@apiv2_redux/files/browse_result",er="@@apiv2_redux/files/browse_continue",tr="@@apiv2_redux/files/browse_continue_result",nr="@@apiv2_redux/files/content_tiles_metadata_v2",ar="@@apiv2_redux/files/content_tiles_metadata_v2_result",ir="@@apiv2_redux/files/copy",or="@@apiv2_redux/files/copy_result",rr="@@apiv2_redux/files/copy_v2",sr="@@apiv2_redux/files/copy_v2_result",lr="@@apiv2_redux/files/copy_batch",cr="@@apiv2_redux/files/copy_batch_result",dr="@@apiv2_redux/files/copy_batch_v2",ur="@@apiv2_redux/files/copy_batch_v2_result",_r="@@apiv2_redux/files/copy_batch/check",mr="@@apiv2_redux/files/copy_batch/check_result",fr="@@apiv2_redux/files/copy_batch/check_v2",pr="@@apiv2_redux/files/copy_batch/check_v2_result",gr="@@apiv2_redux/files/copy_batch_sync",vr="@@apiv2_redux/files/copy_batch_sync_result",hr="@@apiv2_redux/files/copy_reference/get",yr="@@apiv2_redux/files/copy_reference/get_result",br="@@apiv2_redux/files/copy_reference/save",Er="@@apiv2_redux/files/copy_reference/save_result",wr="@@apiv2_redux/files/create_folder",Sr="@@apiv2_redux/files/create_folder_result",Cr="@@apiv2_redux/files/create_folder_v2",Mr="@@apiv2_redux/files/create_folder_v2_result",xr="@@apiv2_redux/files/create_folder_batch",Ar="@@apiv2_redux/files/create_folder_batch_result",Ir="@@apiv2_redux/files/create_folder_batch/check",Tr="@@apiv2_redux/files/create_folder_batch/check_result",kr="@@apiv2_redux/files/delete",Nr="@@apiv2_redux/files/delete_result",Rr="@@apiv2_redux/files/delete_v2",Dr="@@apiv2_redux/files/delete_v2_result",Lr="@@apiv2_redux/files/delete_batch",Or="@@apiv2_redux/files/delete_batch_result",Fr="@@apiv2_redux/files/delete_batch/check",Pr="@@apiv2_redux/files/delete_batch/check_result",Ur="@@apiv2_redux/files/delete_batch_with_changeset_sync",Br="@@apiv2_redux/files/delete_batch_with_changeset_sync_result",Vr="@@apiv2_redux/files/delete_with_changeset",zr="@@apiv2_redux/files/delete_with_changeset_result",qr="@@apiv2_redux/files/download",Hr="@@apiv2_redux/files/download_result",Wr="@@apiv2_redux/files/download_zip",Kr="@@apiv2_redux/files/download_zip_result",jr="@@apiv2_redux/files/export",Gr="@@apiv2_redux/files/export_result",Qr="@@apiv2_redux/files/get_browse_bolt_data",Zr="@@apiv2_redux/files/get_browse_bolt_data_result",$r="@@apiv2_redux/files/get_file_content_metadata",Yr="@@apiv2_redux/files/get_file_content_metadata_result",Xr="@@apiv2_redux/files/get_file_info",Jr="@@apiv2_redux/files/get_file_info_result",es="@@apiv2_redux/files/get_file_info_batch",ts="@@apiv2_redux/files/get_file_info_batch_result",ns="@@apiv2_redux/files/get_file_lock_batch",as="@@apiv2_redux/files/get_file_lock_batch_result",is="@@apiv2_redux/files/get_home_widget_files",os="@@apiv2_redux/files/get_home_widget_files_result",rs="@@apiv2_redux/files/get_metadata",ss="@@apiv2_redux/files/get_metadata_result",ls="@@apiv2_redux/files/get_metadata_batch",cs="@@apiv2_redux/files/get_metadata_batch_result",ds="@@apiv2_redux/files/get_preview",us="@@apiv2_redux/files/get_preview_result",_s="@@apiv2_redux/files/get_preview_v3",ms="@@apiv2_redux/files/get_preview_v3_result",fs="@@apiv2_redux/files/get_previewable_extensions",ps="@@apiv2_redux/files/get_previewable_extensions_result",gs="@@apiv2_redux/files/get_query_suggestions",vs="@@apiv2_redux/files/get_query_suggestions_result",hs="@@apiv2_redux/files/get_temporary_link",ys="@@apiv2_redux/files/get_temporary_link_result",bs="@@apiv2_redux/files/get_temporary_upload_link",Es="@@apiv2_redux/files/get_temporary_upload_link_result",ws="@@apiv2_redux/files/get_thumbnail",Ss="@@apiv2_redux/files/get_thumbnail_result",Cs="@@apiv2_redux/files/get_thumbnail_v2",Ms="@@apiv2_redux/files/get_thumbnail_v2_result",xs="@@apiv2_redux/files/get_thumbnail_batch",As="@@apiv2_redux/files/get_thumbnail_batch_result",Is="@@apiv2_redux/files/get_thumbnail_batch_link",Ts="@@apiv2_redux/files/get_thumbnail_batch_link_result",ks="@@apiv2_redux/files/get_upload_info",Ns="@@apiv2_redux/files/get_upload_info_result",Rs="@@apiv2_redux/files/list_folder",Ds="@@apiv2_redux/files/list_folder_result",Ls="@@apiv2_redux/files/list_folder/continue",Os="@@apiv2_redux/files/list_folder/continue_result",Fs="@@apiv2_redux/files/list_folder/get_latest_cursor",Ps="@@apiv2_redux/files/list_folder/get_latest_cursor_result",Us="@@apiv2_redux/files/list_revisions",Bs="@@apiv2_redux/files/list_revisions_result",Vs="@@apiv2_redux/files/list_subfolders",zs="@@apiv2_redux/files/list_subfolders_result",qs="@@apiv2_redux/files/list_widgets",Hs="@@apiv2_redux/files/list_widgets_result",Ws="@@apiv2_redux/files/lock_file_batch",Ks="@@apiv2_redux/files/lock_file_batch_result",js="@@apiv2_redux/files/media_transcode",Gs="@@apiv2_redux/files/media_transcode_result",Qs="@@apiv2_redux/files/move",Zs="@@apiv2_redux/files/move_result",$s="@@apiv2_redux/files/move_v2",Ys="@@apiv2_redux/files/move_v2_result",Xs="@@apiv2_redux/files/move_batch",Js="@@apiv2_redux/files/move_batch_result",el="@@apiv2_redux/files/move_batch_v2",tl="@@apiv2_redux/files/move_batch_v2_result",nl="@@apiv2_redux/files/move_batch/check",al="@@apiv2_redux/files/move_batch/check_result",il="@@apiv2_redux/files/move_batch/check_v2",ol="@@apiv2_redux/files/move_batch/check_v2_result",rl="@@apiv2_redux/files/move_batch_sync",sl="@@apiv2_redux/files/move_batch_sync_result",ll="@@apiv2_redux/files/paper/create",cl="@@apiv2_redux/files/paper/create_result",dl="@@apiv2_redux/files/paper/update",ul="@@apiv2_redux/files/paper/update_result",_l="@@apiv2_redux/files/permanently_delete",ml="@@apiv2_redux/files/permanently_delete_result",fl="@@apiv2_redux/files/properties/add",pl="@@apiv2_redux/files/properties/add_result",gl="@@apiv2_redux/files/properties/overwrite",vl="@@apiv2_redux/files/properties/overwrite_result",hl="@@apiv2_redux/files/properties/update",yl="@@apiv2_redux/files/properties/update_result",bl="@@apiv2_redux/files/recents_v2",El="@@apiv2_redux/files/recents_v2_result",wl="@@apiv2_redux/files/request_unlock_file_batch",Sl="@@apiv2_redux/files/request_unlock_file_batch_result",Cl="@@apiv2_redux/files/restore",Ml="@@apiv2_redux/files/restore_result",xl="@@apiv2_redux/files/restore_path_batch_sync",Al="@@apiv2_redux/files/restore_path_batch_sync_result",Il="@@apiv2_redux/files/save_url",Tl="@@apiv2_redux/files/save_url_result",kl="@@apiv2_redux/files/save_url/check_job_status",Nl="@@apiv2_redux/files/save_url/check_job_status_result",Rl="@@apiv2_redux/files/search",Dl="@@apiv2_redux/files/search_result",Ll="@@apiv2_redux/files/search_v2",Ol="@@apiv2_redux/files/search_v2_result",Fl="@@apiv2_redux/files/search/continue_v2",Pl="@@apiv2_redux/files/search/continue_v2_result",Ul="@@apiv2_redux/files/search_ex",Bl="@@apiv2_redux/files/search_ex_result",Vl="@@apiv2_redux/files/set_user_sort_preference",zl="@@apiv2_redux/files/set_user_sort_preference_result",ql="@@apiv2_redux/files/starred_v2",Hl="@@apiv2_redux/files/starred_v2_result",Wl="@@apiv2_redux/files/tags/add",Kl="@@apiv2_redux/files/tags/add_result",jl="@@apiv2_redux/files/tags/get",Gl="@@apiv2_redux/files/tags/get_result",Ql="@@apiv2_redux/files/tags/remove",Zl="@@apiv2_redux/files/tags/remove_result",$l="@@apiv2_redux/files/team_folder/copy",Yl="@@apiv2_redux/files/team_folder/copy_result",Xl="@@apiv2_redux/files/team_folder/copy/check",Jl="@@apiv2_redux/files/team_folder/copy/check_result",ec="@@apiv2_redux/files/team_folder/create",tc="@@apiv2_redux/files/team_folder/create_result",nc="@@apiv2_redux/files/team_folder/create/check",ac="@@apiv2_redux/files/team_folder/create/check_result",ic="@@apiv2_redux/files/team_folder/delete",oc="@@apiv2_redux/files/team_folder/delete_result",rc="@@apiv2_redux/files/team_folder/move",sc="@@apiv2_redux/files/team_folder/move_result",lc="@@apiv2_redux/files/team_folder/move/check",cc="@@apiv2_redux/files/team_folder/move/check_result",dc="@@apiv2_redux/files/team_folder/rename",uc="@@apiv2_redux/files/team_folder/rename_result",_c="@@apiv2_redux/files/team_folder/restore",mc="@@apiv2_redux/files/team_folder/restore_result",fc="@@apiv2_redux/files/tree_view_folders",pc="@@apiv2_redux/files/tree_view_folders_result",gc="@@apiv2_redux/files/undo_batch",vc="@@apiv2_redux/files/undo_batch_result",hc="@@apiv2_redux/files/unlock_file_batch",yc="@@apiv2_redux/files/unlock_file_batch_result",bc="@@apiv2_redux/files/update_default_section",Ec="@@apiv2_redux/files/update_default_section_result",wc="@@apiv2_redux/files/update_widgets",Sc="@@apiv2_redux/files/update_widgets_result",Cc="@@apiv2_redux/files/upload",Mc="@@apiv2_redux/files/upload_result",xc="@@apiv2_redux/files/upload_session/append",Ac="@@apiv2_redux/files/upload_session/append_result",Ic="@@apiv2_redux/files/upload_session/append_v2",Tc="@@apiv2_redux/files/upload_session/append_v2_result",kc="@@apiv2_redux/files/upload_session/append_batch",Nc="@@apiv2_redux/files/upload_session/append_batch_result",Rc="@@apiv2_redux/files/upload_session/finish",Dc="@@apiv2_redux/files/upload_session/finish_result",Lc="@@apiv2_redux/files/upload_session/finish_batch",Oc="@@apiv2_redux/files/upload_session/finish_batch_result",Fc="@@apiv2_redux/files/upload_session/finish_batch_v2",Pc="@@apiv2_redux/files/upload_session/finish_batch_v2_result",Uc="@@apiv2_redux/files/upload_session/finish_batch/check",Bc="@@apiv2_redux/files/upload_session/finish_batch/check_result",Vc="@@apiv2_redux/files/upload_session/finish_processed",zc="@@apiv2_redux/files/upload_session/finish_processed_result",qc="@@apiv2_redux/files/upload_session/finish_processed/check",Hc="@@apiv2_redux/files/upload_session/finish_processed/check_result",Wc="@@apiv2_redux/files/upload_session/start",Kc="@@apiv2_redux/files/upload_session/start_result",jc="@@apiv2_redux/files/upload_session/start_batch",Gc="@@apiv2_redux/files/upload_session/start_batch_result",Qc="@@apiv2_redux/files/validate_upload",Zc="@@apiv2_redux/files/validate_upload_result",$c={[Qo]:{endpoint:"alpha/get_metadata",action:D._createAction(Zo)},[$o]:{endpoint:"alpha/upload",action:D._createAction(Yo)},[Xo]:{endpoint:"browse",action:D._createAction(Jo)},[er]:{endpoint:"browse_continue",action:D._createAction(tr)},[nr]:{endpoint:"content_tiles_metadata_v2",action:D._createAction(ar)},[ir]:{endpoint:"copy",action:D._createAction(or)},[rr]:{endpoint:"copy_v2",action:D._createAction(sr)},[lr]:{endpoint:"copy_batch",action:D._createAction(cr)},[dr]:{endpoint:"copy_batch_v2",action:D._createAction(ur)},[_r]:{endpoint:"copy_batch/check",action:D._createAction(mr)},[fr]:{endpoint:"copy_batch/check_v2",action:D._createAction(pr)},[gr]:{endpoint:"copy_batch_sync",action:D._createAction(vr)},[hr]:{endpoint:"copy_reference/get",action:D._createAction(yr)},[br]:{endpoint:"copy_reference/save",action:D._createAction(Er)},[wr]:{endpoint:"create_folder",action:D._createAction(Sr)},[Cr]:{endpoint:"create_folder_v2",action:D._createAction(Mr)},[xr]:{endpoint:"create_folder_batch",action:D._createAction(Ar)},[Ir]:{endpoint:"create_folder_batch/check",action:D._createAction(Tr)},[kr]:{endpoint:"delete",action:D._createAction(Nr)},[Rr]:{endpoint:"delete_v2",action:D._createAction(Dr)},[Lr]:{endpoint:"delete_batch",action:D._createAction(Or)},[Fr]:{endpoint:"delete_batch/check",action:D._createAction(Pr)},[Ur]:{endpoint:"delete_batch_with_changeset_sync",action:D._createAction(Br)},[Vr]:{endpoint:"delete_with_changeset",action:D._createAction(zr)},[qr]:{endpoint:"download",action:D._createAction(Hr)},[Wr]:{endpoint:"download_zip",action:D._createAction(Kr)},[jr]:{endpoint:"export",action:D._createAction(Gr)},[Qr]:{endpoint:"get_browse_bolt_data",action:D._createAction(Zr)},[$r]:{endpoint:"get_file_content_metadata",action:D._createAction(Yr)},[Xr]:{endpoint:"get_file_info",action:D._createAction(Jr)},[es]:{endpoint:"get_file_info_batch",action:D._createAction(ts)},[ns]:{endpoint:"get_file_lock_batch",action:D._createAction(as)},[is]:{endpoint:"get_home_widget_files",action:D._createAction(os)},[rs]:{endpoint:"get_metadata",action:D._createAction(ss)},[ls]:{endpoint:"get_metadata_batch",action:D._createAction(cs)},[ds]:{endpoint:"get_preview",action:D._createAction(us)},[_s]:{endpoint:"get_preview_v3",action:D._createAction(ms)},[fs]:{endpoint:"get_previewable_extensions",action:D._createAction(ps)},[gs]:{endpoint:"get_query_suggestions",action:D._createAction(vs)},[hs]:{endpoint:"get_temporary_link",action:D._createAction(ys)},[bs]:{endpoint:"get_temporary_upload_link",action:D._createAction(Es)},[ws]:{endpoint:"get_thumbnail",action:D._createAction(Ss)},[Cs]:{endpoint:"get_thumbnail_v2",action:D._createAction(Ms)},[xs]:{endpoint:"get_thumbnail_batch",action:D._createAction(As)},[Is]:{endpoint:"get_thumbnail_batch_link",action:D._createAction(Ts)},[ks]:{endpoint:"get_upload_info",action:D._createAction(Ns)},[Rs]:{endpoint:"list_folder",action:D._createAction(Ds)},[Ls]:{endpoint:"list_folder/continue",action:D._createAction(Os)},[Fs]:{endpoint:"list_folder/get_latest_cursor",action:D._createAction(Ps)},[Us]:{endpoint:"list_revisions",action:D._createAction(Bs)},[Vs]:{endpoint:"list_subfolders",action:D._createAction(zs)},[qs]:{endpoint:"list_widgets",action:D._createAction(Hs)},[Ws]:{endpoint:"lock_file_batch",action:D._createAction(Ks)},[js]:{endpoint:"media_transcode",action:D._createAction(Gs)},[Qs]:{endpoint:"move",action:D._createAction(Zs)},[$s]:{endpoint:"move_v2",action:D._createAction(Ys)},[Xs]:{endpoint:"move_batch",action:D._createAction(Js)},[el]:{endpoint:"move_batch_v2",action:D._createAction(tl)},[nl]:{endpoint:"move_batch/check",action:D._createAction(al)},[il]:{endpoint:"move_batch/check_v2",action:D._createAction(ol)},[rl]:{endpoint:"move_batch_sync",action:D._createAction(sl)},[ll]:{endpoint:"paper/create",action:D._createAction(cl)},[dl]:{endpoint:"paper/update",action:D._createAction(ul)},[_l]:{endpoint:"permanently_delete",action:D._createAction(ml)},[fl]:{endpoint:"properties/add",action:D._createAction(pl)},[gl]:{endpoint:"properties/overwrite",action:D._createAction(vl)},[hl]:{endpoint:"properties/update",action:D._createAction(yl)},[bl]:{endpoint:"recents_v2",action:D._createAction(El)},[wl]:{endpoint:"request_unlock_file_batch",action:D._createAction(Sl)},[Cl]:{endpoint:"restore",action:D._createAction(Ml)},[xl]:{endpoint:"restore_path_batch_sync",action:D._createAction(Al)},[Il]:{endpoint:"save_url",action:D._createAction(Tl)},[kl]:{endpoint:"save_url/check_job_status",action:D._createAction(Nl)},[Rl]:{endpoint:"search",action:D._createAction(Dl)},[Ll]:{endpoint:"search_v2",action:D._createAction(Ol)},[Fl]:{endpoint:"search/continue_v2",action:D._createAction(Pl)},[Ul]:{endpoint:"search_ex",action:D._createAction(Bl)},[Vl]:{endpoint:"set_user_sort_preference",action:D._createAction(zl)},[ql]:{endpoint:"starred_v2",action:D._createAction(Hl)},[Wl]:{endpoint:"tags/add",action:D._createAction(Kl)},[jl]:{endpoint:"tags/get",action:D._createAction(Gl)},[Ql]:{endpoint:"tags/remove",action:D._createAction(Zl)},[$l]:{endpoint:"team_folder/copy",action:D._createAction(Yl)},[Xl]:{endpoint:"team_folder/copy/check",action:D._createAction(Jl)},[ec]:{endpoint:"team_folder/create",action:D._createAction(tc)},[nc]:{endpoint:"team_folder/create/check",action:D._createAction(ac)},[ic]:{endpoint:"team_folder/delete",action:D._createAction(oc)},[rc]:{endpoint:"team_folder/move",action:D._createAction(sc)},[lc]:{endpoint:"team_folder/move/check",action:D._createAction(cc)},[dc]:{endpoint:"team_folder/rename",action:D._createAction(uc)},[_c]:{endpoint:"team_folder/restore",action:D._createAction(mc)},[fc]:{endpoint:"tree_view_folders",action:D._createAction(pc)},[gc]:{endpoint:"undo_batch",action:D._createAction(vc)},[hc]:{endpoint:"unlock_file_batch",action:D._createAction(yc)},[bc]:{endpoint:"update_default_section",action:D._createAction(Ec)},[wc]:{endpoint:"update_widgets",action:D._createAction(Sc)},[Cc]:{endpoint:"upload",action:D._createAction(Mc)},[xc]:{endpoint:"upload_session/append",action:D._createAction(Ac)},[Ic]:{endpoint:"upload_session/append_v2",action:D._createAction(Tc)},[kc]:{endpoint:"upload_session/append_batch",action:D._createAction(Nc)},[Rc]:{endpoint:"upload_session/finish",action:D._createAction(Dc)},[Lc]:{endpoint:"upload_session/finish_batch",action:D._createAction(Oc)},[Fc]:{endpoint:"upload_session/finish_batch_v2",action:D._createAction(Pc)},[Uc]:{endpoint:"upload_session/finish_batch/check",action:D._createAction(Bc)},[Vc]:{endpoint:"upload_session/finish_processed",action:D._createAction(zc)},[qc]:{endpoint:"upload_session/finish_processed/check",action:D._createAction(Hc)},[Wc]:{endpoint:"upload_session/start",action:D._createAction(Kc)},[jc]:{endpoint:"upload_session/start_batch",action:D._createAction(Gc)},[Qc]:{endpoint:"validate_upload",action:D._createAction(Zc)}},Yc=D._createMiddleware($c),Xc="comments2";const Jc=()=>({dispatch:e,getState:t})=>n=>async a=>{const i=n(a);if(a.type===Bt.ActivateThread){const{threadId:n,fileId:o,sharedLinkURL:r}=a.payload,s=t().threads[Lo(o,r)];if(null==s)return i;const l=s[n];if(l&&!l.read&&!l.readonly){const t=yi(o,r);e(Ia({arg:{id:l.id,stream:t}}))}}return i};a.injectInternalStyle("/static/js/file_viewer/components/highlight_action_bar_button.module.out-vflc93YdQ.css",(e=>"._highlight-action-bar-button_1ygwc_1{background-color:var(--color__elevated__background);pointer-events:all}"));const ed=({icon:e,label:t,...n})=>G.default.createElement(a.IconButton,{className:"_highlight-action-bar-button_1ygwc_1","aria-label":t,variant:"outline",...n},G.default.createElement(a.UIIcon,{src:e}));ed.displayName="HighlightActionBarButton";const td=G.default.lazy((async()=>{const{CommentsPluginPane:t}=await new Promise((function(t,n){e(["./c_comments2_plugin_plugin_pane"],t,n)}));return{default:t}}));td.displayName="LazyCommentsPluginPane";const nd=()=>G.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}},G.default.createElement(a.Spinner,{className:"comments-blade-loading-spinner",size:"standard"}));nd.displayName="LoadingIndicator";const ad=G.default.lazy((async()=>{const{CommentsMeatball:t}=await new Promise((function(t,n){e(["./c_comments2_plugin_meatball_menu"],t,n)}));return{default:t}}));ad.displayName="LazyCommentsMeatball";const id=G.default.lazy((async()=>{const{CommentMarkers:t}=await new Promise((function(t,n){e(["./c_comments2_plugin_comment_markers"],t,n)}));return{default:t}}));id.displayName="LazyCommentMarkers";const od=G.default.lazy((async()=>{const{CommentsPluginDrawer:t}=await new Promise((function(t,n){e(["./c_comments2_plugin_plugin_comments_drawer"],t,n)}));return{default:t}}));od.displayName="LazyCommentsDrawer";const rd=e=>G.default.createElement(G.default.Suspense,{fallback:null},G.default.createElement(ad,{...e}));rd.displayName="AsyncCommentsMeatball";const sd=e=>G.default.createElement(G.default.Suspense,{fallback:G.default.createElement(nd,null)},G.default.createElement(td,{...e}));sd.displayName="AsyncCommentsPluginPane";const ld=e=>G.default.createElement(G.default.Suspense,{fallback:null},G.default.createElement(id,{...e}));ld.displayName="AsyncCommentMarkers";const cd=e=>G.default.createElement(G.default.Suspense,{fallback:null},G.default.createElement(od,{...e}));cd.displayName="AsyncCommentsDrawer";const dd=e=>{let n,i;const o=u.useSetRightSidebarCallback(a.UserActionContext.SurfaceGesture);switch(e){case t.CommentSurface.FULL_PREVIEW:n=()=>o(a.COMMENTS_PLUGIN_ID),i=a.UserActionContext.Sidebar;break;case t.CommentSurface.QUICK_VIEW:n=()=>{},i=a.UserActionContext.QuickViewCommentPlugin;break;default:n=()=>{},i=a.UserActionContext.Sidebar}const r=u.useSeekCallback(),s=u.useSeekRelativeCallback(),l=u.useNavigateToPageCallback(i),c=u.usePauseCallback();return G.default.useMemo((()=>({openCommentStreamUI:n,seek:r,seekRelative:s,navigateToPage:l,pause:c})),[l,n,c,r,s])};a.injectInternalStyle("/static/metaserver/static/js/tagging/components/section/tags_section_preview.module.out-vfljzaE3H.css",(e=>"._previews-container_15gac_1{padding:0 0 24px}._redux-container_15gac_5{margin-top:20px}"));a.injectInternalStyle("/static/typescript/component_libraries/files_components/src/blades/info_blade/index.module.out-vfl8DHoZN.css",(e=>"._info-blade--metadata-row_8xw62_1{display:flex}._info-blade--metadata-title_8xw62_9{display:flex;width:92px}._info-blade--metadata-data_8xw62_14{flex:1 1 0;margin-left:var(--spacing__unit--2);min-width:0}._info-blade--basic-metadata-container_8xw62_21{display:flex;flex-direction:column}._info-blade--file-breadcrumb-link_8xw62_26>span{color:var(--dig-color__text__base)}._info-blade--pathbar_8xw62_30 a{color:var(--dig-color__text__subtle)}._info-blade--expand-fields-button_8xw62_34{margin-top:var(--spacing__base_unit)}"));const ud={infoBladeMetadataRow:"_info-blade--metadata-row_8xw62_1",infoBladeMetadataTitle:"_info-blade--metadata-title_8xw62_9",infoBladeMetadataData:"_info-blade--metadata-data_8xw62_14",infoBladeBasicMetadataContainer:"_info-blade--basic-metadata-container_8xw62_21",infoBladeFileBreadcrumbLink:"_info-blade--file-breadcrumb-link_8xw62_26",infoBladePathbar:"_info-blade--pathbar_8xw62_30",infoBladeExpandFieldsButton:"_info-blade--expand-fields-button_8xw62_34"};function _d(){const[e,t]=G.useState("top"),n=G.useCallback((e=>{t(e)}),[t]);return{placement:e,onChangePlacement:n}}const md=({title:e,data:t})=>{const{placement:n,onChangePlacement:i}=_d();return G.createElement("div",{className:ud.infoBladeMetadataRow,role:"row"},G.createElement("div",{className:ud.infoBladeMetadataTitle,role:"rowheader"},G.createElement(a.Text,{size:"small",variant:"paragraph",color:"faint",style:{overflow:"hidden"}},G.createElement(a.Truncate,{tooltipControlProps:{placement:n,openDelay:500,onChangePlacement:i,maxWidth:210}},e))),G.createElement("div",{className:ud.infoBladeMetadataData,role:"cell"},t))};md.displayName="InfoBladeMetadataRow";const fd=({title:e,data:t})=>{const{placement:n,onChangePlacement:i}=_d();return G.createElement(md,{title:e,data:G.createElement(a.Text,{variant:"paragraph",size:"small"},G.createElement(a.Truncate,{tooltipControlProps:{placement:n,openDelay:500,auto:!0,maxWidth:210,onChangePlacement:i},lines:3},t))})};fd.displayName="InfoBladeTextMetadataRow";const pd=1e3,gd=60*pd,vd=60*gd;function hd(e,t){if(!e)return;if(isNaN(e)||e<=0)return;const n=Math.floor(e/vd),a=Math.floor(e%vd/gd),i=Math.floor(e%gd/pd),o=Math.floor(e%pd),r=0==n&&0==a&&i<15,s=n>0||a>=10,l={hours:t.formatNumber(n,{minimumIntegerDigits:2,maximumFractionDigits:0}),minutes:t.formatNumber(a,{minimumIntegerDigits:2,maximumFractionDigits:0}),seconds:t.formatNumber(i,{minimumIntegerDigits:2,maximumFractionDigits:0}),millis:String(o).padStart(3,"0")};return r?t.formatMessage({id:"tgiBzN",defaultMessage:"{minutes}:{seconds}.{millis}"},l):s?t.formatMessage({id:"Y2LnVt",defaultMessage:"{hours}:{minutes}:{seconds}"},l):t.formatMessage({id:"eHQbup",defaultMessage:"{minutes}:{seconds}"},l)}function yd(e,t){if(e.audio_freq){if(e.audio_chan_layout){const n=+e.audio_chan_layout;if(!isNaN(n))return t.formatMessage({id:"ZFfsQG",defaultMessage:"{audio_freq} kHz {audio_chan_layout}"},{audio_freq:t.formatNumber(e.audio_freq/1e3),audio_chan_layout:t.formatNumber(n/100)})}return t.formatMessage({id:"o1Wy7v",defaultMessage:"{audio_freq} kHz"},{audio_freq:t.formatNumber(e.audio_freq/1e3)})}}const bd=1e3,Ed=60*bd,wd=60*Ed,Sd=24*wd,Cd=7*Sd,Md=30*Sd,xd=365*Sd;function Ad(e,t){if(e&&!(isNaN(e)||e<=0))return e<Ed?t.formatMessage({id:"XJTRCn",defaultMessage:"{value, plural, one{# second} other{# seconds}}"},{value:Math.round(e/bd)}):e<wd?t.formatMessage({id:"hYCfnh",defaultMessage:"{value, plural, one{# minute} other{# minutes}}"},{value:Math.round(e/Ed)}):e<Sd?t.formatMessage({id:"5vUoeT",defaultMessage:"{value, plural, one{# hour} other{# hours}}"},{value:Math.round(e/wd)}):e<Cd?t.formatMessage({id:"VUIAfM",defaultMessage:"{value, plural, one{# day} other{# days}}"},{value:Math.round(e/Sd)}):e<Md?t.formatMessage({id:"0wIJlM",defaultMessage:"{value, plural, one{# week} other{# weeks}}"},{value:Math.round(e/Cd)}):e<xd?t.formatMessage({id:"MPX3Ow",defaultMessage:"{value, plural, one{# month} other{# months}}"},{value:Math.round(e/Md)}):t.formatMessage({id:"toXz6N",defaultMessage:"{value, plural, one{# year} other{# years}}"},{value:Math.round(e/xd)})}var Id,Td,kd,Nd,Rd,Dd;!function(e){e[e.Unknown=0]="Unknown",e[e.Average=1]="Average",e[e.CenterWeightedAverage=2]="CenterWeightedAverage",e[e.Spot=3]="Spot",e[e.MultiSpot=4]="MultiSpot",e[e.MultiSegment=5]="MultiSegment",e[e.Partial=6]="Partial",e[e.Other=7]="Other"}(Id||(Id={})),function(e){e[e.Unknown=0]="Unknown",e[e.NoFlash=1]="NoFlash",e[e.Fired=2]="Fired",e[e.FiredReturnNotDetected=3]="FiredReturnNotDetected",e[e.FiredReturnDetected=4]="FiredReturnDetected",e[e.OnDidNotFire=5]="OnDidNotFire",e[e.OnFired=6]="OnFired",e[e.OnReturnNotDetected=7]="OnReturnNotDetected",e[e.OnReturnDetected=8]="OnReturnDetected",e[e.OffDidNotFire=9]="OffDidNotFire",e[e.OffDidNotFireReturnNotDetected=10]="OffDidNotFireReturnNotDetected",e[e.AutoDidNotFire=11]="AutoDidNotFire",e[e.AutoFired=12]="AutoFired",e[e.AutoFiredReturnNotDetected=13]="AutoFiredReturnNotDetected",e[e.AutoFiredReturnDetected=14]="AutoFiredReturnDetected",e[e.NoFlashFunction=15]="NoFlashFunction",e[e.OffNoFlashFunction=16]="OffNoFlashFunction",e[e.FiredRedEyeReduction=17]="FiredRedEyeReduction",e[e.FiredRedEyeReductionReturnNotDetected=18]="FiredRedEyeReductionReturnNotDetected",e[e.FiredRedEyeReductionReturnDetected=19]="FiredRedEyeReductionReturnDetected",e[e.OnRedEyeReduction=20]="OnRedEyeReduction",e[e.OnRedEyeReductionReturnNotDetected=21]="OnRedEyeReductionReturnNotDetected",e[e.OnRedEyeReductionReturnDetected=22]="OnRedEyeReductionReturnDetected",e[e.OffRedEyeReduction=23]="OffRedEyeReduction",e[e.AutoDidNotFireRedEyeReduction=24]="AutoDidNotFireRedEyeReduction",e[e.AutoFiredRedEyeReduction=25]="AutoFiredRedEyeReduction",e[e.AutoFiredRedEyeReductionReturnNotDetected=26]="AutoFiredRedEyeReductionReturnNotDetected",e[e.AutoFiredRedEyeReductionReturnDetected=27]="AutoFiredRedEyeReductionReturnDetected",e[e.Other=28]="Other"}(Td||(Td={})),function(e){e[e.Unknown=0]="Unknown",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual",e[e.Other=3]="Other"}(kd||(kd={})),function(e){e[e.Unknown=0]="Unknown",e[e.SRgb=1]="SRgb",e[e.AdobeRgb=2]="AdobeRgb",e[e.WideGamutRgb=3]="WideGamutRgb",e[e.IccProfile=4]="IccProfile",e[e.Uncalibrated=5]="Uncalibrated",e[e.Other=6]="Other"}(Nd||(Nd={})),function(e){e[e.UnknownOrientation=0]="UnknownOrientation",e[e.Horizontal=1]="Horizontal",e[e.MirrorHorizontal=2]="MirrorHorizontal",e[e.Rotate180=3]="Rotate180",e[e.MirrorVertical=4]="MirrorVertical",e[e.MirrorHorizontalRotate270Cw=5]="MirrorHorizontalRotate270Cw",e[e.Rotate90Cw=6]="Rotate90Cw",e[e.MirrorHorizontalRotate90Cw=7]="MirrorHorizontalRotate90Cw",e[e.Rotate270Cw=8]="Rotate270Cw"}(Rd||(Rd={})),function(e){e[e.UnknownResolutionUnit=0]="UnknownResolutionUnit",e[e.Inch=1]="Inch",e[e.CM=2]="CM"}(Dd||(Dd={}));const Ld=e=>({[kd.Unknown]:e.formatMessage({id:"vHgZs0",defaultMessage:"Unknown"}),[kd.Auto]:e.formatMessage({id:"xhS6fE",defaultMessage:"Auto"}),[kd.Manual]:e.formatMessage({id:"ToNv3C",defaultMessage:"Manual"}),[kd.Other]:e.formatMessage({id:"bmpvII",defaultMessage:"Other"})}),Od=e=>({[Nd.Unknown]:e.formatMessage({id:"vHgZs0",defaultMessage:"Unknown"}),[Nd.SRgb]:e.formatMessage({id:"a0wUgp",defaultMessage:"sRGB"}),[Nd.AdobeRgb]:e.formatMessage({id:"B28Q5y",defaultMessage:"Adobe RGB"}),[Nd.WideGamutRgb]:e.formatMessage({id:"Kh3t+h",defaultMessage:"Wide Gamut RGB"}),[Nd.IccProfile]:e.formatMessage({id:"h4Q5SZ",defaultMessage:"ICC Profile"}),[Nd.Uncalibrated]:e.formatMessage({id:"/7omh+",defaultMessage:"Uncalibrated"}),[Nd.Other]:e.formatMessage({id:"bmpvII",defaultMessage:"Other"})}),Fd=e=>({[Td.Unknown]:e.formatMessage({id:"vHgZs0",defaultMessage:"Unknown"}),[Td.NoFlash]:e.formatMessage({id:"CMxZBg",defaultMessage:"No flash"}),[Td.Fired]:e.formatMessage({id:"GxXK+Z",defaultMessage:"Fired"}),[Td.FiredReturnNotDetected]:e.formatMessage({id:"1aQhV4",defaultMessage:"Fired, return not detected"}),[Td.FiredReturnDetected]:e.formatMessage({id:"mxTse0",defaultMessage:"Fired, return detected"}),[Td.OnDidNotFire]:e.formatMessage({id:"VAQlMV",defaultMessage:"On, did not fire"}),[Td.OnFired]:e.formatMessage({id:"IfNe4i",defaultMessage:"On, fired"}),[Td.OnReturnNotDetected]:e.formatMessage({id:"xb3nZ7",defaultMessage:"On, return not detected"}),[Td.OnReturnDetected]:e.formatMessage({id:"GIkKlb",defaultMessage:"On, return detected"}),[Td.OffDidNotFire]:e.formatMessage({id:"hvSCzd",defaultMessage:"Off, did not fire"}),[Td.OffDidNotFireReturnNotDetected]:e.formatMessage({id:"O8+FbV",defaultMessage:"Off, did not fire, return not detected"}),[Td.AutoDidNotFire]:e.formatMessage({id:"KSJ3BI",defaultMessage:"Auto, did not fire"}),[Td.AutoFired]:e.formatMessage({id:"F0TcTd",defaultMessage:"Auto, fired"}),[Td.AutoFiredReturnNotDetected]:e.formatMessage({id:"rLeBiG",defaultMessage:"Auto, fired, return not detected"}),[Td.AutoFiredReturnDetected]:e.formatMessage({id:"qJftjl",defaultMessage:"Auto, fired, return detected"}),[Td.NoFlashFunction]:e.formatMessage({id:"jdWze8",defaultMessage:"No flash function"}),[Td.OffNoFlashFunction]:e.formatMessage({id:"THu+Iw",defaultMessage:"Off, no flash function"}),[Td.FiredRedEyeReduction]:e.formatMessage({id:"B0ZoP1",defaultMessage:"Fired, red-eye reduction"}),[Td.FiredRedEyeReductionReturnNotDetected]:e.formatMessage({id:"XrGwwy",defaultMessage:"Fired, red-eye reduction, return not detected"}),[Td.FiredRedEyeReductionReturnDetected]:e.formatMessage({id:"piA/mD",defaultMessage:"Fired, red-eye reduction, return detected"}),[Td.OnRedEyeReduction]:e.formatMessage({id:"VgJqkZ",defaultMessage:"On, red-eye reduction"}),[Td.OnRedEyeReductionReturnNotDetected]:e.formatMessage({id:"+TI9qg",defaultMessage:"On, red-eye reduction, return not detected"}),[Td.OnRedEyeReductionReturnDetected]:e.formatMessage({id:"j8jQAQ",defaultMessage:"On, red-eye reduction, return detected"}),[Td.OffRedEyeReduction]:e.formatMessage({id:"QLLQth",defaultMessage:"Off, red-eye reduction"}),[Td.AutoDidNotFireRedEyeReduction]:e.formatMessage({id:"AhpZjQ",defaultMessage:"Auto, did not fire, red-eye reduction"}),[Td.AutoFiredRedEyeReduction]:e.formatMessage({id:"Qv2qrm",defaultMessage:"Auto, fired, red-eye reduction"}),[Td.AutoFiredRedEyeReductionReturnNotDetected]:e.formatMessage({id:"gTPkua",defaultMessage:"Auto, fired, red-eye reduction, return not detected"}),[Td.AutoFiredRedEyeReductionReturnDetected]:e.formatMessage({id:"4Ty2Bk",defaultMessage:"Auto, fired, red-eye reduction, return detected"}),[Td.Other]:e.formatMessage({id:"bmpvII",defaultMessage:"Other"})}),Pd=e=>({[Id.Unknown]:e.formatMessage({id:"vHgZs0",defaultMessage:"Unknown"}),[Id.Average]:e.formatMessage({id:"FfhsBR",defaultMessage:"Average"}),[Id.CenterWeightedAverage]:e.formatMessage({id:"FgYWQc",defaultMessage:"Center-weighted average"}),[Id.Spot]:e.formatMessage({id:"xcW6Wd",defaultMessage:"Spot"}),[Id.MultiSpot]:e.formatMessage({id:"RGJ4oA",defaultMessage:"Multi-spot"}),[Id.MultiSegment]:e.formatMessage({id:"iExd56",defaultMessage:"Multi-segment"}),[Id.Partial]:e.formatMessage({id:"Zd4uKj",defaultMessage:"Partial"}),[Id.Other]:e.formatMessage({id:"bmpvII",defaultMessage:"Other"})}),Ud=e=>({[Rd.Horizontal]:e.formatMessage({id:"7v6FH2",defaultMessage:"Horizontal (normal)"}),[Rd.MirrorHorizontal]:e.formatMessage({id:"s1wRj/",defaultMessage:"Mirror horizontal"}),[Rd.Rotate180]:e.formatMessage({id:"YxttK0",defaultMessage:"Rotate 180"}),[Rd.MirrorVertical]:e.formatMessage({id:"ykfmPa",defaultMessage:"Mirror vertical"}),[Rd.MirrorHorizontalRotate270Cw]:e.formatMessage({id:"GSAufA",defaultMessage:"Mirror horizontal and rotate 270 CW"}),[Rd.Rotate90Cw]:e.formatMessage({id:"RUtOD3",defaultMessage:"Rotate 90 CW"}),[Rd.MirrorHorizontalRotate90Cw]:e.formatMessage({id:"PzCdEi",defaultMessage:"Mirror horizontal and rotate 90 CW"}),[Rd.Rotate270Cw]:e.formatMessage({id:"g6rS8+",defaultMessage:"Rotate 270 CW"})}),Bd=(e,t,n)=>{if(void 0!==e&&void 0!==t)return n.formatMessage({id:"P63UMO",defaultMessage:"{width} x {height}"},{width:e,height:t})},Vd=(e,t,n)=>{if(void 0!==e&&void 0!==t)return n.formatMessage({id:"6A4kNh",defaultMessage:"{width} x {height}"},{width:e,height:t})},zd=(e,t)=>{if(!e)return;let n=e;if(-1===e.indexOf("/")){const a=parseFloat(e);if(isNaN(a))return;n=a<1?t.formatNumber(a,{minimumFractionDigits:2,maximumFractionDigits:2}):t.formatNumber(a,{minimumFractionDigits:1,maximumFractionDigits:1})}return t.formatMessage({id:"ZbTwYS",defaultMessage:"{exposure_time} s"},{exposure_time:n})},qd=(e,t)=>{if(e){const n=t.formatNumber(e,{minimumFractionDigits:1,maximumFractionDigits:1});return t.formatMessage({id:"WOwRDU",defaultMessage:"f/{aperture}"},{aperture:n})}},Hd=(e,t)=>{if(!e)return;const n=parseFloat(e);if(isNaN(n))return;const a=t.formatNumber(n,{minimumFractionDigits:1,maximumFractionDigits:1});return t.formatMessage({id:"BTHLkw",defaultMessage:"{focal_length} mm"},{focal_length:a})},Wd=(e,t)=>{if(e){const n=new Date(e);return t.formatDate(n,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",timeZone:"UTC",hourCycle:"h12"})}};const Kd=({metadata:e,onShowMore:t})=>{const[i,o]=n.useState(!1),r=E.useIntl(),s=G.default.useMemo((()=>jd(e,r).filter((e=>!!e.value))),[e,r]),l=G.default.useMemo((()=>i?s:s.slice(0,8)),[s,i]),c=n.useCallback((()=>{null==t||t(!i),o(!i)}),[i,t]),d=r.formatMessage({id:"+kc9n+",defaultMessage:"Show all"}),u=r.formatMessage({id:"5tvWhA",defaultMessage:"Hide"}),_=s.length>8;return G.default.createElement("div",null,l.map((e=>G.default.createElement(fd,{key:`content-metadata-${e.name}`,title:e.name,data:e.value}))),_&&G.default.createElement(a.Button,{className:ud.infoBladeExpandFieldsButton,variant:"transparent",size:"small",onClick:c,fullWidth:!1},G.default.createElement(a.Text,{className:"expand-fields-button--context-text",size:"small",isBold:!0},i?u:d)))};Kd.displayName="FileContentMetadataUI";const jd=(e,t)=>{switch(e[".tag"]){case"image":return function(e,t){const n=(e=>({captureDate:e.formatMessage({id:"54B7+u",defaultMessage:"Date taken"}),createDate:e.formatMessage({id:"+OuHm4",defaultMessage:"Date created"}),credits:e.formatMessage({id:"WU02lX",defaultMessage:"Credits"}),dimensions:e.formatMessage({id:"5fgW0C",defaultMessage:"Dimensions"}),resolution:e.formatMessage({id:"wscUVd",defaultMessage:"Dots per inch"}),resolution_in_cm:e.formatMessage({id:"P23mCt",defaultMessage:"Dots per CM"}),colorSpace:e.formatMessage({id:"SHDDoj",defaultMessage:"Color profile"}),deviceMake:e.formatMessage({id:"GkqUJK",defaultMessage:"Camera brand"}),deviceModel:e.formatMessage({id:"EPx9jS",defaultMessage:"Camera model"}),lensModel:e.formatMessage({id:"8+mL18",defaultMessage:"Lens"}),apertureValue:e.formatMessage({id:"Hv/B/8",defaultMessage:"Aperture"}),exposureTime:e.formatMessage({id:"5JRhFM",defaultMessage:"Shutter speed"}),focalLength:e.formatMessage({id:"hKz/tt",defaultMessage:"Focal length"}),isoSpeed:e.formatMessage({id:"c7J2CV",defaultMessage:"ISO"}),flash:e.formatMessage({id:"WIBZO6",defaultMessage:"Flash"}),meteringMode:e.formatMessage({id:"WbVH1z",defaultMessage:"Metering"}),whiteBalance:e.formatMessage({id:"USKkbD",defaultMessage:"White balance"}),copyright:e.formatMessage({id:"qQhzrN",defaultMessage:"Copyright"}),keywords:e.formatMessage({id:"jNkBVA",defaultMessage:"Keywords"}),title:e.formatMessage({id:"YyhVRN",defaultMessage:"Title"}),caption:e.formatMessage({id:"1vHwyl",defaultMessage:"Caption"}),creator:e.formatMessage({id:"Z5ApwP",defaultMessage:"Creator"}),artist:e.formatMessage({id:"2mALcS",defaultMessage:"Artist"}),description:e.formatMessage({id:"6hvXWm",defaultMessage:"Description"}),headline:e.formatMessage({id:"1Y0IbU",defaultMessage:"Headline"}),licensorUrl:e.formatMessage({id:"j6C1Hk",defaultMessage:"Licensor URL"}),orientation:e.formatMessage({id:"oDAo/S",defaultMessage:"Orientation"}),usageRights:e.formatMessage({id:"VUwfxH",defaultMessage:"Usage rights"}),category:e.formatMessage({id:"KP48oN",defaultMessage:"PS category"}),userComments:e.formatMessage({id:"tcqDgZ",defaultMessage:"User comments"})}))(t);return[{name:n.description,value:e.description},{name:n.copyright,value:e.copyright},{name:n.keywords,value:e.keywords},{name:n.captureDate,value:Wd(e.date_time_original,t)},{name:n.createDate,value:Wd(e.create_date,t)},{name:n.dimensions,value:Bd(e.image_width,e.image_height,t)},{name:n.resolution,value:e.resolution_unit!==Dd.CM?Vd(e.x_resolution,e.y_resolution,t):void 0},{name:n.resolution_in_cm,value:e.resolution_unit===Dd.CM?Vd(e.x_resolution,e.y_resolution,t):void 0},{name:n.colorSpace,value:void 0!==e.colorspace?Od(t)[e.colorspace]:void 0},{name:n.orientation,value:void 0!==e.orientation?Ud(t)[e.orientation]:void 0},{name:n.title,value:e.title},{name:n.caption,value:e.caption},{name:n.creator,value:e.creator},{name:n.artist,value:e.credit},{name:n.headline,value:e.headline},{name:n.credits,value:e.credits},{name:n.licensorUrl,value:e.licensor_url},{name:n.usageRights,value:e.rights_usage_terms},{name:n.category,value:e.category},{name:n.userComments,value:e.user_comments},{name:n.deviceMake,value:e.camera_make},{name:n.deviceModel,value:e.camera_model},{name:n.lensModel,value:e.lens_model},{name:n.focalLength,value:Hd(e.focal_length,t)},{name:n.exposureTime,value:zd(e.exposure_time,t)},{name:n.apertureValue,value:qd(e.aperture_value,t)},{name:n.isoSpeed,value:void 0!==e.iso_speed?String(e.iso_speed):void 0},{name:n.meteringMode,value:void 0!==e.metering_mode?Pd(t)[e.metering_mode]:void 0},{name:n.flash,value:void 0!==e.flash?Fd(t)[e.flash]:void 0},{name:n.whiteBalance,value:void 0!==e.white_balance?Ld(t)[e.white_balance]:void 0}].filter((e=>!!e.value))}(e,t);case"ms_office":return function(e,t){return[{name:t.formatMessage({id:"Ed/RQ2",defaultMessage:"Title"}),value:e.title},{name:t.formatMessage({id:"TpJn8o",defaultMessage:"Owner"}),value:e.creator},{name:t.formatMessage({id:"WRzvI1",defaultMessage:"Company"}),value:e.company},{name:t.formatMessage({id:"NL8ygk",defaultMessage:"Subject"}),value:e.subject},{name:t.formatMessage({id:"a8+LVV",defaultMessage:"Keywords"}),value:e.keywords},{name:t.formatMessage({id:"yGgaIu",defaultMessage:"Description"}),value:e.description},{name:t.formatMessage({id:"BLmrgy",defaultMessage:"Total edit time"}),value:e.total_edit_time_minutes?Ad(60*e.total_edit_time_minutes*1e3,t):void 0},{name:t.formatMessage({id:"oHZfxP",defaultMessage:"Revision number"}),value:e.revision_number},{name:t.formatMessage({id:"EF/17d",defaultMessage:"Pages"}),value:e.pages?t.formatNumber(e.pages,{maximumFractionDigits:0}):void 0},{name:t.formatMessage({id:"RLrbhp",defaultMessage:"Words"}),value:e.words?t.formatNumber(e.words,{maximumFractionDigits:0}):void 0},{name:t.formatMessage({id:"2dpvY4",defaultMessage:"Slides"}),value:e.slides?t.formatNumber(e.slides,{maximumFractionDigits:0}):void 0}].filter((e=>!!e.value))}(e,t);case"pdf":return function(e,t){return[{name:t.formatMessage({id:"EF/17d",defaultMessage:"Pages"}),value:e.pages},{name:t.formatMessage({id:"MeqvVX",defaultMessage:"Dimensions"}),value:e.width&&e.height?t.formatMessage({id:"JEE1p9",defaultMessage:"{width} x {height}"},{width:t.formatNumber(e.width),height:t.formatNumber(e.height)}):void 0}].filter((e=>!!e.value))}(e,t);case"video":return function(e,t){return[{name:t.formatMessage({id:"e4DGmJ",defaultMessage:"Date created"}),value:e.capture_date?t.formatTime(new Date(e.capture_date),{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric"}):void 0},{name:t.formatMessage({id:"8I3zJj",defaultMessage:"Capturing device"}),value:e.device},{name:t.formatMessage({id:"R+6yXm",defaultMessage:"Resolution"}),value:`${e.resolution_width}x${e.resolution_height}`},{name:t.formatMessage({id:"fnTy98",defaultMessage:"Aspect ratio"}),value:e.aspect_ratio},{name:t.formatMessage({id:"A4boBS",defaultMessage:"Duration"}),value:e.duration_precise?hd(e.duration_precise*pd,t):void 0},{name:t.formatMessage({id:"B3oDhY",defaultMessage:"Frame rate"}),value:`${e.frame_rate} fps`},{name:t.formatMessage({id:"NZhZ/H",defaultMessage:"Color space"}),value:e.color_space},{name:t.formatMessage({id:"Dl8F3e",defaultMessage:"Bit rate"}),value:e.bit_rate?t.formatMessage({id:"/xb44b",defaultMessage:"{bit_rate} kb/s"},{bit_rate:Math.floor(e.bit_rate/1e3)}):void 0},{name:t.formatMessage({id:"C1kd1L",defaultMessage:"Audio"}),value:yd(e,t)},{name:t.formatMessage({id:"yq3RyE",defaultMessage:"Codec"}),value:e.codec}]}(e,t);case"audio":return function(e,t){return[{name:t.formatMessage({id:"yq3RyE",defaultMessage:"Codec"}),value:e.codec},{name:t.formatMessage({id:"akP0tz",defaultMessage:"Sampling rate"}),value:Number(e.sampling_rate)/1e3+" kHz"},{name:t.formatMessage({id:"A4boBS",defaultMessage:"Duration"}),value:e.duration_precise?hd(e.duration_precise*pd,t):void 0},{name:t.formatMessage({id:"0Fq1H6",defaultMessage:"Channels"}),value:e.channels},{name:t.formatMessage({id:"Dl8F3e",defaultMessage:"Bit rate"}),value:String(Math.floor(e.bit_rate/1e3))+" kb/s"}]}(e,t);default:return[]}},Gd=G.default.memo((({uploadInfo:e})=>{const t=E.useIntl(),n=[{title:t.formatMessage({id:"bD4kqG",defaultMessage:"Uploaded by"}),data:e.display_name},{title:t.formatMessage({id:"KMbzWs",defaultMessage:"Date uploaded"}),data:t.formatTime(new Date(e.uploaded),{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric"})}];return G.default.createElement(G.default.Fragment,null,n.map((e=>e.data&&G.default.createElement(fd,{title:e.title,data:e.data,key:e.title}))))}));Gd.displayName="UploadInfoMetadataUI";const Qd="files:get_upload_info";t.AllSortTypes=At,t.CommentsContextProvider=Do,t.ConfirmationModal=Oe,t.DefaultSortType=It,t.DocumentSortType=kt,t.FileContentMetadataUI=Kd,t.INTERSECTION_DELTA=en,t.InfoBladeMetadataRow=md,t.InfoBladeTextMetadataRow=fd,t.LOGGED_OUT_USER_ID=Lt,t.PreviewZoomControl=Be,t.Sidebar=we,t.TimeCodedSortType=Tt,t.TitleBarFileBreadcrumb=ke,t.UploadInfoMetadataUI=Gd,t.activateThread=Vt,t.allowAllFiles=e=>e,t.alwaysShow=ne,t.areCommentsEnabled=(e,t)=>{var n;const a=e.permissions[t],i=e.enableCommentStatus[t];return Boolean(null!==(n=null==i?void 0:i.commentsEnabled)&&void 0!==n?n:null==a?void 0:a.can_see_comment_editor)},t.boltSubscribe=function(e){return{type:Bt.BoltSubscribe,payload:e}},t.boltUnsubscribe=function(e){return{type:Bt.BoltUnsubscribe,payload:e}},t.canPrint=function(e){return!(e&&e.canPrintRoles&&0===e.canPrintRoles.length)},t.canShowWatermark=e=>{if(a.isBrowseFile(e)&&"read_only"in e&&!e.read_only&&a.isSupportedPreviewType(e.ext)&&!a.isEncryptedFile(e))return e},t.cancelAnnotating=Ht,t.classes={previewsContainer:"_previews-container_15gac_1",reduxContainer:"_redux-container_15gac_5"},t.classes$1=ud,t.clickHandler=Ne,t.commentsPaneBlade="_comments-pane-blade_1304m_5",t.confirmDraftAnnotation=qt,t.contactToIMentionUser=function(e){return{id:e.dbx_account_id,email:e.email,name:{display:e.name,initials:a.getInitials(e.name),public:a.getShortName(e.name)},photoUrl:e.photo_url||e.avatar_url}},t.createCommentFileIdentifier=Lo,t.createStreamFromFileOrSharedLink=yi,t.currentUserPidAtom=Ro,t.dbxUserToIUser=function(e){return{id:e.account_id,userId:e.id,name:{display:e.display_name,initials:a.getInitials(e.display_name),public:a.getShortName(e.display_name)},photoUrl:e.photo_circle_url}},t.deactivateAllThreads=zt,t.disableCommentingAction=fa,t.disabledAnnotationsShowMore="_disabled-annotations-show-more_1304m_9",t.downloadThreadsAsTxt=(e,t)=>{const n=(e=>e.map((e=>{if(0===e.comments.length)return"";const t=e.annotation?JSON.stringify(e.annotation,null,2):"No annotation",n=e.comments[0],a=n.author?n.author.name.display:"Unknown";let i=`\nTimestamp: ${e.timestamp.toISOString()}\nAnnotation: ${t}\n\nHead Comment:\nTimestamp: ${n.timestamp.toISOString()}\nAuthor: ${a}\nContent: ${n.content.text}\n`;const o=e.comments.slice(1);return o.length>0&&(i+="\nReplies:\n",i+=o.map((e=>{const t=e.author?e.author.name.display:"Unknown";return`\n  - Timestamp: ${e.timestamp.toISOString()}\n    Author: ${t}\n    Content: ${e.content.text}`})).join("\n\n")),i+"\n========================\n"})).join("\n"))(fe(e)),a=new Blob([n],{type:"text/plain"}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=t?t+" Dropbox File Comments.txt":"Dropbox File Comments.txt",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)},t.enableCommentingAction=ha,t.fileActionCondition=le,t.filterDesktopUser=e=>l.is_mobile_or_tablet()?void 0:{user:e},t.filterLoggedInUser=ae,t.filterPreviewTypeIn=e=>ie(e),t.filterSurfaceIn=oe,t.findCommentThread=eo,t.focusEditor=function(e){return{type:Bt.FocusEditor,payload:{fileViewerId:e}}},t.focusedThreadIdAtom=vo,t.getActionArgs=function(e,t,n,a,i,o){return{file:a,entryPoint:"file_preview_workflows_tab",logContext:"preview_workflows_button",logUserAction:t,user:n,uxaLogPrefix:"send_signatures_on_workflow",setActiveEditorCallback:e,pageCount:i,previewSurface:o}},t.getActionCondition=te,t.getActiveThreadID=io,t.getBoltInfo=(e,t)=>e.boltInfo.fileIdentifierToBoltMap[t],t.getDocSidebarIsCollapsed=function(e){var t;try{return null===(t=a.UserLocalStorage.get(e,Ze))||void 0===t||t}catch(e){return!0}},t.getDoesCurrentPathStartWithSclFo=()=>window.location.pathname.startsWith("/scl/fo"),t.getDraftAnnotation=lo,t.getFileIdentifier=(e,t,n)=>t in e.boltInfo.fileIdentifierToBoltMap?t:null!=n?n:t,t.getFinderPromptIsHidden=function(e){var t;try{return null!==(t=a.UserLocalStorage.get(e,tt))&&void 0!==t&&t}catch(e){return!1}},t.getLineNumbersAreHidden=function(e){var t;try{return null!==(t=a.UserLocalStorage.get(e,et))&&void 0!==t&&t}catch(e){return!1}},t.getLinkWarningIsHidden=function(e,t){var n;try{return null!==(n=a.UserLocalStorage.get(e,Je+t))&&void 0!==n&&n}catch(e){return!1}},t.getMentionsSearchResult=e=>e.mentionsSearchResult,t.getMutedState=function(e){var t;try{return null!==(t=a.UserLocalStorage.get(e,Ye))&&void 0!==t&&t}catch(e){return!1}},t.getOnUngatedAuthSuccess=X,t.getSharedLinkDesktopModalIsHidden=function(e){var t;try{return null!==(t=a.UserLocalStorage.get(e,nt))&&void 0!==t&&t}catch(e){return!1}},t.getSidebarState=function(e){var t,n;try{const i=null!==(t=a.UserLocalStorage.get(e,Ge))&&void 0!==t?t:void 0,o=null!==(n=a.UserLocalStorage.get(e,Qe))&&void 0!==n?n:void 0;if(!i&&!o)return;return{left:i,right:o}}catch(e){return}},t.getStatus=(e,t)=>e.status[t],t.getStickerMetadata=e=>{const t=e.metadata.findIndex((e=>"sticker"===e.type));return-1===t?void 0:e.metadata[t]},t.getStreamSettings=(e,t,n)=>{const a=t in e.boltInfo.fileIdentifierToBoltMap?t:null!=n?n:t;return{...e.status[a]===bi.FullyEnabled?no:ao,canShowEditorMeatball:!1}},t.getThirdPartySource=(e,t)=>e.thirdPartySource[t],t.getThreads=oo,t.getToolbarHandlerWithPluginActivation=()=>e=>Ne(e.handler,e.keyboardBinding),t.getType=e=>"type"in e?e.type:a.FileTypes.FILE,t.getUiIsHidden=function(e){var t;try{return null!==(t=a.UserLocalStorage.get(e,Xe))&&void 0!==t&&t}catch(e){return!1}},t.getVolumeState=function(e){var t;try{return parseFloat(null!==(t=a.UserLocalStorage.get(e,$e))&&void 0!==t?t:1)}catch(e){return 1}},t.hasMention=e=>String(-1!==e.metadata.findIndex((e=>"mention"===e.type))),t.hasSticker=e=>String(-1!==e.metadata.findIndex((e=>"sticker"===e.type))),t.hoverActionFocusedCommentIdAtom=fo,t.hoveredThreadIdAtom=go,t.imageEditingActionCondition=Re,t.isActiveThread=ro,t.isAnnotatingAccessible=function(e){return"annotating-ax"===e},t.isCloudDoc=e=>"is_cloud_doc"in e&&e.is_cloud_doc,t.isDocumentAnnotation=de,t.isEditingAnnotation=pe,t.isEditingTimestampAnnotation=e=>"commenting"===e||"annotating-ax"===e,t.isFileActionAllowedFile=re,t.isLiveFile=Q,t.isPageLevelAnnotation=me,t.isPnmLinkNodeSelected=Z,t.isPnmSuppressMoveSelected=e=>{var t;return"per_node_metadata"in e&&!!(null===(t=e.per_node_metadata)||void 0===t?void 0:t.suppress_move)},t.isPnmSuppressShareSelected=e=>{var t;return"per_node_metadata"in e&&!!(null===(t=e.per_node_metadata)||void 0===t?void 0:t.suppress_share)},t.isStarringEnabled=function(e){return Q(e)&&!a.isSharedFile(e)},t.isSupportedFile=e=>e&&!a.isEncryptedFile(e)&&R.HELLOSIGN_SUPPORTED_EXTENSIONS.includes("."+a.getExtension(e)),t.isSupportedPreviewType=function(e){const t=a.resolvePreviewTypeFromExtension(a.getFileExtension(e));return ve(t)},t.isThreadWithDocumentAnnotation=function(e){const{annotation:t}=e;return!!t&&de(t)&&t.regions.length>0},t.isThreadWithTimecodeAnnotation=_e,t.isTimecodeAnnotation=ue,t.isUserSubscribed=(e,t)=>{var n;const a=e.permissions[t],i=e.subscriptionStatus[t];return Boolean(null!==(n=null==i?void 0:i.isSubscribed)&&void 0!==n?n:null==a?void 0:a.is_subscribed)},t.logCommentEvent=e=>{(e=>{const{event:n,extra:i}=e,o=(null==i?void 0:i.fileName)?a.getExtension({filename:i.fileName}):void 0,r=o?a.getFileTypeFromString(o):void 0,s=P.getPapPreviewType(null==i?void 0:i.previewType),l="true"===(null==i?void 0:i.addedFromExistingReaction);switch(n){case t.CommentsEventName.SELECT_COMMENT_MARK:a.UDCL.logEvent(St({actionSurface:"previews",actionElement:"preview_sidebar",commentAction:"select_comment_mark",commentsAnnotationType:i?i.commentsAnnotationType:void 0}));break;case t.CommentsEventName.ADD_COMMENT_START:"true"===(null==i?void 0:i.hasDraftAnnotation)?a.UDCL.logEvent(vt({actionSurface:Rt,eventState:"start",commentsAnnotationType:i.commentsAnnotationType,isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0})):"true"===(null==i?void 0:i.isTimestampAnnotation)?a.UDCL.logEvent(yt({actionSurface:Rt,eventState:"start",isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0})):a.UDCL.logEvent(pt({actionSurface:Rt,eventState:"start",isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0}));break;case t.CommentsEventName.ADD_COMMENT_CANCEL:"true"===(null==i?void 0:i.hasDraftAnnotation)?a.UDCL.logEvent(vt({actionSurface:Rt,eventState:"canceled",commentsAnnotationType:i.commentsAnnotationType,isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0})):"true"===(null==i?void 0:i.isTimestampAnnotation)?a.UDCL.logEvent(yt({actionSurface:Rt,eventState:"canceled",isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0})):a.UDCL.logEvent(pt({actionSurface:Rt,eventState:"canceled",isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0}));break;case t.CommentsEventName.ADD_COMMENT:"true"===(null==i?void 0:i.hasDraftAnnotation)?a.UDCL.logEvent(vt({actionSurface:Rt,eventState:"success",hasSticker:"true"===(null==i?void 0:i.isSticker),hasTag:"true"===(null==i?void 0:i.hasMention),commentsAnnotationType:i.commentsAnnotationType,isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0})):"true"===(null==i?void 0:i.isTimestampAnnotation)?a.UDCL.logEvent(yt({actionSurface:Rt,eventState:"success",hasSticker:"true"===i.isSticker,hasTag:"true"===i.hasMention,isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0})):(a.UDCL.logEvent(pt({actionSurface:Rt,eventState:"success",hasSticker:"true"===(null==i?void 0:i.isSticker),hasTag:"true"===(null==i?void 0:i.hasMention),isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0})),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.POST_COMMENT,actionElement:"preview_sidebar"})));break;case t.CommentsEventName.REPLY_COMMENT_START:a.UDCL.logStart(ht({actionSurface:Rt,eventState:"start",hasSticker:"true"===(null==i?void 0:i.isSticker),hasTag:"true"===(null==i?void 0:i.hasMention),isCollabEvent:!0}));break;case t.CommentsEventName.REPLY_COMMENT_CANCEL:a.UDCL.logEnd(ht({actionSurface:Rt,eventState:"canceled",isCollabEvent:!0}));break;case t.CommentsEventName.REPLY_COMMENT:a.UDCL.logEnd(ht({actionSurface:Rt,eventState:"success",isCollabEvent:!0})),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.REPLY_COMMENT,actionElement:"preview_sidebar",isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0}));break;case t.CommentsEventName.DELETE_COMMENT:a.UDCL.logEvent({class:"previews",action:"delete",object:"comment",properties:{actionSurface:Rt,eventState:"success"}}),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.DELETE_COMMENT,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.EDIT_COMMENT:a.UDCL.logEvent({class:"previews",action:"edit",object:"comment",properties:{actionSurface:Rt,eventState:"success"}}),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.SAVE_EDIT_COMMENT,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.START_EDIT_COMMENT:a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.EDIT_COMMENT,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.RESOLVE_COMMENT:a.UDCL.logEvent(function(e){return{class:"previews",action:"resolve",object:"comment",properties:e}}({actionSurface:Rt,eventState:"success"})),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.RESOLVE_COMMENT,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.ENABLE_COMMENTS:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"comments_enable",properties:e}}({actionSurface:Rt,eventState:"success"})),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.ENABLE_COMMENTS,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.DISABLE_COMMENTS:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"comments_disable",properties:e}}({actionSurface:Rt,eventState:"success"})),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.DISABLE_COMMENTS,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.ENABLE_CONTINUOUS_COMMENTING:a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.ENABLE_CONTINUOUS_COMMENTING,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.DISABLE_CONTINUOUS_COMMENTING:a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.DISABLE_CONTINUOUS_COMMENTING,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.SHOW_RESOLVED_COMMENTS:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"comments_show_resolved",properties:e}}({actionSurface:Rt,eventState:"success"})),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.SHOW_RESOLVED_COMMENTS,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.HIDE_RESOLVED_COMMENTS:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"comments_hide_resolved",properties:e}}({actionSurface:Rt,eventState:"success"})),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.SHOW_RESOLVED_COMMENTS,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.SUBSCRIBE_COMMENTS:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"comments_subscribe",properties:e}}({actionSurface:Rt,eventState:"success"})),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.SUBSCRIBE_COMMENTS,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.UNSUBSCRIBE_COMMENTS:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"comments_unsubscribe",properties:e}}({actionSurface:Rt,eventState:"success"})),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.UNSUBSCRIBE_COMMENTS,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.SORT_COMMENTS:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"comments_sort",properties:e}}({actionSurface:Rt,commentsSortOrder:(null==i?void 0:i.sortType)?(c=i.sortType,wt.find((e=>e===(null==c?void 0:c.toLowerCase())))):void 0}));break;case t.CommentsEventName.MARK_THREAD_READ:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"comments_mark_as_read",properties:e}}({actionSurface:Rt}));break;case t.CommentsEventName.MARK_THREAD_UNREAD:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"comments_mark_as_unread",properties:e}}({actionSurface:Rt}));break;case t.CommentsEventName.START_ANNOTATION_TIMESTAMP:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"comments_annotation_timestamp",properties:e}}({actionSurface:Rt}));break;case t.CommentsEventName.START_ANNOTATION_HIGHLIGHT:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"comments_annotation_highlight",properties:e}}({actionSurface:Rt}));break;case t.CommentsEventName.STICKER_START:a.UDCL.logStart(bt({actionSurface:Rt,eventState:"start"})),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.ADD_EMOJI,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.ADD_EMOJI:a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.ADD_EMOJI,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.STICKER_SUCCESS:a.UDCL.logEnd(bt({actionSurface:Rt,eventState:"success"}));break;case t.CommentsEventName.STICKER_CANCELED:a.UDCL.logEnd(bt({actionSurface:Rt,eventState:"canceled"}));break;case t.CommentsEventName.MENTION_START:a.UDCL.logStart(Et({actionSurface:Rt,eventState:"start"})),a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.TAG_SOMEONE,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.TAG_SOMEONE:a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.TAG_SOMEONE,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.MENTION_SUCCESS:a.UDCL.logEnd(Et({actionSurface:Rt,eventState:"success"}));break;case t.CommentsEventName.MENTION_CANCELED:a.UDCL.logEnd(Et({actionSurface:Rt,eventState:"canceled"}));break;case t.CommentsEventName.CANCEL_COMMENT:a.UDCL.logEvent(St({actionSurface:"previews",commentAction:t.CommentsEventName.CANCEL_COMMENT,actionElement:"preview_sidebar"}));break;case t.CommentsEventName.VIEW_COMMENTS:a.UDCL.logEvent(function(e){return{class:"previews",action:"view",object:"comments",properties:e}}({actionSurface:(null==i?void 0:i.actionSurface)?null==i?void 0:i.actionSurface:Rt,fileType:r,previewType:s,existingReactions:"true"===(null==i?void 0:i.existingReactions),commentId:null==i?void 0:i.commentId}));break;case t.CommentsEventName.ADD_COMMENT_REACTION_START:a.UDCL.logEvent(Ct({commentStreamType:Dt,isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0,eventState:"start"}));break;case t.CommentsEventName.ADD_COMMENT_REACTION:a.UDCL.logEvent(Ct({commentStreamType:Dt,isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0,addedFromExistingReaction:l}));break;case t.CommentsEventName.ADD_COMMENT_REACTION_SUCCESS:a.UDCL.logEvent(Ct({commentStreamType:Dt,isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0,eventState:"success",addedFromExistingReaction:l}));break;case t.CommentsEventName.REMOVE_COMMENT_REACTION:a.UDCL.logEvent(Mt({commentStreamType:Dt,isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0}));break;case t.CommentsEventName.REMOVE_COMMENT_REACTION_SUCCESS:a.UDCL.logEvent(Mt({commentStreamType:Dt,isSharedLink:"true"===(null==i?void 0:i.isSharedLink),fileExtension:o,fileType:r,fileObjId:null==i?void 0:i.fileId,previewType:s,isCollabEvent:!0,eventState:"success"}));break;case t.CommentsEventName.ADD_NAME_START:a.UDCL.logEvent(gt({actionSurface:Rt,eventState:"start"}));break;case t.CommentsEventName.ADD_NAME_CANCEL:a.UDCL.logEvent(gt({actionSurface:Rt,eventState:"canceled"}));break;case t.CommentsEventName.ADD_NAME:a.UDCL.logEvent(gt({actionSurface:Rt,eventState:"success"}));break;case t.CommentsEventName.SELECT_REPLY_COMMENTS:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"reply_comments",properties:e}}({actionSurface:(null==i?void 0:i.actionSurface)?null==i?void 0:i.actionSurface:"browse_quick_view",actionElement:(null==i?void 0:i.actionElement)?null==i?void 0:i.actionElement:"comment_drawer"}));break;case t.CommentsEventName.SELECT_ADD_COMMENTS:a.UDCL.logEvent(function(e){return{class:"previews",action:"select",object:"add_comments",properties:e}}({actionSurface:(null==i?void 0:i.actionSurface)?null==i?void 0:i.actionSurface:"browse_quick_view",actionElement:(null==i?void 0:i.actionElement)?null==i?void 0:i.actionElement:"comment_drawer"}))}var c})(e),(e=>{const{event:n}=e;n!==t.CommentsEventName.ADD_COMMENT&&n!==t.CommentsEventName.REPLY_COMMENT||a.UserSurvey.trackEvent("comment_created","previews")})(e)},t.logEvent=(e,t,n,i,o,r,s)=>{const c=l.get_browser_info(),d={...n&&m.buildExtraFromLinkMetadata(n),file_id:t},u=o.doesContainShmodelLink?a.ShareTibEventLogger.get_shmodel_extra_for_logging(void 0,f.getCleanedSharingUrl(o)):a.ShareTibEventLogger.get_scl_extra_for_logging(void 0,f.getCleanedSharingUrl(o));s={...d,browser:c.browser,browser_version:c.version,created_new_link:!1,...u,...s},i?a.ShareTibEventLogger.log(i,e,r,s):a.ShareTibEventLogger.log_unauth(e,r,s)},t.logVideoEvent=(e,t,n,i)=>{const o=P.previewSurfaceToPreviousSurface[t];_t(n,1,i),P.logAudioVideoEventToPap(e,o,n,i),a.isVideoPreview(e.extension)?P.logVideoPlayPauseToPap(n,{previousSurface:o,file:e},i.extra):a.isAudioPreview(e.extension)&&P.logAudioPlayToPap(n,{previousSurface:o,file:e},i.extra)},t.logVideoEventDuration=(e,t,n)=>{const a=dt(e,n),i=ut(n);P.logDurationToAMISAndUDCL(e,t,"web_audiovideo_previews",i,void 0,a)},t.logVideoEventQuantity=_t,t.makeComments2Client=function(t,n){let i;if(n){let o;i=async()=>{if(!o){const[i,r]=await Promise.all([a.loadAfterDisplay((()=>new Promise((function(t,n){e(["./c_comments2_mentions.after-display"],t,n)})))),B.fetchContactsConstants(t)]);o=await i.default(n,r.apiData)}return o}}return{boltIOClient:(e=>{let t=e=>{};return{subscribe:n=>(n.forEach((n=>{e.subscribe(function({channelId:e,revisionInfo:t}){return{app_id:e.appId,unique_id:e.uniqueId,revision:t.revision.toString(),token:t.token}}(n),t,t)})),Promise.resolve()),unsubscribe:()=>Promise.resolve(e.unsubscribe()),onSignal:e=>{t=t=>{const n=t.map((e=>{return{channelId:{appId:(t=e).app_id,uniqueId:t.unique_id},revisionInfo:{revision:parseInt(null!==(n=t.revision)&&void 0!==n?n:"",10),token:t.token}};var t,n}));e({updatedChannels:n})}}}})(new mt),reactionsBoltIOClient:(o=new mt,{subscribe:(e,t,n)=>{const a=e=>{e.filter((e=>e.app_id===ft)).length>0&&t()},i=e=>{e.filter((e=>e.app_id===ft)).length>0&&(o.unsubscribe(),n())};e.forEach((e=>{const{app_id:t,revision:n,token:r,unique_id:s}=e,l={app_id:t,revision:n,token:r,unique_id:s};o.subscribe(l,a,i)}))},unsubscribe:()=>o.unsubscribe()}),mentionsIOClient:i};var o},t.makeComments2Plugin=function(e){var n;const{apiV2Client:i,commentsPlatformAdapter:o,user:r,reportException:s,commentsPluginInitialParams:l,useLogEvent:c,commentSurface:d,showSnackbar:u,withErrorBoundaryCallback:m,showAuthModal:f,setHasUnreadComments:p}=e,g=null==l?void 0:l.commentId,v=null!==(n=null==l?void 0:l.shouldFocusComment)&&void 0!==n&&n;let h;const y=new Set,b=()=>{const{loggingSessionId:e}=a.useFileViewerContext(),t=dd(d),n=G.default.useCallback((()=>(h||(h=new Promise((n=>{if(!t)return;const r=((e,t)=>({getState:n,dispatch:a})=>i=>o=>{var r;switch(i(o),o.type){case Bt.ResolveNavigationToActiveThreadAnnotation:return;case Bt.ActivateThread:{const{fileId:i,sharedLinkURL:s}=o.payload,l=n();for(const n of Object.getOwnPropertyNames(l.pendingNavigationToActiveThreadAnnotation)){if(n===e){const e=Lo(i,s),o=l.activeThreadID[n],c=null===(r=l.threads[e])||void 0===r?void 0:r[o];if(c&&c.annotation){const e=c.annotation;if("document"===e.type){const n=me(e.regions[0])?void 0:e.regions[0].y+e.regions[0].height/2;t.navigateToPage((e.regions[0].page||1)-1,n?{offsetType:"percentage",centerOnYPercentageOffset:n}:void 0)}"audio"!==e.type&&"video"!==e.type||t.seek(e.time),t.openCommentStreamUI(),a(Wt(n))}}break}break}case Bt.ConfirmDraftAnnotation:return void t.openCommentStreamUI()}})(e,t);n(function({apiv2ClientBase:e,boltIOClient:t,mentionsIOClient:n},i){const o=[Yc(a.GetFilesRoutes(e)),za(a.GetComments2Routes(e)),(r=t,({dispatch:e,getState:t})=>(r.onSignal((n=>{n.updatedChannels.filter((e=>e.channelId.appId===Xc)).map((n=>{const a=t().boltInfo.boltUniqueIdToStream[n.channelId.uniqueId];a&&e(ba({arg:{include_permissions:!0,stream:a}}))}))})),e=>t=>{switch(t.type){case Bt.BoltSubscribe:r.subscribe(t.payload.map((e=>({channelId:{appId:e.app_id,uniqueId:e.unique_id},revisionInfo:{revision:+e.revision,token:e.token}}))));break;case Bt.BoltUnsubscribe:r.unsubscribe(t.payload.map((e=>({channelId:{appId:e.app_id,uniqueId:e.unique_id},revisionInfo:{revision:+e.revision,token:e.token}}))))}return e(t)})),Jc()];var r;n&&o.push(Ha(n)),i&&o.push(...i);const s=a.applyMiddleware(...o),l=window.__REDUX_DEVTOOLS_EXTENSION__,c=null==l?s:a.compose(s,l({name:"FVSDK Comments2 Plugin"}));return a.createStore(Ji,c)}({apiv2ClientBase:i,boltIOClient:o.boltIOClient,mentionsIOClient:o.mentionsIOClient},[r,jo]))}))),h)),[e,t]),[r,s]=G.default.useState(null);return G.default.useEffect((()=>{n().then(s)}),[e,n]),r},w=()=>{const e=x.useRootFile(),t=x.useSharedLinkInfo(),n=b(),o=void 0!==(null==r?void 0:r.id),s=a.useListCommentsQuery(i,o,e,t),l=G.default.useCallback((()=>{var t;n&&e&&s&&(y.add(e.fileId),o?n.dispatch((t=s,{type:Bt.LoggedInListCommentsResultIntoRedux,payload:t})):n.dispatch(function(e){return{type:Bt.LoggedOutListCommentsResultIntoRedux,payload:e}}(s)))}),[e,n,o,s]);G.default.useEffect((()=>{e&&!y.has(e.fileId)&&l()}),[l,e])},S=()=>{const e=b(),{loggingSessionId:t}=a.useFileViewerContext(),n=a.useSetAtom(vo),i=G.default.useCallback((()=>{((e,t,n)=>{t&&t.getState().annotationSettings.state&&(t.getState().annotationSettings.state&&t.dispatch(Ht(n)),t.dispatch(zt({fileViewerId:n})),e(void 0))})(n,e,t)}),[t,n,e]);return[H.getKeyboardBinding({key:a.Key_enum.Key.Escape,callback:i})]},C=(e,n,i,o,r,s)=>{if(null==o)return void n.dispatch(Ht(e));const l=function(e,t,n){if(null==n)return null;const{regions:i,type:o}=n;return e===a.PreviewType.Image?"rectangle"!==o&&"point"!==o?null:{type:"image",region:i[0],regionType:o}:e===a.PreviewType.SsrDoc&&null!=t?{type:"document",regionType:o,regions:i.map((e=>({...e,page:Jt(t)})))}:null}(s,r,o);null!=l&&(n.dispatch(function(e,t){return{type:Bt.UpdateDraftAnnotation,payload:{fileViewerId:e,annotation:t}}}(e,l)),i({event:t.CommentsEventName.START_ANNOTATION_HIGHLIGHT}))},M=(e,n,a)=>{n.dispatch(qt(e)),a({event:t.CommentsEventName.START_ANNOTATION_TIMESTAMP})},A={clickOutsideMarkers:e=>{null==h||h.then((t=>t.dispatch(zt({fileViewerId:e}))))}},I={commentUI:{VideoSeekBarLayer:m((e=>{const t=b();return t?G.default.createElement(a.Provider,{store:t},G.default.createElement(ld,{...e})):null})),CommentIconWithUnreadCount:m((e=>{w();const t=b();return t?G.default.createElement(a.Provider,{store:t},G.default.createElement(Wo,{fileId:e.fileId,sharedLinkURL:e.sharedLinkURL,setHasUnreadComments:p})):null})),mediaScrubber:A}},T={sidebarUI:{Icon:m((()=>{const e=x.useRootFile(),t=b();return(null==e?void 0:e.fileId)&&t?G.default.createElement(a.Provider,{store:t},G.default.createElement(Wo,{fileId:e.fileId,sharedLinkURL:e.url})):null})),Title:m((()=>{const e=E.useIntl();return G.default.createElement(G.default.Fragment,null,e.formatMessage({id:"extqcT",defaultMessage:"Comments"}))})),TitleAccessory:m((()=>{const e=x.useRootFile(),t=b(),n=c();return(null==e?void 0:e.fileId)&&t?G.default.createElement(a.Provider,{store:t},G.default.createElement(rd,{fileId:e.fileId,sharedLinkURL:e.url,size:"standard",logEvent:n,fileName:e.name})):null})),Content:m((()=>{w();const{loggingSessionId:n}=a.useFileViewerContext(),l=_.useRightSidebarId();W.useRecordPreviewsTimerOnMount(a.PreviewsTimer.SidebarContentsMount,{bladeId:a.COMMENTS_PLUGIN_ID},l===a.COMMENTS_PLUGIN_ID);const m=x.useRootFile(),p=b(),h=c(),y=x.useRootPreviewType();G.default.useEffect((()=>()=>{null!=(null==p?void 0:p.getState().annotationSettings.state)&&(null==p||p.dispatch(Ht(n)))}),[n,p]);const E=S(),C=dd(d),M=x.useSharedLinkInfo(),A=(()=>{const[n,a]=G.default.useState(void 0);return G.default.useEffect((()=>{d===t.CommentSurface.FULL_PREVIEW&&(async()=>{const{asyncImportShowCopyLinkUICallback:t,handleCopyLinkClick:n}=e,i=await t(),o=(e,t)=>n(i,e,t);a((()=>o))})()}),[]),n})();return m&&p?G.default.createElement(a.Provider,{store:p},G.default.createElement(H.KeyboardBindingConnector,{name:"comment_plugin",keyboardBindings:E}),G.default.createElement(sd,{fileViewerId:n,apiV2Client:i,file:m,previewType:y,navigationCallbacks:C,user:r,reportException:s,logEvent:h,sharedLinkInfo:M,reactionsBoltIOClient:o.reactionsBoltIOClient,showSnackbar:u,handleCopyLinkClick:A,commentId:g,shouldFocusComment:v,showAuthModal:f})):null}))}},k={layerUI:{Layer:m((e=>{w();const n=x.useRootPreviewType(),o=b(),{loggingSessionId:l}=a.useFileViewerContext(),u=c(),m=_.useIsCommentsModeActive(),p=G.default.useCallback((()=>{o&&M(l,o,u)}),[l,u,o]),g=G.default.useCallback(((e,t)=>{o&&C(l,o,u,e,t,n)}),[l,u,n,o]),v=x.useRootFile(),h=dd(d);return v&&o&&m?G.default.createElement(a.Provider,{store:o},G.default.createElement(zo,{...e,fileViewerId:l,apiV2Client:i,navigationCallbacks:h,file:v,handleAnnotationConfirm:p,handleRegionSelection:g,user:r,reportException:s,logEvent:u,viewOnly:d===t.CommentSurface.QUICK_VIEW,showAuthModal:f})):null}))},highlightMenuOption:m((({selectedText:e})=>{const t=E.useIntl(),n=x.useRootPreviewType(),i=b(),{loggingSessionId:o}=a.useFileViewerContext(),r=c(),s=G.default.useCallback((()=>{i&&(C(o,i,r,{type:"highlight",regions:e.selectionAreas.map((t=>V.createNormalizedRegion(t,e.page.bounds)))},e.page.pageNumber,n),M(o,i,r))}),[o,r,n,e.page.bounds,e.page.pageNumber,e.selectionAreas,i]);return G.default.createElement(ed,{label:t.formatMessage({id:"DwVkLn",defaultMessage:"Comment on text"}),icon:q.CommentLine,onClick:s})})),allowLayers:["imageLayer","highlightLayer","pluginOverlay","linksLayer"],textHighlighterId:a.COMMENTS_PLUGIN_ID},N={CommentsDrawer:m((e=>{w();const t=b(),{loggingSessionId:n}=a.useFileViewerContext(),o=dd(d),l=x.useRootFile(),u=x.useRootPreviewType(),_=c();return l&&t?G.default.createElement(a.Provider,{store:t},G.default.createElement(cd,{fileViewerId:n,apiV2Client:i,file:l,previewType:u,navigationCallbacks:o,user:r,reportException:s,logEvent:_,showAuthModal:f,...e})):null}))};switch(d){case t.CommentSurface.FULL_PREVIEW:return{...I,...T,...k};case t.CommentSurface.QUICK_VIEW:return{...I,...k,...N};default:return d}},t.makeFSSDesktopPreviewUrlClient=function(e,t){return{getQueryStringParameter:at,getAllQueryStringParameters:it,setQueryStringParameter:ot,onQueryStringParameterChange:rt,openFile(e){const n=a.preview_uri_for_fq_path(t,e),i=`https://www.dropbox.com/desktop_preview?preview_url=${encodeURIComponent(n.toString())}`;a.replace_location(i)},redirect:st,reload:lt,replaceState:ct}},t.makeFSSDesktopPrintClient=function(){return{print:e=>{window.open(e,"_blank")}}},t.makeFileActionsClient=function(e,t,n){return{delete:({onDelete:i,onDeleteSuccess:o,onDeleteFailed:r,onDeleteFailedNoPermission:s,onDeleteCancel:l,setDeleteFileModalOpen:c})=>{const{file:d}=t();if(!a.isBrowseFile(d)||Z(d)||!Q(d))return;if(i(),d.read_only)return a.Snackbar.warn(E.intl.formatMessage({id:"szm+5q",defaultMessage:"You don't have permission to make changes to this file"}),a.PREVIEWS_SNACKBAR_ID),void s();const u={file_id:d.file_id,is_dir:d.is_dir};S.portableDelete({user:e,filesPath:[u],fq_path:d.fq_path},{onNetworkRequest:()=>C.deleteSnackBarInProgress(a.PREVIEWS_SNACKBAR_ID),onSuccess:()=>{C.deleteCompleteSnackBar(a.PREVIEWS_SNACKBAR_ID),n&&n(d),o()},onError:e=>{C.deleteFailedSnackBar(e,a.PREVIEWS_SNACKBAR_ID),r()},onRequestClose:()=>{l()},setDeleteFileModalOpen:c})}}},t.makeFullScreenClient=function(e){return{enterFullScreen:(t,n,i)=>{n||(a.getDashChatSidebarOpenState()&&(null==e||e(!1),i.setIsDashChatClosedByFullscreenPreview(!0)),Ke({onExitFunction:t}))},exitFullScreen:(t,n)=>{t||(n.isDashChatClosedByFullscreenPreview&&(null==e||e(!0),n.setIsDashChatClosedByFullscreenPreview(!1)),je())}}},t.makeOpenInButtons=(e,t)=>{const n=(e=>{const t=te(e,De);if(t)return t})(e);if(!n||!t)return[];const i=(o=e.previewSurface)&&[a.SDKPreviewSurface.QUICK_VIEW_BROWSE,a.SDKPreviewSurface.QUICK_VIEW_SEARCH].includes(o)?a.UserActionContext.QuickViewToolbar:a.UserActionContext.PreviewToolbar;var o;return[{label:d.OPEN_IN_ACTION_STRING,icon:a.OpenLine,campaignElementId:"toolbar-open-in-button",handler:{type:"menu",menu:G.default.createElement(Le,{user:n.user.user,file:n.file,actionContext:i,surface:e.previewSurface})},actionType:a.UserAction.OpenInMenu}]},t.makeOpenInDesktopHandler=(t,n)=>{if("fq_path"in t&&Q(t)&&U.UnityFeatures.isUnitySupported()&&"ns_path"in t&&(null===s.UnityCheckFileCache||void 0===s.UnityCheckFileCache?void 0:s.UnityCheckFileCache.is_cached_and_locally_available(t.ns_id,t.ns_path)))return async()=>{const{openInDesktopAction:a}=await new Promise((function(t,n){e(["./c_file_viewer_action_plugins_file_actions"],t,n)}));a(t,n)}},t.makePrintClient=function(){return{print:(e,t)=>{var n,i;t===a.PreviewType.SsrDoc?(i=e,a.safe_open_tab_and_redirect(i)):t===a.PreviewType.Image?function(e){const t=window.open("about:blank");if(!t)throw new Error(E.intl.formatMessage({id:"X9xK6f",defaultMessage:"Could not open new window"}));window.setTimeout((()=>{const n=t.document.createElement("style");n.innerHTML="\n      @page { margin: 0;}\n      img { max-width: 100%; max-height: 100%}\n    ",t.document.head.appendChild(n);const a=t.document.createElement("img");a.src=e,a.onload=()=>{t.print()},a.onerror=()=>{t.close()},t.document.body.appendChild(a)}),50)}(e):t===a.PreviewType.Text&&(n=e,a.safe_open_tab_and_redirect(n))}}},t.makeReportExceptionClient=function(){return{reportException:(e,t,n,a)=>F.reportException({err:e,severity:a,tags:["file-viewer",t,n],force:!0})}},t.makeUrlClient=function(e,t){return{getQueryStringParameter:at,getAllQueryStringParameters:it,setQueryStringParameter:ot,onQueryStringParameterChange:rt,openFile(n,i,o){if(i){const e=a.preview_uri_for_fq_path(t,n,o);a.replace_location(e)}else{const i=a.get_browse_root(e,t)+y.URI.encode_parts(n);a.replace_location(i)}},redirect:st,reload:lt,replaceState:ct}},t.openInActionConditions=De,t.previewsContainer="_previews-container_15gac_1",t.reactionsAtom=xo,t.reactionsBoltInfoAtom=Io,t.reactionsUsersAtom=ko,t.renameActionConditions=ce,t.rlKeyExists=function(){return new URLSearchParams(window.location.search).has("rlkey")},t.sameAnnotation=function(e,t){return de(e)&&de(t)||ue(e)&&ue(t)},t.setDocSidebarIsCollapsed=function(e,t){try{a.UserLocalStorage.set(e,Ze,t)}catch(e){}},t.setFinderPromptIsHidden=function(e,t){try{a.UserLocalStorage.set(e,tt,t)}catch(e){}},t.setLeftSidebarState=function(e,t){try{a.UserLocalStorage.set(e,Ge,t)}catch(e){}},t.setLineNumbersAreHidden=function(e,t){try{a.UserLocalStorage.set(e,et,t)}catch(e){}},t.setLinkWarningIsHidden=function(e,t,n){try{a.UserLocalStorage.set(e,Je+t,n)}catch(e){}},t.setMutedState=function(e,t){try{a.UserLocalStorage.set(e,Ye,t)}catch(e){}},t.setRightSidebarState=function(e,t){try{a.UserLocalStorage.set(e,Qe,t)}catch(e){}},t.setSharedLinkDesktopModalIsHidden=function(e,t){try{a.UserLocalStorage.set(e,nt,t)}catch(e){}},t.setUiIsHidden=function(e,t){try{a.UserLocalStorage.set(e,Xe,t)}catch(e){}},t.setVolumeState=function(e,t){try{a.UserLocalStorage.set(e,$e,t)}catch(e){}},t.shouldShowCommentsForPreviewSurface=e=>!(e===a.SDKPreviewSurface.BACKUP||e===a.SDKPreviewSurface.SHARED_COLLECTION||e===a.SDKPreviewSurface.VERSION_HISTORY),t.shouldShowCommentsForPreviewType=ve,t.shouldShowResolvedCommentsAtom=po,t.showAuthModal=J,t.showCopyToDropboxSnackbar=()=>{a.Snackbar.show(G.default.createElement(a.Snackbar,{id:"copy-to-dropbox-snackbar",title:E.intl.formatMessage({id:"y9fwaW",defaultMessage:"Copying to Dropbox"}),closeButtonText:E.intl.formatMessage({id:"RfGyPH",defaultMessage:"Close"})}))},t.showEditPlugin=(e,t,n,i,o)=>{if(!e)return!1;if(a.isEncryptedFile(e))return!1;if(t&&0===t.canDownloadRoles.length)return!1;if(l.is_mobile_or_tablet(navigator.userAgent))return!1;const r=a.getExtension(e);return n&&s.isNonPdfEnabledInPdfEditor(r)?!i||!!o&&s.SIGN_ENTRY_POINT_VALUES.includes(o):!e||"pdf"===r},t.showSendForSignatureWarningModal=e=>{a.mountModal(G.default.createElement(Oe,{...e}))},t.show_auth_modal_esnext=ee,t.snackbars_esnext=xe,t.sortThreads=fe,t.startAnnotating=function(e,t,n){return{type:Bt.StartAnnotating,payload:{fileViewerId:e,accessible:t,annotationType:n}}},t.subscribeAction=La,t.throttle=Gt,t.unsubscribeAction=Ua,t.useAudioVideoEditDisabledTooltipMsg=(e,t)=>{var n;const i=x.useRootFile(),{data:o}=T.useFileContentMetadataQuery(i),r=null===(n=null==o?void 0:o.apiData)||void 0===n?void 0:n.metadata;let s;if("video"===(null==r?void 0:r[".tag"])||"audio"===(null==r?void 0:r[".tag"])){const n=k.checkFileEditEligibility(r,t,e);if(e&&n){const t=a.file_extension(e);s=k.getErrorStrings(n,t,E.intl).body}}return s},t.useCommentSidebarInteraction=e=>{const t=_.useRightSidebarId()===a.COMMENTS_PLUGIN_ID,n=u.useCloseSidebarCallback(e),i=u.useSetRightSidebarCallback(e),o=G.default.useCallback((()=>{t?n(a.COMMENTS_PLUGIN_ID):i(a.COMMENTS_PLUGIN_ID)}),[n,t,i]);return{isRightSidebarComments:t,handleClick:o}},t.useCommentsContext=Pt,t.useFeatureConfig=({canShowFileFlippers:e,previewContentOnly:t,cloudDocPreviewMode:n})=>{var i,o,r,s,c,d,u,_,m;const f="ON"===(null===(i=a.useExperiment("previews_exp_enable_mux_data",!0).experiment)||void 0===i?void 0:i.variant),p=null!==(r=null===(o=a.useExperiment("preview_collection_slideshow",!0).experiment)||void 0===o?void 0:o.variant)&&void 0!==r?r:"OFF",g=null!==(c=null===(s=a.useExperiment("previews_open_in_m2",!0).experiment)||void 0===s?void 0:s.variant)&&void 0!==c?c:"OFF",v="ON"===(null===(d=a.useExperiment("previews_videojs_touch_events",!0).experiment)||void 0===d?void 0:d.variant),h=null===(u=a.useExperiment("previews_three_js",!0).experiment)||void 0===u?void 0:u.variant,y=null!==(m=null===(_=a.useExperiment("custom_video_thumbnails").experiment)||void 0===_?void 0:_.variant)&&void 0!==m?m:"OFF",b=Y();return G.default.useMemo((()=>({...{enable_fullscreen:!0,keyboard_shortcuts:!0,preview_types:{[a.PreviewType.SsrDoc]:{...a.DEFAULT_CONFIG.preview_types[a.PreviewType.SsrDoc]}},videojs_preload:!0},file_flipping:e,mobile_web:l.is_supported_mobile_browser()||l.is_tablet()&&window.innerWidth<400,autohide_video_controls:t,cloud_doc_preview_mode:n,keyboard_shortcuts:!t,previews_exp_enable_mux_data:f,preview_collection_slideshow:p,previews_open_in_m2:g,previews_videojs_touch_events:v,previews_three_js:h,custom_video_thumbnails:y,enable_transcript_search_in_seekbar:b})),[e,t,n,f,p,g,v,h,y,b])},t.useFrameRate=ge,t.useGetUploadInfoQuery=(e,t,n=!1)=>G.default.useMemo((()=>{return t=e,K.createGenericQuery({queryRouteFilter:["apiv2",Qd],queryFn:({apiArg:e})=>async()=>({apiData:await a.GetFilesRoutes(t).rpc("get_upload_info",e,{}),pkgData:null}),getQueryKey:K.getGenericQueryKey("apiv2",Qd)});var t}),[e]).useQuery({apiArg:t,pkgArg:void 0},{suspense:n}),t.useIsTranscriptSearchExperimentEnabled=Y,t.useRenameRootFileCallback=Ae,t.useReplayActionHandler=e=>G.default.useMemo((()=>e instanceof a.FileSharedWithMe||!$(e)?void 0:()=>(e=>{a.UDCL.logEvent(a.PAP_NavigateTo_Replay({actionElement:"preview_titlebar",actionSurface:"previews",destinationSurface:"replay_preview"}));const t=e?`https://replay.dropbox.com/project/creating/${e.file_id}?creationSource=dropbox_previews_open_in_menu`:"https://replay.dropbox.com/?login=true";window.open(t)})(e)),[e]),t.useShouldRenderOpen=({file:e,user:t,shareToken:n,skipUnityCheck:r})=>{const l=a.useAppActions({enabled:!!t}).data,c=G.default.useMemo((()=>e instanceof a.FileSharedWithMe?[]:o.getOpenActionsForFile((null==l?void 0:l.actions)||[],e)),[null==l?void 0:l.actions,e]),d=G.default.useMemo((()=>i.partitionActions(c).cloudEditors),[c]),u=G.default.useMemo((()=>{if(r||e instanceof a.FileSharedWithMe)return!1;if($(e))return!0;if(a.isSharedFile(e)){if(0===d.length)return!1;if((e=>(null==e?void 0:e.linkType)===a.SharedLinkType.Shmodel)(n))return!1}return 0!==c.length||void 0}),[d.length,e,c.length,n,r]),_=r||void 0!==u,m=i.useUnity(e,t,_);return G.default.useMemo((()=>{if(void 0!==u)return i.UnityHelpers.getUnityFileInfoIfAppropriate(e,t,(()=>{}),(()=>{})),u;const n=!(!("ns_path"in e)||!s.UnityCheckFileCache)&&(null===s.UnityCheckFileCache||void 0===s.UnityCheckFileCache?void 0:s.UnityCheckFileCache.is_cached_and_locally_available(e.ns_id,e.ns_path));return 0!==c.length||(n||!!m&&i.UnityHelpers.isUnityFileSupported(m))}),[e,c.length,u,m,t])},t.useStarControlWithStore=function({getActiveFile:e,onChange:t,user:i,starredStore:o}){const{file:r}=e(),s=o.dispatch,[l,c]=n.useState(a.getIsStarred(o.getState(),r.file_id));return n.useEffect((()=>{const e=o.subscribe((()=>c(a.getIsStarred(o.getState(),r.file_id))));return()=>e()}),[r.file_id,o]),function(e,t,i,o,r){n.useEffect((()=>{r&&e(a.fetchMissingStarredStatuses([{id:t.file_id,type:a.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID}]))}),[t,r,e]);const s=n.useCallback((async()=>{const n=await e(a.updateStarredStatus({id:t.file_id,newStatus:!i,showSnackbar:!1}));try{a.unwrapResult(n),a.displayStarSnackbar({itemName:a.itemNameFromStarrableItem(t),isStarred:!i,success:!0}),null==o||o(!i,!0)}catch(e){a.displayStarSnackbar({itemName:a.itemNameFromStarrableItem(t),isStarred:!i,success:!1}),null==o||o(!i,!1)}}),[o,e,t,i]),l=i?d.UNSTAR_ACTION_STRING:d.STAR_ACTION_STRING,c=i?a.StarFill:a.StarLine;return{message:l,iconSrc:c,handleClick:s,isStarred:i}}(s,r,l,t,i)},t.useTooltipPlacement=_d,t.withActionCondition=(e,t,n)=>(a,...i)=>{const o=te(a,e);return o?t({user:o.user.user,file:o.file},...i):n}}));
//# sourceMappingURL=c_react_query_helpers_queries_upload_info.js-vflFY5You.map

//# debugId=984b2b35-102f-34db-b6f3-ee99c1409398