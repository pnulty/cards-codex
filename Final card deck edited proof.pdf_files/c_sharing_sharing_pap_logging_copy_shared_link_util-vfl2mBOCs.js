!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="1a5ee8b7-2e2c-35cd-be30-09a74b261644")}catch(e){}}();
define(["exports","./e_ui_page_files_router","./c_sharing_sharing_pap_logging_common_util","./c_pap-events_share_copy_shared_link","./c_sharing_sharing_pap_logging_shared_link_util"],(function(e,n,t,i,o){"use strict";const r=["network","already_exists","access_denied","email_not_verified","bad_path","settings_error","null_metadata","not_found","not_authorized","undefined_error","banned_member","failed_copy_to_clipboard","invalid_logged_out_cookie","unsupported_link_type","invalid_api_key","failed_web_share"];function a(e){return r.find((n=>n===(null==e?void 0:e.toLowerCase())))}const s=["max","editor","viewer","default"];function l(e){return s.find((n=>n===(null==e?void 0:e.toLowerCase())))}const d=["editor","viewer"];function c(e){return d.find((n=>n===(null==e?void 0:e.toLowerCase())))}const _=async(e,t,i)=>{const r=n.getLinkTypeFromUrl(e),a={sharedLinkIdentifier:i,linkType:r};if("scl"===r){t&&(a.sharedLinkResolvedAccessLevel=c(o.getAccessLevelFromLinkAccessLevel(t)));const{rlkey:i,sckey:r,senderTrackey:s,encryptedRecipientInfo:l}=n.getKeysFromSclUrl(null!=e?e:"");a.rlkeySha1=i?await n.sha1Hash(i):void 0,a.sckeySha1=r?await n.sha1Hash(r):void 0,a.stkey=s,a.encryptedRecipientInfoSha1=l?await n.sha1Hash(l):void 0}else if("s"===r||"sh"===r){a.sharedLinkResolvedAccessLevel="viewer";const{tkey:t,senderTrackey:i}=n.getKeysFromShmodelUrl(null!=e?e:"");a.tkeySha1=t?await n.sha1Hash(t):void 0,a.stkey=i}return a},u=async e=>{var i,r;const{eventState:s,actionSurface:d,actionElement:c,requestedAccessLevel:u,content:h,contentAction:v,hasCachedLink:k,metadata:g,url:p,screen:y,isSm24:S,commentId:L}=e;let f=((e,i,o,r,a,s,d,c,_,u)=>{const h=null==a?void 0:a.isDir,v=o?l(o):void 0,k=h?n.getFolderTypeFromString(t.FILE_TYPE_TO_FOLDER_TYPE[null==a?void 0:a.type]):void 0,g=null==a?void 0:a.nsId,p=null==a?void 0:a.fileId,y=h||null==a?void 0:a.ext;return{eventState:e,actionSurface:i,actionElement:r,contentAction:s?n.getContentActionFromString(s):void 0,folderType:k,sharedLinkRequestedAccessLevel:v,isDir:h,nsId:g,hasCachedLink:null!=d&&d,contentIdentifier:p,fileExtension:y,screen:c,shareModalType:_?t.getShareModalTypeFromString("sm24"):void 0,commentId:u}})(s,d,u,c,h,v,k,y,S,L);return"success"===s?f={...f,httpStatusCode:e.httpCode,createdNewLink:200===e.httpCode}:"failed"!==s&&"rejected"!==s||(f={...f,httpStatusCode:null!==(i=e.httpCode)&&void 0!==i?i:void 0,createSharedLinkErrorReason:a(o.COPY_LINK_EXCEPTION_TO_CREATE_SHARED_LINK_ERROR_REASON[e.exception])}),f&&g?f={...f,...await _(g.url,null===(r=g.link_permissions)||void 0===r?void 0:r.link_access_level,g.id)}:f&&p&&(f={...f,...await _(p)}),(e=>{const n={};for(const t in e)null===e[t]?n[t]=void 0:n[t]=e[t];return n})(f)};e.getCreateSharedLinkErrorReasonFromString=a,e.getLinkProps=_,e.getSharedLinkRequestedAccessLevelFromString=l,e.getSharedLinkResolvedAccessLevelFromString=c,e.logPAPCopySharedLinkEvent=async e=>{var t;const o=await u(e),{eventState:r,fileIdOrPath:a,loggingKey:s,isSm24:l,actionSurface:d,actionElement:c,screen:_}=e,h=i.PAP_Copy_SharedLink(o);let v={};o&&l&&(v={isSm24:"true",screen:null!=_?_:"unknown",actionSurfaceAndElement:`${null!=d?d:"unknown"}___${null!=c?c:"unknown"}`,...o.isDir&&{folderType:null!==(t=o.folderType)&&void 0!==t?t:"unknown"}});const k={isDir:(null==o?void 0:o.isDir)?"true":"false",...v};"start"===r?n.UDCL.logStart(h,{key:s||a,tags:k}):n.UDCL.logEnd(h,{key:s||a,tags:{createdNewLink:(null==o?void 0:o.createdNewLink)?"true":"false",...k},eventState:r})},e.logPAPWebShareSharedLinkEvent=async e=>{const t=await u(e),{eventState:i,fileIdOrPath:o,loggingKey:r}=e,a={class:"share",action:"share_start",object:"shared_link",properties:t};"start"===i?n.UDCL.logStart(a,{key:r||o}):n.UDCL.logEnd(a,{key:r||o})}}));
//# sourceMappingURL=c_sharing_sharing_pap_logging_copy_shared_link_util.js-vfl29095x.map

//# debugId=1a5ee8b7-2e2c-35cd-be30-09a74b261644