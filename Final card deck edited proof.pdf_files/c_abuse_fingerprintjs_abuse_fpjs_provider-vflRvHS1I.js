!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="8430412f-2eea-3d0f-ba58-43b2a494a289")}catch(e){}}();
define(["exports","react","./e_ui_page_files_router","./e_edison","react/jsx-runtime","./c__rollupPluginBabelHelpers","./c_fingerprintjs_fpjs-pro-static_fp","./e_core_exception","./c_src_sink_index","./c_pap-events_replay_shown_modal"],(function(e,t,n,r,o,i,s,c,a,u){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var d=l(t);function R(e){let t="";for(let n=0;n<e.length;++n)if(n>0){const r=e[n].toLowerCase();r!==e[n]?t+=` ${r}`:t+=e[n]}else t+=e[n].toUpperCase();return t}const f={default:"endpoint"},h={default:"tlsEndpoint"},E="Client timeout",_="Network connection error",p="Network request aborted",v="Response cannot be parsed",g="Blocked by CSP",O="The endpoint parameter is not a valid URL",m="Handle on demand agent data error",I=R("WrongRegion"),w=R("SubscriptionNotActive"),y=R("UnsupportedVersion"),T=R("InstallationMethodRestricted"),S=R("HostnameRestricted"),N=R("IntegrationFailed"),A=R("NetworkRestricted"),b=R("InvalidProxyIntegrationSecret"),C=R("InvalidProxyIntegrationHeaders"),P=R("ProxyIntegrationSecretEnvironmentMismatch"),L="API key required",D="API key not found",x="API key expired",j="Request cannot be parsed",M="Request failed",k="Request failed to process",F="Too many requests, rate limit exceeded",V="Not available for this origin",K="Not available with restricted header",U=L,B=D,q=x;const G="Failed to load the JS script of the agent",H="9319";function J(e,t){const n=[],[r,o]=function(e){const t=function(e){const t=[...e];return{current:()=>t[0],postpone(){const e=t.shift();void 0!==e&&t.push(e)},exclude(){t.shift()}}}(e),n=function(e,t){let n=0;return()=>Math.random()*Math.min(3e3,100*Math.pow(2,n++))}(),r=new Set;return[t.current(),(e,o)=>{let i;const s=o instanceof Error?o.message:"";if(s===g||s===O)t.exclude(),i=0;else if(s===H)t.exclude();else if(s===G){const n=Date.now()-e.getTime()<50,o=t.current();o&&n&&!r.has(o)&&(r.add(o),i=0),t.postpone()}else t.postpone();const c=t.current();return void 0===c?void 0:[c,null!=i?i:e.getTime()+n()-Date.now()]}]}(e);let i;if(void 0===r)return Promise.reject(new TypeError("The list of script URL patterns is empty"));const s=e=>{const r=new Date,c=t=>n.push({url:e,startedAt:r,finishedAt:new Date,error:t}),a=t(e);return a.then((()=>c()),c),a.catch((e=>{if(null!=i||(i=e),n.length>=5)throw i;const t=o(r,e);if(!t)throw i;const[c,a]=t;return(u=a,new Promise((e=>setTimeout(e,u)))).then((()=>s(c)));var u}))};return s(r).then((e=>[e,n]))}const Y="https://fpnpmcdn.net/v<version>/<apiKey>/loader_v<loaderVersion>.js",W=Y;function X(e){var t,n;const{picked:r,rest:o}=function(e,t){const n={},r={};for(const[o,i]of Object.entries(e))t.includes(o)?n[o]=i:r[o]=i;return{picked:n,rest:r}}(e,["scriptUrlPattern","token","apiKey"]),s=r.token,c=null!==(t=r.apiKey)&&void 0!==t?t:s,a=null!==(n=function(e,t){return function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(e,t)?e[t]:void 0}(e,"scriptUrlPattern"))&&void 0!==n?n:Y,[u,l]=function(){const e=[],t=()=>{e.push({time:new Date,state:document.visibilityState})},n=function(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}(document,"visibilitychange",t);return t(),[e,n]}();return Promise.resolve().then((()=>{if(!c||"string"!=typeof c)throw new Error(L);const e=function(e,t){return(Array.isArray(e)?e:[e]).map((e=>function(e,t){const n=encodeURIComponent;return e.replace(/<[^<>]+>/g,(e=>"<version>"===e?"3":"<apiKey>"===e?n(t):"<loaderVersion>"===e?n("3.12.1"):e))}(String(e),t)))}(a,c);return J(e,$)})).catch((e=>{throw l(),function(e){return e instanceof Error&&e.message===H?new Error(G):e}(e)})).then((e=>{let[t,n]=e;return l(),t.load(i._objectSpread2(i._objectSpread2({},o),{},{ldi:{attempts:n,visibilityStates:u}}))}))}function $(e){return function(e,t,n,r){const o=document,i="securitypolicyviolation";let s;const c=t=>{const n=new URL(e,location.href),{blockedURI:r}=t;r!==n.href&&r!==n.protocol.slice(0,-1)&&r!==n.origin||(s=t,a())};o.addEventListener(i,c);const a=()=>o.removeEventListener(i,c);return null==r||r.then(a,a),Promise.resolve().then(t).then((e=>(a(),e)),(e=>new Promise((e=>{const t=new MessageChannel;t.port1.onmessage=()=>e(),t.port2.postMessage(null)})).then((()=>{if(a(),s)return n(s);throw e}))))}(e,(()=>function(e){return new Promise(((t,n)=>{if(function(e){if(URL.prototype)try{return new URL(e,location.href),!1}catch(e){if(e instanceof Error&&"TypeError"===e.name)return!0;throw e}}(e))throw new Error(O);const r=document.createElement("script"),o=()=>{var e;return null===(e=r.parentNode)||void 0===e?void 0:e.removeChild(r)},i=document.head||document.getElementsByTagName("head")[0];r.onload=()=>{o(),t()},r.onerror=()=>{o(),n(new Error(G))},r.async=!0,r.src=e,i.appendChild(r)}))}(e)),(()=>{throw new Error(g)})).then(z)}function z(){const e=window,t="__fpjs_p_l_b",n=e[t];if(function(e,t){var n;const r=null===(n=Object.getOwnPropertyDescriptor)||void 0===n?void 0:n.call(Object,e,t);(null==r?void 0:r.configurable)?delete e[t]:r&&!r.writable||(e[t]=void 0)}(e,t),"function"!=typeof(null==n?void 0:n.load))throw new Error(H);return n}var Q={load:X,defaultScriptUrlPattern:W,ERROR_SCRIPT_LOAD_FAIL:G,ERROR_API_KEY_EXPIRED:x,ERROR_API_KEY_INVALID:D,ERROR_API_KEY_MISSING:L,ERROR_BAD_REQUEST_FORMAT:j,ERROR_BAD_RESPONSE_FORMAT:v,ERROR_CLIENT_TIMEOUT:E,ERROR_CSP_BLOCK:g,ERROR_FORBIDDEN_ENDPOINT:S,ERROR_FORBIDDEN_HEADER:K,ERROR_FORBIDDEN_ORIGIN:V,ERROR_GENERAL_SERVER_FAILURE:M,ERROR_HANDLE_AGENT_DATA:m,ERROR_INSTALLATION_METHOD_RESTRICTED:T,ERROR_INTEGRATION_FAILURE:N,ERROR_INVALID_ENDPOINT:O,ERROR_INVALID_PROXY_INTEGRATION_HEADERS:C,ERROR_INVALID_PROXY_INTEGRATION_SECRET:b,ERROR_NETWORK_ABORT:p,ERROR_NETWORK_CONNECTION:_,ERROR_NETWORK_RESTRICTED:A,ERROR_PROXY_INTEGRATION_SECRET_ENVIRONMENT_MISMATCH:P,ERROR_RATE_LIMIT:F,ERROR_SERVER_TIMEOUT:k,ERROR_SUBSCRIPTION_NOT_ACTIVE:w,ERROR_TOKEN_EXPIRED:q,ERROR_TOKEN_INVALID:B,ERROR_TOKEN_MISSING:U,ERROR_UNSUPPORTED_VERSION:y,ERROR_WRONG_REGION:I,defaultEndpoint:f,defaultTlsEndpoint:h},Z=Object.freeze({__proto__:null,ERROR_API_KEY_EXPIRED:x,ERROR_API_KEY_INVALID:D,ERROR_API_KEY_MISSING:L,ERROR_BAD_REQUEST_FORMAT:j,ERROR_BAD_RESPONSE_FORMAT:v,ERROR_CLIENT_TIMEOUT:E,ERROR_CSP_BLOCK:g,ERROR_FORBIDDEN_ENDPOINT:S,ERROR_FORBIDDEN_HEADER:K,ERROR_FORBIDDEN_ORIGIN:V,ERROR_GENERAL_SERVER_FAILURE:M,ERROR_HANDLE_AGENT_DATA:m,ERROR_INSTALLATION_METHOD_RESTRICTED:T,ERROR_INTEGRATION_FAILURE:N,ERROR_INVALID_ENDPOINT:O,ERROR_INVALID_PROXY_INTEGRATION_HEADERS:C,ERROR_INVALID_PROXY_INTEGRATION_SECRET:b,ERROR_NETWORK_ABORT:p,ERROR_NETWORK_CONNECTION:_,ERROR_NETWORK_RESTRICTED:A,ERROR_PROXY_INTEGRATION_SECRET_ENVIRONMENT_MISMATCH:P,ERROR_RATE_LIMIT:F,ERROR_SCRIPT_LOAD_FAIL:G,ERROR_SERVER_TIMEOUT:k,ERROR_SUBSCRIPTION_NOT_ACTIVE:w,ERROR_TOKEN_EXPIRED:q,ERROR_TOKEN_INVALID:B,ERROR_TOKEN_MISSING:U,ERROR_UNSUPPORTED_VERSION:y,ERROR_WRONG_REGION:I,default:Q,defaultEndpoint:f,defaultScriptUrlPattern:W,defaultTlsEndpoint:h,load:X});const ee="@fpjs@client@",te=()=>Date.now();class ne{constructor(e){var t;this.tag=e.tag||null,this.linkedId=e.linkedId||null,this.extendedResult=null!==(t=e.extendedResult)&&void 0!==t&&t}toKey(){return`${JSON.stringify(this.tag)}__${JSON.stringify(this.linkedId)}__${this.extendedResult}`}}function re(e,t){return`${t}__${e}`}function oe(e,t){return e.replace(`${t}__`,"")}class ie{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee;this.prefix=e}set(e,t){window.localStorage.setItem(re(e,this.prefix),JSON.stringify(t))}get(e){const t=window.localStorage.getItem(re(e,this.prefix));if(t)try{return JSON.parse(t)}catch(e){return}}remove(e){window.localStorage.removeItem(re(e,this.prefix))}allKeys(){return Object.keys(window.localStorage).filter((e=>e.startsWith(this.prefix))).map((e=>oe(e,this.prefix)))}}class se{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee;this.prefix=e}set(e,t){window.sessionStorage.setItem(re(e,this.prefix),JSON.stringify(t))}get(e){const t=window.sessionStorage.getItem(re(e,this.prefix));if(t)try{return JSON.parse(t)}catch(e){return}}remove(e){window.sessionStorage.removeItem(re(e,this.prefix))}allKeys(){return Object.keys(window.sessionStorage).filter((e=>e.startsWith(this.prefix))).map((e=>oe(e,this.prefix)))}}class ce{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3600,n=arguments.length>2?arguments[2]:void 0;this.cache=e,this.cacheTime=t,this.nowProvider=n||te}get(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=yield this.cache.get(e.toKey());if(!t)return;const n=yield this.nowProvider(),r=Math.floor(n/1e3);if(!(t.expiresAt<r))return t.body;yield this.cache.remove(e.toKey())}))}set(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const n=yield this.wrapCacheEntry(t);yield this.cache.set(e.toKey(),n)}))}clearCache(){return n.__awaiter(this,void 0,void 0,(function*(){const e=yield this.cache.allKeys();yield Promise.all(e.map((e=>this.cache.remove(e))))}))}wrapCacheEntry(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=yield this.nowProvider(),n=Math.floor(t/1e3)+this.cacheTime;return{body:e,expiresAt:n}}))}}class ae{constructor(){this.enclosedCache=function(){const e={};return{set(t,n){e[t]=n},get(t){const n=e[t];if(n)return n},remove(t){delete e[t]},allKeys:()=>Object.keys(e)}}()}}class ue{set(){}get(){}remove(){}allKeys(){return[]}}var le;!function(e){e.Memory="memory",e.LocalStorage="localstorage",e.SessionStorage="sessionstorage",e.NoCache="nocache"}(le||(le={}));const de={[le.Memory]:()=>(new ae).enclosedCache,[le.LocalStorage]:e=>new ie(e),[le.SessionStorage]:e=>new se(e),[le.NoCache]:()=>new ue},Re=e=>de[e];class fe{constructor(e){var t;let n;if(this.inFlightRequests=new Map,this.agentPromise=null,this.customAgent=null==e?void 0:e.customAgent,this.agent={collect:()=>{throw new Error("FPJSAgent hasn't loaded yet. Make sure to call the init() method first.")},get:()=>{throw new Error("FPJSAgent hasn't loaded yet. Make sure to call the init() method first.")}},this.loadOptions=null==e?void 0:e.loadOptions,(null==e?void 0:e.cache)&&(null==e?void 0:e.cacheLocation)&&console.warn("Both `cache` and `cacheLocation` options have been specified in the FpjsClient configuration; ignoring `cacheLocation` and using `cache`."),null==e?void 0:e.cache)n=e.cache;else{if(this.cacheLocation=(null==e?void 0:e.cacheLocation)||le.SessionStorage,!Re(this.cacheLocation))throw new Error(`Invalid cache location "${this.cacheLocation}"`);(e=>{switch(e){case le.SessionStorage:try{window.sessionStorage.getItem("item")}catch(e){return!1}return!0;case le.LocalStorage:try{window.localStorage.getItem("item")}catch(e){return!1}return!0;default:return!0}})(this.cacheLocation)||(this.cacheLocation=le.Memory),n=Re(this.cacheLocation)(null==e?void 0:e.cachePrefix)}if((null==e?void 0:e.cacheTimeInSeconds)&&e.cacheTimeInSeconds>86400)throw new Error("Cache time cannot exceed 86400 seconds (24 hours)");const r=null!==(t=null==e?void 0:e.cacheTimeInSeconds)&&void 0!==t?t:3600;this.cacheManager=new ce(n,r)}init(e){return n.__awaiter(this,void 0,void 0,(function*(){var t,n,r;if(!this.loadOptions&&!e)throw new TypeError("No load options provided");const o=!0===(null===(t=this.loadOptions)||void 0===t?void 0:t.silent)?[]:[...(null===(n=this.loadOptions)||void 0===n?void 0:n.integrationInfo)||[],...(null==e?void 0:e.integrationInfo)||[],"spa-sdk/1.3.3"],i=Object.assign(Object.assign(Object.assign({},this.loadOptions),e),{integrationInfo:o});if(!this.agentPromise){const e=null!==(r=this.customAgent)&&void 0!==r?r:Z;this.agentPromise=e.load(i).then((e=>(this.agent=e,e))).catch((e=>{throw this.agentPromise=null,e}))}return this.agentPromise}))}getVisitorData(){return n.__awaiter(this,arguments,void 0,(function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){const r=fe.makeCacheKey(t).toKey();if(!e.inFlightRequests.has(r)){const o=e._identify(t,n).finally((()=>{e.inFlightRequests.delete(r)}));e.inFlightRequests.set(r,o)}return yield e.inFlightRequests.get(r)}()}))}getVisitorDataFromCache(){return n.__awaiter(this,arguments,void 0,(function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){const n=fe.makeCacheKey(t),r=yield e.cacheManager.get(n);return r?Object.assign(Object.assign({},r),{cacheHit:!0}):void 0}()}))}isInCache(){return n.__awaiter(this,arguments,void 0,(function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){return Boolean(yield e.getVisitorDataFromCache(t))}()}))}clearCache(){return n.__awaiter(this,void 0,void 0,(function*(){yield this.cacheManager.clearCache()}))}static makeCacheKey(e){return new ne(e)}_identify(e){return n.__awaiter(this,arguments,void 0,(function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){const r=fe.makeCacheKey(e);if(!n){const e=yield t.cacheManager.get(r);if(e)return Object.assign(Object.assign({},e),{cacheHit:!0})}const o=yield t.agent.get(e);return yield t.cacheManager.set(r,o),Object.assign(Object.assign({},o),{cacheHit:!1})}()}))}}var he=function(){throw new Error("You forgot to wrap your component in <FpjsProvider>.")},Ee={getVisitorData:he,clearCache:he},_e=t.createContext(Ee),pe=function(e,t){return pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},pe(e,t)};var ve=function(){return ve=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ve.apply(this,arguments)};function ge(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function Oe(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((r=r.apply(e,t||[])).next())}))}function me(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(a){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,r=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}}function Ie(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var we="2.6.2",ye=function(){return"undefined"==typeof window||void 0===window.document};function Te(e){var t=e.checkCondition,n=e.intervalMs,r=void 0===n?250:n,o=e.timeoutMs,i=void 0===o?2e3:o;return new Promise((function(e,n){var o=setTimeout((function(){clearInterval(s),n(new Error("Timeout"))}),i),s=setInterval((function(){t()&&(clearTimeout(o),clearInterval(s),e())}),r)}))}var Se;function Ne(){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if("undefined"==typeof window)return!1;for(var n=0,r=e;n<r.length;n++)if((0,r[n])())return!0;return!1}((function(){return"next"in window&&Boolean(window.next)}),(function(){return document.querySelector("script[id=__NEXT_DATA__]")}))}function Ae(){var e;return null===(e=null===window||void 0===window?void 0:window.next)||void 0===e?void 0:e.version}function be(e){try{var t=JSON.parse("%DETECTED_ENV%");if("object"==typeof t)return t}catch(e){}return n=e.context,Ne()?{name:Se.Next,version:Ae()}:function(e){return e.classRenderReceivesAnyArguments}(n)?{name:Se.Preact}:function(e){return!e.classRenderReceivesAnyArguments}(n)?{name:Se.React}:{name:Se.Unknown};var n}!function(e){e.React="react",e.Preact="preact",e.Next="next",e.Unknown="unknown"}(Se||(Se={}));var Ce=function(e){function n(t){return e.call(this,t)||this}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}pe(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(n,e),n.prototype.render=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(!this.detectedEnv){var r={context:{classRenderReceivesAnyArguments:e.length>0}};this.detectedEnv=be(r)}return t.cloneElement(this.props.children,{env:this.detectedEnv})},n}(t.Component),Pe="@fingerprintjs/fingerprintjs-pro-react".split("/")[1];function Le(e){var t=e;return o.jsx(Ce,{children:o.jsx(De,ve({},t))})}function De(e){var n=this,r=e.children,i=e.forceRebuild,s=e.cache,c=e.cacheTimeInSeconds,a=e.cachePrefix,u=e.cacheLocation,l=e.customAgent,d=e.loadOptions,R=e.env,f=t.useRef(),h=t.useRef(),E=t.useMemo((function(){return{cache:s,cacheTimeInSeconds:c,cachePrefix:a,cacheLocation:u,customAgent:l,loadOptions:d}}),[d,s,c,a,u,l]),_=t.useCallback((function(){var e="".concat(Pe,"/").concat(we);if(R){var t=R.version?"".concat(R.name,"/").concat(R.version):R.name;e+="/".concat(t)}var n=ve(ve({},E),{loadOptions:ve(ve({},d),{integrationInfo:Ie(Ie([],d.integrationInfo||[],!0),[e],!1)})}),r=new fe(n);return h.current=r.init(),r}),[E,R,d]),p=t.useCallback((function(){return Oe(n,void 0,void 0,(function(){var e=this;return me(this,(function(t){switch(t.label){case 0:if(ye())throw new Error("FpjsProvider client cannot be used in SSR");return f.current?[3,2]:[4,Te({checkCondition:function(){return Boolean(f.current)}}).catch((function(){return Oe(e,void 0,void 0,(function(){return me(this,(function(e){return _(),[2]}))}))}))];case 1:t.sent(),t.label=2;case 2:return[2,f.current]}}))}))}),[_]),v=t.useCallback((function(e,t){return Oe(n,void 0,void 0,(function(){var n;return me(this,(function(r){switch(r.label){case 0:return[4,p()];case 1:return n=r.sent(),[4,h.current];case 2:return r.sent(),[2,n.getVisitorData(e,t)]}}))}))}),[p]),g=t.useCallback((function(){return Oe(n,void 0,void 0,(function(){return me(this,(function(e){switch(e.label){case 0:return[4,p()];case 1:return[4,e.sent().clearCache()];case 2:return e.sent(),[2]}}))}))}),[p]),O=t.useMemo((function(){return{clearCache:g,getVisitorData:v}}),[g,v]);return t.useEffect((function(){f.current&&!i||(f.current=_())}),[i,E,_]),o.jsx(_e.Provider,ve({value:O},{children:r}))}function xe(e,t){if(!e)throw new TypeError("".concat(t," must not be null or undefined"))}function je(e,r){var o=this;void 0===e&&(e={}),void 0===r&&(r=Me),xe(e,"getOptions");var i,s,c=(i=e,s=t.useRef(),t.useEffect((function(){s.current=i}),[i]),s.current),a=r.immediate,u=t.useContext(_e).getVisitorData,l=t.useState({isLoading:!1}),d=l[0],R=l[1],f=t.useCallback((function(t){return void 0===t&&(t={}),Oe(o,void 0,void 0,(function(){var n,r,o,i,s,c,a,l;return me(this,(function(d){switch(d.label){case 0:xe(t,"getDataParams"),n=t.ignoreCache,r=ge(t,["ignoreCache"]),d.label=1;case 1:return d.trys.push([1,3,4,5]),R((function(e){return ve(ve({},e),{isLoading:!0})})),o=e.ignoreCache,i=ge(e,["ignoreCache"]),s=ve(ve({},i),r),[4,u(s,"boolean"==typeof n?n:o)];case 2:return c=d.sent(),R((function(e){return ve(ve({},e),{data:c,isLoading:!1,error:void 0})})),[2,c];case 3:throw a=d.sent(),l=function(e){return e instanceof Error?e:new Error(String(e))}(a),l.name="FPJSAgentError",R((function(e){return ve(ve({},e),{data:void 0,error:l})})),l;case 4:return R((function(e){return e.isLoading?ve(ve({},e),{isLoading:!1}):e})),[7];case 5:return[2]}}))}))}),[e,u]);t.useEffect((function(){!a||c&&n.deepEquals(e,c)||f().catch((function(e){console.error("Failed to fetch visitor data on mount: ".concat(e))}))}),[a,f,c,e]);var h=d.isLoading,E=d.data,_=d.error;return{getData:f,isLoading:h,data:E,error:_}}var Me={immediate:!0};const ke="abuse",Fe=new n.HiveLogger;function Ve(e,t,n,r,o){const i=a.getMetricsReporter(),s=i.createCounter({ns:"abuse",name:"fingerprintjs/loading_result"},{is_success:String(t),event:e,err:n,region:o});s.increment(),s.record();i.createStats({ns:ke,name:"fingerprintjs/loading_latency"},{is_success:String(t),event:e,err:n,region:o}).record(r)}const Ke={getVisitorData:()=>(c.reportException({err:new Error("Missing <AbuseFpjsProvider> in component tree"),severity:c.SEVERITY.USER_ERROR,tags:["fingerprintjs"]}),Promise.resolve({visitorId:"",requestId:"",sealedResult:""}))},Ue=t.createContext(Ke),Be=()=>u.isSeleniumTest()||"undefined"!=typeof jest,qe=async(e,t,n=2e3,r=!1)=>Be()?{visitorId:"test_visitor_id",requestId:"test_request_id",sealedResult:"test_sealed_result"}:{visitorId:"",requestId:"",sealedResult:""};function Ge({region:e,shouldInvokeFPJS:r,children:o}){const{getData:i}=je({extendedResult:!0},{immediate:!1}),s=t.useMemo((()=>i),[]),u=d.default.useCallback((async(t,o,i=2e3,u=!1)=>{if(Be()||!r)return await qe(0,0,i,u);!function(e,t){const n=a.getMetricsReporter().createCounter({ns:"abuse",name:"fingerprintjs/invocation"},{event:e,region:t});n.increment(),n.record()}(t,e);const l=Date.now();try{const r=await s({timeout:i,ignoreCache:u}),a=Date.now(),d=void 0!==r.sealedResult;return function(e,t,r){if(!r.sealedResult)try{Fe.log(new n.FingerprintJsLogsRow({email:t,event:e,request_id:r.requestId,visitor_id:r.visitorId,visitor_found:r.visitorFound,confidence_score:void 0,confidence_comment:r.confidence?r.confidence.comment:"",browser_name:r.browserName,browser_version:r.browserVersion,device:r.device,incognito:r.incognito,ip:r.ip,latitude:r.ipLocation?String(r.ipLocation.latitude):"",longitude:r.ipLocation?String(r.ipLocation.longitude):"",timezone:r.ipLocation?String(r.ipLocation.timezone):"",city:r.ipLocation&&r.ipLocation.city?r.ipLocation.city.name:void 0,country:r.ipLocation&&r.ipLocation.country?r.ipLocation.country.name:void 0,os:r.os,os_version:String(r.osVersion),confidence_score_double:r.confidence.score}))}catch(e){c.reportException({err:e,severity:c.SEVERITY.CRITICAL,tags:["fingerprintjs"]})}}(t,o,r),Ve(t,d,"None",a-l,e),{visitorId:r.visitorId,requestId:r.requestId,sealedResult:r.sealedResult?r.sealedResult:""}}catch(r){const i=Date.now();return function(e,t){try{Fe.log(new n.FingerprintJsLogsRow({email:t,event:e,request_id:"",visitor_id:"",visitor_found:!1,confidence_score:void 0,confidence_comment:"",browser_name:"",browser_version:void 0,device:"",incognito:void 0,ip:"",latitude:"",longitude:"",timezone:"",city:"",country:"",os:"",os_version:"",confidence_score_double:void 0}))}catch(e){c.reportException({err:e,severity:c.SEVERITY.CRITICAL,tags:["fingerprintjs"]})}}(t,o),Ve(t,!1,r instanceof Error?r.message:"Unknown error",i-l,e),c.reportException({err:r,severity:c.SEVERITY.NONCRITICAL,tags:["fingerprintjs"]}),{visitorId:"",requestId:"",sealedResult:""}}}),[s,e,r]),l=d.default.useMemo((()=>({getVisitorData:u})),[u]);return d.default.createElement(d.default.Fragment,null,d.default.createElement(Ue.Provider,{value:l},o))}e.AbuseFpjsProvider=({children:e,loadInTest:t=!1,loadingComponent:o=null})=>{const[i,a]=d.default.useState();d.default.useMemo((()=>{Be()?a(new n.FingerPrintJSConstants({token:"test_token",region:"US",shouldInvoke:!1})):async function(e){return await r.Edison.fetch(n.FingerPrintJSService,"FetchConstants",e?{currentUrl:e}:void 0)}().then((e=>{a(e)})).catch((e=>{c.reportException({err:e,severity:c.SEVERITY.NONCRITICAL,tags:["fingerprintjs"]}),a(new n.FingerPrintJSConstants({token:"",region:"US",shouldInvoke:!1}))}))}),[]);const l=d.default.useMemo((()=>({getVisitorData:qe})),[]);return Be()&&!t?d.default.createElement(Ue.Provider,{value:l},e):i?d.default.createElement(d.default.Fragment,null,d.default.createElement(Le,{loadOptions:{apiKey:i.token,endpoint:u.isRunningAgainstProductionBackend()?"https://fp.dropbox.com":s.vn,modules:[s.ts(),s.zc(),s.Be()],urlHashing:{path:!0,query:!0,fragment:!0},cacheTimeInSeconds:3600,silent:!0},customAgent:s.FingerprintJS},d.default.createElement(Ge,{shouldInvokeFPJS:i.shouldInvoke,region:i.region},e))):d.default.createElement(d.default.Fragment,null,o)},e.useAbuseFpjsContext=()=>t.useContext(Ue),e.withAbuseFpjsContext=function(e){const t=t=>d.default.createElement(Ue.Consumer,null,(n=>d.default.createElement(e,{...t,fpjsContext:n})));var n;return t.displayName=`WithAbuseFpjsContext(${n=e,n.displayName||n.name||"Component"})`,t}}));
//# sourceMappingURL=c_abuse_fingerprintjs_abuse_fpjs_provider.js-vflC74qEo.map

//# debugId=8430412f-2eea-3d0f-ba58-43b2a494a289