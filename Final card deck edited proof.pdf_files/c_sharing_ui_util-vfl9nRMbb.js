!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="37a6916e-8c5c-3244-92cc-70e4765f4163")}catch(e){}}();
define(["exports","react","./e_ui_page_files_router","./c_pap-events_folder_modal_select_create_folder_modal_create_button","./c_icon_icon_helper","./c_core_i18n","./e_core_exception","./c_pap-events_replay_shown_modal","./c_bem","./c_lodash-es_lodash"],(function(e,t,r,a,o,s,n,i,d,l){"use strict";function _(e){return e&&e.__esModule?e:{default:e}}var m=_(t);const E=d.localeToBcp47LangTag(i.getPageLocale()),u=s.createIntl({messages:{},locale:E,onError:e=>{if(e.code!==s.IntlErrorCode.MISSING_TRANSLATION)return n.reportException({err:e,tags:["format_html"],severity:n.SEVERITY.CRITICAL})}});function c(e,t){return u.formatMessage({id:e,defaultMessage:e,description:"nothing"},t)}const f=e=>t=>t===e,g=e=>!(e=>null===e)(e)&&!(e=>Array.isArray(e))(e)&&"object"==typeof e,M=e=>t=>g(t)&&Object.entries(e).every((([e,r])=>r(t[e]))),h={strong:e=>m.default.createElement("strong",null,e),em:e=>m.default.createElement("em",null,e)},T={SINGLE_INVALID:s.intl.formatMessage({id:"AwwRIX",defaultMessage:"The email address you entered is invalid."}),OUT_OF_TEAM:s.intl.formatMessage({id:"KCd6Mi",defaultMessage:"You can only share with your team and people your admin has approved."}),ENCRYPTED_FOLDER_KEY_MISSING:s.intl.formatMessage({id:"7tUxZz",defaultMessage:"Can’t share encrypted folder with external team members because the client is not enrolled."}),SEND_LINK:s.intl.formatMessage({id:"f8bN8Q",defaultMessage:"Copy and send them a link instead to view without an account."}),SINGLE_TOO_MANY_MEMBERS:s.intl.formatMessage({id:"ZEnulX",defaultMessage:"Can’t share with this many people."}),GENERAL_INVALID:s.intl.formatMessage({id:"85p8vn",defaultMessage:"One or more names or email addresses you entered are invalid."}),GENERAL_OUT_OF_TEAM_MULTIPLE:s.intl.formatMessage({id:"XliECV",defaultMessage:"Some of these emails aren’t on your Dropbox team."}),GENERAL_OUT_OF_TEAM_SINGLE:s.intl.formatMessage({id:"vgnpLP",defaultMessage:"This email isn’t on your Dropbox team."}),NONGROUP_INVITEE:s.intl.formatMessage({id:"XHbTJ8",defaultMessage:"Only groups can be added to team folders."}),NO_PERMISSION:s.intl.formatMessage({id:"O1327M",defaultMessage:"You don’t have permission to share with this person."}),GENERAL_NO_PERMISSION:s.intl.formatMessage({id:"XDLsmJ",defaultMessage:"You don’t have permission to share with some of these people."}),TARGET_NOT_SAME_TEAM_RESTRICTED:s.intl.formatMessage({id:"UrkgWp",defaultMessage:"You don’t have permission to share with some of these people due to restrictions on their end."})};var I;e.ContactsErrorLevel=void 0,(I=e.ContactsErrorLevel||(e.ContactsErrorLevel={})).Error="error",I.Warn="warn";const O=(e,t)=>(t.displayName()||"").toLowerCase(),S=Math.pow(2,53)-1,p=function(e,t,r){return!e.is_cdm_member&&(t||r)},R={access_error:s.intl.formatMessage({id:"N0ZK+y",defaultMessage:"You don’t have access to this content."}),email_unverified:s.intl.formatMessage({id:"YVPxPt",defaultMessage:"You haven’t verified your email. Check your email and try again."}),bad_member:s.intl.formatMessage({id:"0AMMBX",defaultMessage:"You entered an invalid name or email address."}),cant_share_outside_team:s.intl.formatMessage({id:"JoJWle",defaultMessage:"Your team settings don’t allow sharing outside your team."}),too_many_members:s.intl.formatMessage({id:"Zq3Ehi",defaultMessage:"You’re sharing with too many people."}),too_many_pending_invites:s.intl.formatMessage({id:"Zq3Ehi",defaultMessage:"You’re sharing with too many people."}),rate_limit:s.intl.formatMessage({id:"ZXI9uh",defaultMessage:"You’ve hit the limit of invites for today. Try again later."}),insufficient_plan:s.intl.formatMessage({id:"osl3qq",defaultMessage:"You need a Dropbox {trademark_plus} or Business account to do this."},{trademark_plus:r.getTrademarkPlus()}),team_folder:s.intl.formatMessage({id:"ehBhap",defaultMessage:"You can’t add members to a team folder. Contact your team admin."}),no_permission:s.intl.formatMessage({id:"5/am2Y",defaultMessage:"You don’t have permission to do this. Contact the owner."})},A=function(e,t){var r;return e.is_team_folder&&(null===(r=e.owner_team)||void 0===r?void 0:r.id)===t.team_dbtid};var N,L;e.SharingUserLeapEvent=void 0,(N=e.SharingUserLeapEvent||(e.SharingUserLeapEvent={})).SHARE_SUCCESS="share_success",N.SHARE_MODAL_CLOSE="share_modal_close",N.SHARE_LINK_COPY_SUCCESS="share_link_copy_success",N.SHARE_LINK_CREATE_SUCCESS="share_link_create_success",N.SM24_IB_SHARE_COMPLETE="sm24_ib_share_complete",N.SM24_OOB_SHARE_COMPLETE_CLMM_CLOSED="sm24_oob_share_complete_clmm_closed",e.ReceiverUserLeapEvent=void 0,(L=e.ReceiverUserLeapEvent||(e.ReceiverUserLeapEvent={})).VIEWED_SHARED_FOLDER="viewed_shared_folder",L.VIEWED_SHARED_FILE="viewed_shared_file",L.VISIT_SHARE_PAGE="visit_share_page",L.VISIT_SHARE_PAGE_LINKS_TAB="visit_share_page_links_tab",L.VIEWED_SHARED_FOLDER_PROMPT_ON="viewed_shared_folder_prompt_on",L.VIEWED_SHARED_FOLDER_PROMPT_CONTROL="viewed_shared_folder_prompt_control";const v=e=>{r.UserSurvey.addAttribute("eventName",e),r.UserSurvey.trackEvent(e,"sharing")},C=e=>M({error:M({".tag":f("too_many_mounts"),too_many_mounts:M({".tag":e})})}),b=C(f("total_mounts_exceeded")),y=C(f("home_mounts_exceeded")),F=C(f("tree_size_exceeded")),Y=e=>{const t=(e=>new r.MountLimitInfo({limit:e.error.too_many_mounts.limit,current_count:e.error.too_many_mounts.current_count,new_count:e.error.too_many_mounts.new_count}))(e),a=t.limit;return t.new_count-a};e.ABUSE_HELP_ARTICLE_LINK="https://help.dropbox.com/share/banned-links",e.CONTACT_ERROR_MESSAGES=T,e.NSF_HELP_ARTICLE_LINK="https://help.dropbox.com/files-folders/share/shared-folder-faq#Why-cant-I-create-a-shared-folder",e.convertIfHTML=function(e){return e.toHTML?c(e.toHTML(),h):e},e.genAddMemberErrorMessage=function(e){return e.message?e.message:e instanceof r.AppError&&e.error&&e.error[".tag"]&&R[e.error[".tag"]]?R[e.error[".tag"]]:s.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})},e.getContactSupportMessage=()=>s.intl.formatMessage({id:"Bcojaq",defaultMessage:"Contact support"}),e.getExceededCountInfo=Y,e.getHomeMountsExceededMountFoldersMsg=e=>{const t=Y(e);return s.intl.formatMessage({id:"ufWtvO",defaultMessage:"Couldn’t add folder. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t})},e.getLinkOnlyMsg=()=>s.intl.formatMessage({id:"rGV9l9",defaultMessage:"This folder can only be shared by link. To share this folder by email, unshare other folders and try again."}),e.getMemberCountForTokens=function(e){return null==e?0:e.map((e=>e.group_size||1)).reduce(((e,t)=>e+t),0)},e.getMountsExceededLinkOnlyTitle=e=>void 0!==e?s.intl.formatMessage({id:"v6sjfI",defaultMessage:"Your Dropbox is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit"},{number:e}):s.intl.formatMessage({id:"oyRS/p",defaultMessage:"Your Dropbox is over the shared folders limit"}),e.getNewFolderPathFromContentName=function(e,t){return[r.normalize(t),e].join("/")},e.getOffTeamUserMessageForTeamFolder=e=>void 0!==e?s.intl.formatMessage({id:"ToMYBy",defaultMessage:"This folder can only be managed by the {ownerTeamName} team."},{ownerTeamName:e}):s.intl.formatMessage({id:"ReqZ5Y",defaultMessage:"This folder can only be managed by the owner team."}),e.getTotalMountsExceededMountFoldersMsg=e=>{const t=Y(e);return s.intl.formatMessage({id:"EjCgHX",defaultMessage:"Couldn’t add folder. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t})},e.getTreeSizeExceededLinkOnlyTitle=e=>void 0!==e?s.intl.formatMessage({id:"vYWGKg",defaultMessage:"Your parent folder is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit"},{number:e}):s.intl.formatMessage({id:"1F2/ya",defaultMessage:"Your parent folder is over the shared folders limit"}),e.getTreeSizeExceededMountFoldersMsg=e=>{const t=Y(e);return s.intl.formatMessage({id:"6mGfdj",defaultMessage:"Couldn’t add folder. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t})},e.isHomeMountsExceededError=y,e.isSameTeamTeamFolder=A,e.isTeamFolderForNonTMRUser=(e,t)=>e&&!t.is_tmr_member,e.isTotalMountsExceededError=b,e.isTreeSizeExceededError=F,e.isUserOnDifferentTeam=(e,t)=>e&&t&&(!e.is_team||e.team_dbtid&&e.team_dbtid!==t.id),e.legacyFormatHtmlAsReact=c,e.logTiburonEvent=(e,t,a,o={})=>{const s=e.extras.origin;r.ShareTibEventLogger.log(t,a,s,l.assignIn(o,{file_id:e.extras.fileId,fq_path:e.displayPath(),ns_id:e.isSharedFolder()?e.sharedFolderId():void 0,modal_session_id:e.extras.modalSessionId,is_encrypted:e.isEncryptedFolder()}))},e.makeMemberSortCmp=function(e,t,a){const o=a?(e=>function(t,a){const o=a.memberId()===t,s=a instanceof r.GroupMembershipInfo?"0":"1",n=(a.displayName()||"").toLowerCase(),i=null!=a.account_id&&e.has(a.account_id);return`${s}${i&&o?"a":i?"b":null!=a.time_last_seen?`c${function(e){let t=String(S-Number(e));const r=String(S).length;return t.length<r&&(t=`${Array(r-t.length+1).join("0")}${t}`),t}(a.time_last_seen)}`:"d"}${n}`})(t):O;return function(t,r){const a=o(e.account_id,t),s=o(e.account_id,r);return a<s?-1:a===s?0:1}},e.namespaceLimitExceededFailCreateSharedFolderSnackbarMsg=e=>{const t=Y(e);return s.intl.formatMessage({id:"0UrAT5",defaultMessage:"Couldn’t create shared folder. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t})},e.shouldEnforceMemberLimits=p,e.spectrumFolderIconForMetadata=function(e,t){const a=null!=e.parent_shared_folder_id,s=e.isViewOnly();let n=r.FileTypes.FOLDER;return A(e,t)?n=r.FileTypes.TEAM_SHARED_FOLDER:e.isSharedFolder()&&(n=r.FileTypes.SHARED_FOLDER),o.spectrumFolderIcon({fileType:n,isInTeamFolderTree:a,isViewOnly:s})},e.trackReceiverUserLeapEvent=v,e.trackSharePageUserLeapEvent=(e,t)=>{r.UserSurvey.addAttribute("contentCount",t),v(e)},e.trackUserLeapEvent=(e,t)=>{(e=>void 0!==e&&[r.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS,r.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS_BUTTON,r.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FACEPILE,r.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ROW,r.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ROW_BUTTON,r.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ROW_OVERFLOW_MENU,r.SHARE_ACTION_ORIGIN_TYPE.SHARE_LINK_MODAL,r.SHARE_ACTION_ORIGIN_TYPE.BROWSE_CONTENT_TILE,r.SHARE_ACTION_ORIGIN_TYPE.QUICK_VIEW_BROWSE,r.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS,r.SHARE_ACTION_ORIGIN_TYPE.BROWSE_SHARE_ACTION_FILE_CHOOSER].indexOf(e)>=0)(t)&&(r.UserSurvey.addAttribute("eventName",e),r.UserSurvey.trackEvent(e,"sharing"))},e.validateContacts=function(t,r,o,n,i,d,l){let _,E;for(const t of r){const o=n[t.getKey()];if(!o)continue;const s=r.filter((e=>!e.on_team)).length,{state:i,msg:d}=o;i===a.ContactTokenState.invalid&&(_=e.ContactsErrorLevel.Error,d===T.SINGLE_INVALID?E=T.GENERAL_INVALID:d===T.OUT_OF_TEAM?E=s>1?T.GENERAL_OUT_OF_TEAM_MULTIPLE:T.GENERAL_OUT_OF_TEAM_SINGLE:d===T.NONGROUP_INVITEE?E=T.NONGROUP_INVITEE:d===T.NO_PERMISSION?E=T.GENERAL_NO_PERMISSION:d===T.TARGET_NOT_SAME_TEAM_RESTRICTED?E=T.TARGET_NOT_SAME_TEAM_RESTRICTED:d===T.ENCRYPTED_FOLDER_KEY_MISSING&&(E=T.ENCRYPTED_FOLDER_KEY_MISSING)),i===a.ContactTokenState.warn&&(_=e.ContactsErrorLevel.Warn,d===T.OUT_OF_TEAM&&(E=s>1?T.GENERAL_OUT_OF_TEAM_MULTIPLE:T.GENERAL_OUT_OF_TEAM_SINGLE))}return p(o,i,d)&&r.length>0&&_!==e.ContactsErrorLevel.Error&&t&&l>t.sharingTotalLimit&&(_=e.ContactsErrorLevel.Error,E=s.intl.formatMessage({id:"rTaV0v",defaultMessage:"This will put the folder over its {member_limit}-member limit. <a>Learn more.</a>"},{member_limit:t.sharingTotalLimit,a:e=>m.default.createElement("a",{href:"/help/9292",target:"_blank",key:"help_center_article"},e)})),{level:_,message:E}}}));
//# sourceMappingURL=c_sharing_ui_util.js-vflQnblzw.map

//# debugId=37a6916e-8c5c-3244-92cc-70e4765f4163