!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="d9e31e2b-18e2-32ee-88a9-1a6faac0247f")}catch(e){}}();
define(["require","exports","./e_privacy_consent_static_ccpa_iframe","./c_src_sink_index","./e_data_modules_stormcrow","./e_edison","./e_core_exception","./c_init_data_runtime","react","./c__rollupPluginBabelHelpers","./c_esv_utils_internal","./c_domains","./c_init_data_edison","./c_browser_browser_detection","./c_core_i18n","metaserver/static/js/langpack","./c_core_notify","react-dom","react/jsx-runtime","./c_performance_metrics_route_name_resolver"],(function(e,t,n,i,a,o,s,r,l,c,d,u,h,_,m,g,p,f,v,E){"use strict";const y="undefined"!=typeof self&&self?self:window;function k(){if(!y._DBX_UXA_isUxaListening)return;const e=y._DBX_UXA_bufferedClosures=y._DBX_UXA_bufferedClosures||[],t=[...e];e.length=0;for(const e of t)e()}function w(e,t){window.dispatchEvent(function(e,t={detail:null}){if("function"==typeof CustomEvent)return new CustomEvent(e,t);const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!0,!0,t.detail),n}(e,t))}function I(){try{return window.self!==window.top}catch(e){return!0}}const x=()=>location.hostname.split(".").slice(-2).join("."),b=()=>"dropbox.com"===x(),T=()=>!!b()||("docsend.com"===x()||("dash.ai"===x()||("dropboxforum.com"===x()||("webflow.io"===x()||"app.hellosign.com"===location.hostname)))),S=e=>({element_id:e.getAttribute("data-uxa-log"),tag_name:e.tagName.toLowerCase(),entity_id:e.getAttribute("data-uxa-entity-id"),trace_id:e.getAttribute("data-uxa-trace-id"),element_rank:A(e),untrusted_raw_variant:e.getAttribute("data-uxa-untrusted-raw-variant"),hierarchy_group:C(e)}),C=e=>{let t=0,n=e;for(;n&&t<10;){const e=n.getAttribute("data-uxa-hierarchy-group");if(e)return e;n=n.parentElement,t++}return null},A=e=>{const t=e.nodeName.toLowerCase(),n=e.getAttribute("data-uxa-log"),i=document.querySelectorAll(`${t}[data-uxa-log="${n}"]`);if(1===i.length)return 1;for(let t=0;t<i.length;t++)if(i[t]===e)return t+1;return-1},M="dbx_js_analytics_id",O={uxaIsEssential:T,analyticsTrackingIsAllowed:()=>{if(T())return!0;return(()=>{var e,t,n;const i=null===(n=null===(t=null===(e=window.dropbox)||void 0===e?void 0:e.privacyConsent)||void 0===t?void 0:t.getConsentCategories)||void 0===n?void 0:n.call(t);if(!i)return{analyticsAllowed:!1,generalMarketingAndAdvertisingAllowed:!1,performanceAndFunctionalityAllowed:!1,socialMediaAdvertisingAllowed:!1};const{analytics:a,"general marketing and advertising":o,"performance and functionality":s,"social media advertising":r}=i;return{analyticsAllowed:a,generalMarketingAndAdvertisingAllowed:o,performanceAndFunctionalityAllowed:s,socialMediaAdvertisingAllowed:r}})().analyticsAllowed},mockableGetDate:()=>new Date},P=()=>{var e;const t=null===(e=null===document||void 0===document?void 0:document.cookie)||void 0===e?void 0:e.split("; ").find((e=>e.startsWith(M+"=")));return t?t.split("=")[1]:null},L=e=>`${M}=${e}; domain=.${x()}; expires=${(()=>{const e=O.mockableGetDate(),t=e.getTime()+15768e7;return e.setTime(t),e.toUTCString()})()}; Secure`,D=",";let N=0;const U=(e=!1)=>{const t=(e,t)=>{const n=[],i=document.head.querySelectorAll(`meta[${e}]`);return i?(Array.prototype.forEach.call(i,(i=>{try{const a=i.getAttribute(e);if(!a)return;t?n.push(...JSON.parse(a)):n.push(a)}catch{}})),n):[]};if(e&&N>1||!e&&N)return;N++,(()=>{const e=null===(t=document.head.getElementsByTagName("meta").namedItem("dbx:ux-variant-token"))||void 0===t?void 0:t.content;var t;if(!e)return;const n=B(e,"matchers"),i=[];for(const[e,t]of n){const n={feature_name:e,event_name:JSON.parse(t).event_name};i.push(n)}F({variant_tokens:e,matchers:i})})();const n=t("data-uxa-matcher-configs",!0),i=t("data-uxa-variant-tokens",!1);if(!n.length||!i.length)return;F({variant_tokens:i.join(D),matchers:n})},R=(e,t)=>{let n;n=e.startsWith("adobetarget")?"adobe_target_variants":"variants",t[n]?t[n]+=D+e:t[n]=e};function z(e){const t=(e,t)=>void 0===e||((e,t)=>{if(void 0===e)return!0;const n=e;for(const e in n)if(String(t[e])!==String(n[e]))return!1;return!0})(e.extra,t.extra);if("undefined"==typeof self||!self)return;let n;U();const i=self._DBX_UX_variants_configStore,a={};if(e&&i&&i.matchers&&e.eventName&&(n=i.matchers[e.eventName]))for(const o in n){if(!i.assignments||!n.hasOwnProperty(o))continue;const s=n[o],r=i.assignments[s.feature_name];r&&(void 0===a[r.variantToken]&&t(s.like,e)&&(e.extra||(e.extra={}),R(r.variantToken,e.extra),a[r.variantToken]=!0))}}const B=(e,t)=>{const n=((e,t)=>{const n=e=>decodeURIComponent(escape(e)),[i,a,o]=e.split(".").map((e=>atob(e.split("_").join("/").split("-").join("+"))));if(!o)return;if("JWT"!==JSON.parse(n(i)).typ)return;const s=JSON.parse(n(a)),r=s[t];return"https://dropbox.com/ux_analytics"===s.iss?r:void 0})(e,t),i=[];for(const e of n.split(D)){const t=e.split(":");2===t.length&&i.push(t.map(decodeURIComponent))}return i},V=e=>e.startsWith("adobetarget:")?(e=>{const t=e.split(D),n=[];for(const e of t)try{const[t,i,a]=e.split(":");n.push([t+":"+decodeURIComponent(i),decodeURIComponent(a)])}catch{continue}return n})(e):B(e,"variants");function F(e){if(!e)return;self._DBX_UX_variants_configStore=self._DBX_UX_variants_configStore||{};const t=self._DBX_UX_variants_configStore,{variant_tokens:n,matchers:i}=e;if(n)for(const e of n.split(D)){const n=V(e);if(n)for(const[i,a]of n)t.assignments=t.assignments||{},t.assignments[i]={variant:a,variantToken:e}}if(i)for(const e of i){t.matchers=t.matchers||{};const n=e.event_name;t.matchers[n]=t.matchers[n]||{};const i={feature_name:e.feature_name,event_name:n,is_pre_tti:e.is_pre_tti,like:e.like},a=JSON.stringify(i);t.matchers[n][a]=i}}const X={heartbeat:"heartbeat",linkClick:"link_click",elementClick:"element_click",linkNoSessionStorage:"link_no_session_storage",modalClose:"modal_close",modalOpen:"modal_open",pageView:"page_view",pageFreeze:"page_freeze",pageResume:"page_resume",scroll:"scroll_event",finalHeartbeat:"final_heartbeat",spaPageView:"spa_page_view",delayedPageViewWithLateMetaTag:"delayed_page_view_with_late_meta_tag",privacyConsentIframeLoaded:"privacy_consent_iframe_loaded",privacyConsentScriptLoaded:"privacy_consent_script_loaded",privacyConsentScriptLoadError:"privacy_consent_script_load_error",privacyConsentCookieValues:"privacy_consent_cookie_values",zoomChatIframeLoaded:"zoom_chat_iframe_loaded",zoomChatInitiated:"zoom_chat_initiated",zoomChatInitiationSuccess:"zoom_chat_initiation_success",zoomChatInitiationFailed:"zoom_chat_initiation_failed",zoomChatTimeOutFailed:"zoom_chat_timeout_failure",zoomChatNetworkFailed:"zoom_chat_network_failed",zoomChatMaximized:"zoom_chat_maximized",zoomChatMinimized:"zoom_chat_minimized",zoomChatEnded:"zoom_chat_ended",zoomChatRequested:"zoom_chat_requested",zoomChatInitialDisplay:"zoom_chat_initial_display",zoomChatLogoutByUser:"zoom_chat_logout_by_user",zoomChatConsentDeclined:"zoom_chat_consent_declined",zoomSalesChatDisallowedCountry:"zoom_sales_chat_disallowed_country",zoomSalesChatExperimentPresented:"zoom_sales_chat_experiment_presented",zoomStartNewChatButtonClicked:"zoom_start_new_chat_button_clicked",zoomSalesChatProactiveExperiment:"zoom_sales_chat_proactive_experiment",zoomchatLocalStorageStateMismatch:"zoom_chat_local_storage_state_mismatch",zoomChatCookieCleared:"zoom_chat_cookie_cleared",zoomchatlocalstoragecleared:"zoom_chat_local_storage_cleared",marketingTrackerReadyForUxa:"marketing_tracker_ready_for_uxa",mouseupElementClick:"mouseup_element_click",dialogOpen:"dialog_open",dialogClose:"dialog_close",documentOpen:"document_open",documentClose:"document_close",conversionDataReady:"conversionDataReady",legacy_hs_analytics_event:"legacy_hs_analytics_event",elementShown:"element_shown",elementHide:"element_hide",formFieldchange:"form_field_change",exceptionReport:"exception_report",decagonChatWidgetLoad:"decagon_chat_widget_load",decagonChatEmbeddedLoad:"decagon_chat_embedded_load"},H=["gclid","oqa","trigger","msclkid","_tk","_camp","_ad","_net","_kw","utm_campaign","utm_content","utm_medium","utm_source","utm_term","fbclid","tfo","desktop_logging_id","rdt_cid","key"],q="SPAHistoryStateChange",W=e=>{const t={detail:{eventSource:e}};var n;n=()=>{w(q,t)},(y._DBX_UXA_bufferedClosures=y._DBX_UXA_bufferedClosures||[]).push(n),k()},G=history.pushState,$=history.replaceState,Y=e=>{W("popState")},j={oldReplaceState:$,oldPushState:G,resetHistoryListenersInstalled:()=>{self._DBX_UXA_historyListenersInstalled=!1},getHistoryListenersInstalled:()=>self._DBX_UXA_historyListenersInstalled,installPushStateMonkeyPatch:()=>{Object.defineProperty(history,"pushState",{value:(e,t,n)=>{const i=location.pathname+location.hash;j.oldPushState.call(history,e,t,n);i!==location.pathname+location.hash&&W("pushState")},writable:!0})},installReplaceStateMonkeyPatch:()=>{Object.defineProperty(history,"replaceState",{value:(e,t,n)=>{const i=location.pathname+location.hash;j.oldReplaceState.call(history,e,t,n);i!==location.pathname+location.hash&&W("replaceState")},writable:!0})}},J=void 0!==self&&self?self:window;J._DBX_UXA_GLOBAL=J._DBX_UXA_GLOBAL||{};const K=J._DBX_UXA_GLOBAL;var Q;!function(e){e.BASE="BASE",e.TOP_FRAME="TOP_FRAME",e.CLIENT="CLIENT",e.NEED_TO_DEFINE="NEED_TO_DEFINE"}(Q||(Q={}));const Z=()=>{if(void 0===K.marketingTrackerLoggingQueue||void 0===K.logToMarketingTracker)return;let e;for(;(e=K.marketingTrackerLoggingQueue.shift())&&void 0!==e;)K.logToMarketingTracker(e)},ee="data-uxa-log",te="data-uxa-interactions",ne="[data-uxa-interactions]",ie="element_interaction_event";var ae,oe;function se(e=document.body,t=ne){const n=new Set;let i=null,a=s();const o=new MutationObserver((function(){if(null!==i)return;i=requestAnimationFrame((()=>{const e=s(),t=c(e,a);l(c(a,e)),function(e){n.forEach((t=>{t.addElements(e)}))}(t),a=e,i=null}))}));function s(){return Array.from(e.querySelectorAll(t)).filter((e=>e instanceof HTMLElement)).map((e=>e)).filter((e=>r(e)))}function r(e){var t;if(!e.hasAttribute(ee))return!1;const n=null===(t=e.getAttribute(te))||void 0===t?void 0:t.trim().split(/\s+/);return!!(null==n?void 0:n.includes("shown"))}function l(e){n.forEach((t=>{t.removeElements(e)}))}function c(e,t){return e.filter((e=>t.indexOf(e)<0))}function d(){o.observe(e,{childList:!0,subtree:!0})}return d(),{registerElementMutationListener:function(e){n.has(e)||(e.addElements(a),n.add(e))},unregisterElementMutationListener:function(e){n.has(e)&&(e.removeElements(a),n.delete(e))},purgeEventListeners:function(){l(a),n.clear()},pause:function(){o.disconnect()},resume:d,getElementsLength:function(){return a.length},testOnlyObserver:o,testOnlyIsEligibleForTracking:r,testOnlyDiffElements:c,testOnlyGetAnimationFrameRequest:function(){return i}}}function re(e=.5){const t=new Map,n=new IntersectionObserver((function(t){t.forEach((t=>{const n=t.target;t.intersectionRatio>=e&&i(n,oe.VIEWING),t.intersectionRatio<e&&i(n,oe.VIEWED)}))}),{threshold:e});function i(e,n){const i=e.getAttribute(ee),a=t.get(i);if(a)switch(n){case oe.VIEWING:a.status===oe.VIEWED&&(a.status=oe.VIEWING,a.lastViewStarted=performance.now(),w(ie,{detail:{eventType:ae.ELEMENT_SHOWN,extra:{...S(e)}}}));break;case oe.VIEWED:if(a.status===oe.VIEWING){const n=Math.round(performance.now()-a.lastViewStarted);window.requestAnimationFrame((()=>{var i;const o=e.getAttribute(ee),s=null===(i=t.get(o))||void 0===i?void 0:i.element;a.status!==oe.VIEWING||null!==s&&s!==e||(a.status=oe.VIEWED,w(ie,{detail:{eventType:ae.ELEMENT_HIDE,extra:{...S(e),element_shown_duration_ms:n}}}))}))}}}return{addElements:function(e){e.forEach((e=>function(e){const i=e.getAttribute(ee),a=t.get(i);a?a.element=e:t.set(i,{status:oe.VIEWED,element:e,lastViewStarted:0});n.observe(e)}(e)))},removeElements:function(e){e.forEach((e=>function(e){const a=e.getAttribute(ee),o=t.get(a);o&&(o.element=null,i(e,oe.VIEWED),n.unobserve(e))}(e)))},pause:function(){n.disconnect()},resume:function(){for(const[e,i]of t)(null==i?void 0:i.element)&&n.observe(i.element)},testOnlyTryUpdateElementStatus:i,testOnlyGetElementStatus:function(e){const n=t.get(e);return n?[n.element,n.status]:[null,null]}}}!function(e){e.ELEMENT_HIDE="elementHide",e.ELEMENT_SHOWN="elementShown"}(ae||(ae={})),function(e){e.VIEWING="VIEWING",e.VIEWED="VIEWED"}(oe||(oe={}));const le="clicked_link",ce="tracking_params",de="visit_id",ue="previous_url",he="last_active_time",_e="event_log",me="event_log_timestamp",ge={inAnIFrame:I},pe=new Set([_e,me,de]),fe=(()=>{let e=null;const t="uxa.onedoesnotsimplyusesessionstorage";try{e=window.sessionStorage,e&&(e.setItem(t,t),e.removeItem(t))}catch(t){e=null}return e})(),ve=(()=>{let e=null;const t=window;return e=t.hasOwnProperty("JSON")?t.JSON:null,e})();var Ee;!function(e){function t(e){return ge.inAnIFrame()&&!pe.has(e)?`uxa.inaniframe.${e}`:`uxa.${e}`}const n=fe,i=ve;function a(e){return n?(n.removeItem(t(e)),null):null}e.isEnabled=function(){return!!n},e.get=function(e){if(!n||!i)return null;try{const a=n.getItem(t(e));return null===a?null:i.parse(a)}catch(e){return null}},e.set=function(e,o){if(!n||!i)return null;try{return null===o?a(e):(n.setItem(t(e),i.stringify(o)),null)}catch(e){return null}},e.remove=a,e.clear=function(){return n?(n.clear(),null):null}}(Ee||(Ee={}));var ye;function ke(){return(new Date).getTime()}!function(e){e.Normal="normal",e.DbHistory="db_history",e.SpaNormal="spa_normal",e.SpaNormalOnDbHistoryPage="spa_normal_on_db_history_page"}(ye||(ye={}));const we={idGeneratingNow:ke,testableTimeOnPageNow:ke,testablePerformanceNow:performance.now.bind(performance),inAnIFrame:I,getCurrentURI:function(e=window){return e.location.href},getEventGuid:function(){return n.UUID.v4()},isDropboxDomain:b,getVerticalOffset:function(){const e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)},getScrollPercent:function(){const e=document.documentElement,t=document.body,n="scrollTop",i="scrollHeight",a=(e[n]||t[n])/((e[i]||t[i])-e.clientHeight)*100;return Math.round(a)},uxaIsEssential:T,isFileProtocol:function(){return"file:"===window.location.protocol}},Ie=e=>{var t;const n=`data-uxa-${e}`,i=null===(t=document.querySelector(`meta[${n}]`))||void 0===t?void 0:t.getAttribute(n);return i||null};function xe(e,t,n={}){let i=null,a=0;return function(){const o=ke();a||!1!==n.leading||(a=o);const s=t-(o.valueOf()-a.valueOf());let r=arguments;if(s<=0||s>t)i&&(clearTimeout(i),i=null),a=o,e.apply(null,r),r=null;else if(!i&&!1!==n.trailing){const t=()=>{a=!1===n.leading?0:ke(),i=null,e.apply(null,r),r=null};i=setTimeout(t,s)}}}function be(){const e={},t=function(e=window){return e.location.search}();if(t.length){const n=t.substring(1).replace(/&amp;/g,"&").split("&");for(const t of n){let[n,i]=t.split("=");n&&i&&(n=n.trim(),i=i.trim(),n.length&&i.length&&(e[n]=decodeURIComponent(i.replace(/\+/g," "))))}}return e}function Te(e,t){var n;const i=null===(n=e.getAttribute("data-uxa-interactions"))||void 0===n?void 0:n.trim().split(/\s+/);return t.every((e=>null==i?void 0:i.includes(e)))}function Se(e){return e&&e instanceof HTMLElement&&e.hasAttribute("data-uxa-log")&&(!e.hasAttribute("data-uxa-interactions")||Te(e,["click"]))}function Ce(e){return e&&e instanceof HTMLElement&&"A"===e.nodeName}function Ae(e){return e&&e.getAttribute("data-trackingid")}function Me(e){return e&&"BODY"===e.nodeName}function Oe(){return Math.random().toString().slice(2)}const Pe=new Set(Object.keys(X).map((e=>X[e]))),Le=/\/account|\/share|\/buy|\/pro\/try/;const De=["element_id","link_id","uxa_v","instance_event_count","instance_init_ts","event_ts","client_event_id","uxa_debug_version"];function Ne(e,t){return t[e]?(t[e]+"_"+e).toLowerCase().replace(/[^a-z0-9$\[\].]+/g,"_"):e}class Ue{static initialize(e,t,n=null,i=!0){if(null===Ue.singleton)Ue.singleton=new Ue(e,t,i);else if(n){[["requestId",t.requestId,Ue.singleton.requestId],["orgReferrer",t.orgReferrer,Ue.singleton.orgReferrer],["httpReferrer",t.httpReferrer,Ue.singleton.httpReferrer],["configs.delayed_link_click_logging",t.delayed_link_click_logging,Ue.singleton.delayedLinkClickLogging],["configs.event_names",t.event_names,Ue.singleton.event_names],["configs.modal_class",t.modal_class,Ue.singleton.modalClass],["configs.shouldBeSentToMarketingTrackerVariables",t.shouldBeSentToMarketingTrackerVariables,Ue.singleton.shouldBeSentToMarketingTrackerVariables],["configs.isInternalIp",t.isInternalIp,Ue.singleton.isInternalIp],["configs.isUserDropboxAdmin",t.isUserDropboxAdmin,Ue.singleton.isUserDropboxAdmin],["configs.expEventsToExpIdMap",t.expEventsToExpIdMap,Ue.singleton.expEventsToExpIdMap],["configs.expDataFieldsToExpIdMap",t.expDataFieldsToExpIdMap,Ue.singleton.expDataFieldsToExpIdMap]].forEach((([e,t,i])=>{void 0!==t&&JSON.stringify(t)!==JSON.stringify(i)&&n(new Error(`UX Analytics initialize overload attempt; ${e} '${t}' !== '${i}'`))}))}return Ue.singleton}constructor(e,t,n=!0){var i,a,o;if(this.currentModalId=null,this.lastScrollOffset=0,this.scrollTimer=null,this.trackingParams=null,this.updateExternalIds=()=>{we.isDropboxDomain()||(this.externalTeamId=Ie("external-team-id"),this.externalUserId=Ie("external-user-id"),this.externalStableUserId=Ie("external-stable-user-id"))},this.startHeartbeat=()=>{for(const e of[2,5,10,15,30])setTimeout(this.logOnPage.bind(this,X.heartbeat),1e3*e);for(const e of[1,2,4,9])setTimeout(this.logOnPage.bind(this,X.heartbeat),60*e*1e3)},this.delayedInit=()=>{this.saveTrackingParams(),this.setupListeners(),this.logPageView(),this.logDelayedClickEvent(),function(){const e=se(),t=re();e.registerElementMutationListener(t)}()},this.getListeners=()=>[[window,"scroll",this.handleScroll],[window,"pageshow",this.handlePageShow],[window,"pagehide",this.handlePageClose],[document.body,"mousedown",this.handleMousedown],[document.body,"mouseup",this.handleMouseup],[document.body,"keydown",this.handleKeyboardEnter],[document,"modalOpened",this.trackModalShow],[document,"modalClosed",this.trackModalHide],[document,"freeze",this.handlePageFreeze],[document,"resume",this.handlePageResume],[document,"change",this.handleFormFieldChange],[document,"viewUpdate",e=>this.logViewUpdate(e)],[window,q,this.handleHistoryStateChange],[window,"delayed_page_view_with_late_meta_tag",this.handleDelayedPageViewEventWithLateMetaTags],[window,"zoom_chat_custom_event",this.handleZoomChatCustomEvent],[window,"privacy_consent_custom_event",this.handlePrivacyConsentCustomEvent],[window,"marketing_tracker_ready_for_uxa",this.handleMarketTrackerReadyEvent],[document,"dialog_custom_event",this.handleDialogCustomEvent],[document,"document_custom_event",this.handleDocumentCustomEvent],[window,ie,this.handleInteractionCustomEvent],[document,"exceptionReport",this.handleExceptionReport]],this.trackScrolling=()=>{this.scrollTimer&&clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(this.onScroll,500)},this.handleScroll=xe(this.trackScrolling,2e3,{leading:!0}),this.onScroll=()=>{const e=we.getVerticalOffset();this.lastScrollOffset!==e&&(this.lastScrollOffset=e,this.logOnPage(X.scroll,{vertical_offset:e,scroll_percent:we.getScrollPercent()}))},this.handleFormFieldChange=e=>{const t=e.target;if(!Te(t,["change"]))return;const n=t.type.toLowerCase(),i={...S(t),input_type:n};"checkbox"!==n&&"radio"!==n||(i.input_checked=t.checked);const a=this.createEvent(X.formFieldchange,i);this.logEvent(a)},this.handlePageShow=e=>{if(this.navigationType=(()=>{var e;const t=null===(e=performance.getEntriesByType("navigation"))||void 0===e?void 0:e[0];return null==t?void 0:t.type})(),this.bfcacheEligible=e.persisted,e.persisted){if(this.cleanSessionStorage(),!we.inAnIFrame()){const e=Ee.get(ue);Ee.set(ue,we.getCurrentURI()),this.previousUrl=e}this.visitId=Ee.get(de),setTimeout(this.delayedInit,200)}},this.handlePageClose=e=>{const t={};t.vertical_offset=t.vertical_offset||we.getVerticalOffset(),t.time_on_page=t.time_on_page||this.getTimeOnPage(),t.spa_relative_time_on_page_ms=t.spa_relative_time_on_page_ms||this.getTimeOnPageMs(),this.logEvent(this.createEvent(X.finalHeartbeat,t))},this.handleElementClick=(e,t,n)=>{const i=function(e){let t=e;for(let e=0;e<12&&!Se(t)&&!Me(t);e++){const e=t.parentNode;if(!(e instanceof Element))break;t=e}return t}(e.target);if(!Se(i))return;const a=i,o=a.getBoundingClientRect(),s=this.createEvent(t,{...S(a),left:Math.round(o.left),time_on_page:this.getTimeOnPage(),spa_relative_time_on_page_ms:this.getTimeOnPageMs(),top:Math.round(o.top),vertical_offset:we.getVerticalOffset(),click_source:n});if("offsetX"in e&&"offsetY"in e){const t=e,n=e.target;s.extra.position_pct_X=Math.round(t.offsetX/n.offsetWidth*100),s.extra.position_pct_Y=Math.round(t.offsetY/n.offsetHeight*100)}this.logEvent(s)},this.handleLinkClick=e=>{const t=function(e){let t=e;for(let e=0;e<12&&!Ce(t)&&!Ae(t)&&!Me(t);e++){const e=t.parentNode;if(!(e instanceof Element))break;t=e}return t}(e.target);if(!Ce(t)&&!Ae(t))return;const n=t,i=n.getBoundingClientRect(),a=this.createEvent(X.linkClick,{left:Math.round(i.left),link_id:n.getAttribute("data-trackingid"),link_rank:this.getLinkRank(n),origin_href:n.getAttribute("href"),time_on_page:this.getTimeOnPage(),spa_relative_time_on_page_ms:this.getTimeOnPageMs(),top:Math.round(i.top),vertical_offset:we.getVerticalOffset(),tag_name:n.tagName.toLowerCase()});this.delayedLinkClickLogging&&Ce(n)?this.storeDelayedLinkClick(a):this.logEvent(a)},this.handleHistoryStateChange=e=>{if(!we.inAnIFrame()){const e=Ee.get(ue);Ee.set(ue,we.getCurrentURI()),this.previousUrl=e}++this.requestSeq;const t=we.getCurrentURI(),n=(i=t,Le.test(i)?ye.SpaNormalOnDbHistoryPage:ye.SpaNormal);var i;this.logPageView(n,e.detail.eventSource)},this.handleDelayedPageViewEventWithLateMetaTags=e=>{U(!0),this.updateExternalIds(),this.logEvent(this.createEvent(X.delayedPageViewWithLateMetaTag))},this.handlePrivacyConsentCustomEvent=e=>{this.logEvent(this.createEvent(X[e.detail.eventType],e.detail.extra))},this.handleZoomChatCustomEvent=e=>{this.logEvent(this.createEvent(X[e.detail.eventType],e.detail.extra))},this.handleDialogCustomEvent=e=>{this.logEvent(this.createEvent(X[e.detail.eventType],e.detail.extra))},this.handleDocumentCustomEvent=e=>{this.logEvent(this.createEvent(X[e.detail.eventType],e.detail.extra))},this.handleMousedown=e=>{this.handleLinkClick(e),this.handleElementClick(e,X.elementClick,"click")},this.handleMouseup=e=>{},this.handleKeyboardEnter=e=>{13===e.keyCode&&(this.handleLinkClick(e),this.handleElementClick(e,X.elementClick,"enter"))},this.handleMarketTrackerReadyEvent=e=>{this.logEvent(this.createEvent(X[e.detail.eventType],e.detail.extra))},this.handlePageFreeze=()=>{this.logEvent(this.createEvent(X.pageFreeze))},this.handlePageResume=()=>{this.logEvent(this.createEvent(X.pageResume))},this.handleInteractionCustomEvent=e=>{this.logEvent(this.createEvent(X[e.detail.eventType],e.detail.extra))},this.onExceptionReport=e=>{const t=e.detail.exception_message||"";this.logEvent(this.createEvent(X.exceptionReport,{exception_message:t.substring(0,512)}))},this.handleExceptionReport=xe(this.onExceptionReport,2e3,{leading:!0}),this._modalIdSanitizer=e=>{const t="db-modal-custom-";if("upsell-home-modal"===e.id){const n=Array.from(e.classList).find((e=>e.indexOf(t)>-1));if(n)return n.replace(t,"")}return e.id},this.trackModalShow=()=>{const e=document.querySelectorAll(this.modalClass),t=Array.from(e).find((e=>"none"!==window.getComputedStyle(e).display||e.classList.contains("clean-react-modal")||e.classList.contains("uxa-modal-tracking-span")));t&&(this.currentModalId=this._modalIdSanitizer(t)||"n/a -- file bug to cgi-team",this.logModal(X.modalOpen,this.currentModalId))},this.trackModalHide=()=>{this.currentModalId&&(this.logModal(X.modalClose,this.currentModalId),this.currentModalId=null)},"PITHOS"===t.inclusionMethod||we.isDropboxDomain()){if(self._DBX_UXA_historyListenersInstalled||(j.installPushStateMonkeyPatch(),j.installReplaceStateMonkeyPatch(),window.addEventListener("popstate",Y),self._DBX_UXA_historyListenersInstalled=!0),this.cleanSessionStorage(),!we.inAnIFrame()){const e=Ee.get(ue)||t.previousUrl;Ee.set(ue,we.getCurrentURI()),this.previousUrl=e}this.instance_event_count=0,this.instance_init_ts=we.idGeneratingNow(),this.requestId=t.requestId,this.orgReferrer=t.orgReferrer,this.httpReferrer=t.httpReferrer,this.visitId=Ee.get(de),this.requestSeq=0,this.event_names=t.event_names,this.logger=e,this.cmsPageUuid=document.body.getAttribute("data-article-uuid"),this.bfcacheEligible=!1,void 0!==t.delayed_link_click_logging?this.delayedLinkClickLogging=t.delayed_link_click_logging:this.delayedLinkClickLogging=!0,void 0!==t.modal_class?this.modalClass=t.modal_class:this.modalClass=".uxa-modal",void 0!==t.shouldBeSentToMarketingTrackerVariables?this.shouldBeSentToMarketingTrackerVariables=t.shouldBeSentToMarketingTrackerVariables:this.shouldBeSentToMarketingTrackerVariables=De,this.isInternalIp=!!t.isInternalIp,this.isUserDropboxAdmin=!!t.isUserDropboxAdmin,this.expEventsToExpIdMap=null!==(i=t.expEventsToExpIdMap)&&void 0!==i?i:{},this.expDataFieldsToExpIdMap=null!==(a=t.expDataFieldsToExpIdMap)&&void 0!==a?a:{},this.inclusionMethod=null!==(o=t.inclusionMethod)&&void 0!==o?o:"need_to_define",this.configTime=Number(t.configTime)||0,this.analyticsId=t.analyticsId,this.updateExternalIds(),this.initTime=we.testableTimeOnPageNow(),this.initTimeMs=we.testablePerformanceNow(),this.startHeartbeat(),this.appName=Ie("app-name")||"",this.appPath=Ie("app-path")||"",this.appIsEntitled=(t.entitledApps||[]).includes(this.appName),n?setTimeout(this.delayedInit,200):this.delayedInit()}}canUseDevTools(){return(this.isInternalIp||this.isUserDropboxAdmin)&&"PITHOS"!==this.inclusionMethod}setupListeners(){this.getListeners().forEach((([e,t,n])=>{e.addEventListener(t,n)})),y._DBX_UXA_isUxaListening=!0,k()}cleanupListeners(){this.getListeners().forEach((([e,t,n])=>{e.removeEventListener(t,n)}))}cleanSessionStorage(){const e=ke(),t=Ee.get(de),n=Ee.get(he);null===t?Ee.set(de,Oe()):null!==n&&e-n>=18e5&&(Ee.remove(ue),Ee.set(de,Oe())),Ee.set(he,e)}logPageView(e=ye.Normal,t){const n={page_view_latency:-100,bfcache_eligible:this.bfcacheEligible,navigation_type:this.navigationType,page_view_origin:e,hierarchy_group:document.body.getAttribute("data-uxa-hierarchy-group")};if(t&&(n.spa_source=t),this.configTime>0){const e=Math.round((this.instance_init_ts-this.configTime)/1e3);n.page_view_latency=e<=10?e:11,this.configTime=-1}else 0===this.configTime&&(n.page_view_latency=-10,this.configTime=-1);this.logEvent(this.createEvent(X.pageView,n)),this.initTimeMs=we.testablePerformanceNow()}logModal(e,t){const n={modal:t};this.logOnPage(e,n,!0)}logViewUpdate(e){const{viewId:t,viewStep:n}=e.detail,i={view:t,view_step:n};this.logOnPage("view_update",i,!0)}logDelayedClickEvent(){if(!Ee.isEnabled())return null;const e=Ee.get(le);if(e)try{e.destination_url=we.getCurrentURI();const t={eventName:X.linkClick,extra:e};this.logEvent(t),Ee.remove(le)}catch(e){}return null}logOnPage(e,t={},n=!1){(this.getTimeOnPage()<600||n)&&this.logEvent(this.createEvent(e,t))}async logEvent(t){var n;try{if(!(e=>Pe.has(e))(t.eventName))throw new Error(`UXAnalytics.log: trying to log an invalid event (${t.eventName})`);void 0!==z&&z(t);const i=we.idGeneratingNow();"loading"===document.readyState&&await new Promise((function(e){if("interactive"===document.readyState||"complete"===document.readyState)e();else{function t(){document.removeEventListener("DOMContentLoaded",t),e()}document.addEventListener("DOMContentLoaded",t)}})),t.extra.instance_event_count=++this.instance_event_count,t.extra.instance_init_ts=this.instance_init_ts,t.extra.event_ts=i,t.extra.client_event_id=we.getEventGuid(),this.getWARPInfo()&&(t.extra.warp_variants=this.getWARPInfo());let a={};a=function(e,t,n){const i={};for(const[a,o]of Object.entries(e))t.includes(a)&&(i["uxa_"+Ne(a,n)]=o);return i}(t.extra,this.shouldBeSentToMarketingTrackerVariables,this.expDataFieldsToExpIdMap);((e,t)=>{t.uxa_event_type=e,K.marketingTrackerLoggingQueue=K.marketingTrackerLoggingQueue||[],K.marketingTrackerLoggingQueue.push(t)})(Ne(t.eventName,this.expEventsToExpIdMap),a),(e=>{if(!O.analyticsTrackingIsAllowed())return;if(null===P()){const t=L(e);document.cookie=t}})(this.analyticsId),we.isDropboxDomain()||(t.extra.external_team_id=this.externalTeamId,t.extra.external_user_id=this.externalUserId,t.extra.external_stable_user_id=this.externalStableUserId),t.extra.app_name=this.appName;const o=P();if(o&&(t.extra.analytics_id=o),(we.isDropboxDomain()||P()||this.appIsEntitled)&&this.logger.log(t.eventName,t.extra,!0,this.event_names,{}),this.canUseDevTools()){const i=parseFloat(String(Ee.get(me)));if(i<=Date.now()){const e=1e3,a=(Array.isArray(Ee.get(_e))&&null!==(n=Ee.get(_e))&&void 0!==n?n:[]).filter((e=>{var t;return parseFloat(String(null===(t=null==e?void 0:e.extra)||void 0===t?void 0:t.event_ts))>=i})).concat(t).slice(-e);Ee.set(_e,a)}else Array.isArray(Ee.get(_e))&&Ee.remove(_e);try{await new Promise((function(t,n){e(["./c_ux_analytics_styles_devtools"],t,n)}))}catch(e){throw new Error("UXAnalytics.log: failed to load devtools.module.css")}}}catch(e){throw e}}maybeSanitizeAppName(e){return e&&e.startsWith("file:")&&this.appPath&&this.appName?e.replace(this.appPath,`<electron-app-${this.appName}>`):e}createEvent(e,t={}){this.orgReferrer&&(t.org_referrer=this.maybeSanitizeAppName(this.orgReferrer)),this.visitId&&(t.visit_id=this.visitId),t.request_seq=this.requestSeq,this.httpReferrer&&(t.http_referrer=this.maybeSanitizeAppName(this.httpReferrer)),this.previousUrl&&(t.previous_url=this.maybeSanitizeAppName(this.previousUrl)),this.cmsPageUuid&&(t.cms_page_uuid=this.cmsPageUuid),t.request_id=t.request_id||this.requestId,t.url=this.maybeSanitizeAppName(t.url||we.getCurrentURI()),location.hash&&(t.hash_fragment=location.hash),t.uxa_v=2.2,t.uxa_debug_version="2024-02-06T01:01:01",t.uxa_inclusion_method=this.inclusionMethod;const n=this.getTimeOnPage(),i=this.getTimeOnPageMs();if(t.vertical_offset=t.vertical_offset||we.getVerticalOffset(),t.time_on_page=t.time_on_page||n,t.spa_relative_time_on_page_ms=t.spa_relative_time_on_page_ms||i,this.trackingParams)for(const e of Object.keys(this.trackingParams)){const n=e.replace(/^_/,""),i=this.trackingParams[e];t[`param_${n}`]=i}return{eventName:e,extra:t}}storeDelayedLinkClick(e){if(!Ee.isEnabled())return this.logOnPage(X.linkNoSessionStorage),!1;try{Ee.set(le,e.extra)}catch(e){return!1}return!0}saveTrackingParams(){const e=this.getTrackingParams();Object.keys(e).length?(Ee.set(ce,e),this.trackingParams=e):this.trackingParams=null}getTrackingParams(){const e=Ee.get(ce)||{},t=be();for(const n of H)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}getWARPInfo(){var e;return this.warpInfo=this.warpInfo||(null===(e=document.head.getElementsByTagName("meta").namedItem("dbx:warp-metadata-token"))||void 0===e?void 0:e.content),this.warpInfo||null}getTimeOnPageMs(){return we.testablePerformanceNow()-this.initTimeMs}getTimeOnPage(){return Math.round((we.testableTimeOnPageNow()-this.initTime)/1e3)}getLinkRank(e){const t=e.getAttribute("href"),n=document.querySelectorAll(`a[href="${t}"]`);if(1===n.length)return 1;for(let t=0;t<n.length;t++)if(n[t]===e)return t+1;return-1}}Ue.singleton=null;class Re{constructor(e){this.metricsReporter=e}logEventCount(e,t,n,i=1){const a={};for(const e in n)n.hasOwnProperty(e)&&(a[e]=n[e]);this.metricsReporter.createStats({ns:e,name:t},a).record(i)}}let ze;function Be(e){var t,i,a;const o=null!==(t=null==e?void 0:e.path)&&void 0!==t?t:"/log/ux_analytics",s=null!==(i=null==e?void 0:e.routeParams)&&void 0!==i?i:{},r=null!==(a=null==e?void 0:e.base)&&void 0!==a?a:window.location.origin;return new n.AjaxURL(n.replacePattern(o,s),r)}var Ve;!function(e){e.SUGGESTION_ACCEPTED="suggest_invite_modal_accepted",e.SUGGESTION_DISMISSED="suggest_invite_modal_dismissed",e.SUGGESTION_MODAL_OPENED="suggest_invite_modal_opened"}(Ve||(Ve={}));const Fe={modal_open:["modal"],modal_close:["modal"],link_click:["link_id"],link_no_session_storage:["link_id"],element_click:["element_id"],page_view:["page"]},Xe={log(e,t,a,o,r){const l=[["AMP",()=>{if(o&&o.includes(e)){const n={};if(t&&e in Fe){Fe[e].forEach((e=>{e in t&&t[e]&&(n[e]=String(t[e]))}))}(ze||(ze=new Re(i.getMetricsReporter())),ze).logEventCount("uxa_events",e,n)}}],["UXA-Backend",()=>{const i={url:Be(),data:{event_type:e,extra_params:JSON.stringify(t)}};a?n.SilentBackgroundBeaconRequest(i):n.SilentBackgroundRequest(i)}],["marketing-tracker",Z]];for(const[n,i]of l)try{i()}catch(i){s.reportException({err:i,severity:s.SEVERITY.NONCRITICAL,tags:["ux_analytics",n],exc_extra:{extra_params:t,event_type:e}})}}};var He,qe;!function(e){e.BUY_TRY_PAGE_CHECKOUT="buy_try_page_checkout",e.INFO_FORM_FILLED="info_form_filled",e.PAYMENT_FORM_FILLED="payment_form_filled",e.BUY_TRY_PAGE_CHECKOUT_CRASH="buy_try_page_checkout_crash",e.PORTABLE_CHECKOUT_IFRAME_INITIALIZED="portable_checkout_iframe_initialized"}(He||(He={})),function(e){e.PRO="pro",e.PLUS="plus",e.BUY_TOP="buy_top",e.BUY_BOTTOM="buy_bottom",e.BUSINESS="business",e.PRO_TRY="pro_try",e.BUY_PLUS="buy_plus",e.BUY_MOBILE="buy_mobile"}(qe||(qe={})),t.initialize=function(e){Ue.initialize(Xe,e,(function(e){s.reportException({err:e,severity:s.SEVERITY.CRITICAL,tags:["ux_analytics"]})}))}}));
//# sourceMappingURL=c_ux_analytics_www_init.js-vflp4xKx1.map

//# debugId=d9e31e2b-18e2-32ee-88a9-1a6faac0247f