!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="90497e61-6dbb-36ce-b8da-97714acc4780")}catch(e){}}();
define(["exports","./e_ui_page_files_router","./c_flows_logging_flows_loggers","./e_core_exception","./c_lodash-es_lodash"],(function(e,t,o,r,l){"use strict";var i,a;function n(e,o,r){const l={update_rules_arg:{".tag":"update_folder_rules_arg",folder_fq_path:e,rule_set:o,apply_to_existing_files:r}};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("update_rules",l,{})}e.Actions=void 0,(i=e.Actions||(e.Actions={})).GetUserAutomations="AUTOMATIONS/GET_USER_AUTOMATIONS",i.SetUserAutomations="AUTOMATIONS/SET_USER_AUTOMATIONS",i.AddUserAutomation="AUTOMATIONS/ADD_USER_AUTOMATION",i.EditUserAutomation="AUTOMATIONS/EDIT_USER_AUTOMATION",i.RemoveUserAutomation="AUTOMATIONS/REMOVE_USER_AUTOMATION",i.MergeUserAutomations="AUTOMATIONS/MERGE_USER_AUTOMATIONS",i.ToggleAutomationStatus="TOGGLE_AUTOMATION_STATUS",i.SetUserExperiments="AUTOMATIONS/SET_USER_EXPERIMENTS",i.SetShouldSubscribeToBolt="AUTOMATIONS/SET_SHOULD_SUBSCRIBE_TO_BOLT",i.InitWorkflowBuilder="AUTOMATIONS/INIT_WORKFLOW_BUILDER",i.TearDownWorkflowBuilder="AUTOMATIONS/TEAR_DOWN_WORKFLOW_BUILDER",i.SetWorkflowBuilderOperation="AUTOMATIONS/SET_WORKFLOW_BUILDER_OPERATION",i.UpdateWorkflowActionStep="AUTOMATIONS/UPDATE_WORKFLOW_ACTION_STEP",i.DeleteWorkflowActionStep="AUTOMATIONS/DELETE_WORKFLOW_ACTION_STEP",i.UpdateWorkflowTriggerStep="AUTOMATIONS/UPDATE_WORKFLOW_TRIGGER_STEP",i.SetWorkflowBuilderActions="AUTOMATIONS/SET_WORKFLOW_BUILDER_ACTIONS",i.GetWorkflowStepsConfig="AUTOMATIONS/GET_WORKFLOW_STEPS_CONFIG",i.SetWorkflowStepsConfig="AUTOMATIONS/SET_WORKFLOW_STEPS_CONFIG",i.SetWorkflowBuilderWidth="AUTOMATIONS/SET_WORKFLOW_BUILDER_WIDTH",i.SetWorkflowBuilderApplyToExisting="AUTOMATIONS/SET_WORKFLOW_BUILDER_APPLY_TO_EXISTING",i.SetWorkflowBuilderInheritable="AUTOMATIONS/SET_WORKFLOW_BUILDER_INHERITABLE",i.UpdateWorkflowBuilderIsEnabled="AUTOMATINONS/UPDATE_WORKFLOW_BUILDER_IS_ENABLED",i.UpdateWorkflowBuilderPreviewAction="AUTOMATINONS/UPDATE_WORKFLOW_BUILDER_PREVIEW_ACTION",i.UpdateSavedWorkflowTemplateState="AUTOMATIONS/UPDATE_SAVED_WORKFLOW_TEMPLATE_STATE",i.UpdateSavedWorkflowTemplateName="AUTOMATIONS/UPDATE_SAVED_WORKFLOW_TEMPLATE_NAME",i.UpdateSavedWorkflowTemplateOptOut="AUTOMATIONS/UPDATE_SAVED_WORKFLOW_TEMPLATE_OPT_OUT",i.UpdateSavedWorkflowTemplates="AUTOMATIONS/UPDATE_SAVED_WORKFLOW_TEMPLATES",i.SetInheritanceBlockingFqPaths="AUTOMATIONS/SET_INHERITANCE_BLOCKING_FQ_PATHS",e.TestTarget=void 0,(a=e.TestTarget||(e.TestTarget={})).ADD_FOLDER_RULES_MODAL="flows-add-folder-rules-modal",a.ADD_FOLDER_RULES_MODAL_CANCEL="flows-add-folder-rules-modal-cancel",a.ADD_FOLDER_RULES_MODAL_CONFIRM="flows-add-folder-rules-modal-confirm",a.ADD_FOLDER_RULES_MODAL_FOLDER_NAME_INPUT="flows-add-folder-rules-modal-folder-name-input",a.ADD_FOLDER_RULES_MODAL_SUGGESTION_LINK="flows-add-folder-rules-modal-suggestion-link",a.AUTOMATED_FOLDER_MODAL="flows-folder-automation-modal",a.AUTOMATED_FOLDER_MODAL_CANCEL="flows-folder-automation-modal-cancel",a.AUTOMATED_FOLDER_MODAL_INVALID_NAME="flows-folder-automation-modal-invalid-name",a.AUTOMATED_FOLDER_MODAL_NEXT="flows-folder-automation-modal-next",a.AUTOMATED_FOLDER_MODAL_TOOLTIP_CONTAINER="flows-folder-automation-modal-tooltip_container",a.AUTOMATED_FOLDER_MODAL_BACK="flows-folder-automation-modal-back",a.AUTOMATED_FOLDER_MODAL_SUBMIT="flows-folder-automation-modal-submit",a.FILE_CONVERSION_INPUT_TYPE_SELECT="flows-file-conversion-input-type-select",a.FILE_CONVERSION_FORMAT_SELECT="flows-file-conversion-format-select",a.FOLDER_RULES_SETTINGS_MODAL="flows-folder-rules-settings-modal",a.FOLDER_RULES_SETTINGS_MODAL_CANCEL="flows-folder-rules-settings-modal-cancel",a.FOLDER_RULES_SETTINGS_MODAL_MENU="flows-folder-rules-settings-modal-menu",a.FOLDER_RULES_SETTINGS_MODAL_CHANGE_TO_BASIC="flows-folder-rules-settings-modal-change-to-basic",a.FOLDER_RULES_SETTINGS_MODAL_TOGGLE_RULE="flows-folder-rules-settings-modal-toggle-rule",a.FOLDER_RULES_SETTINGS_MODAL_TOGGLE_PDF="flows-folder-rules-settings-modal-toggle-pdf",a.FREEFORM_FEEDBACK_MODAL="freeform-feedback-modal",a.FREEFORM_FEEDBACK_MODAL_SUBMIT="freeform-feedback-modal-submit",a.FREEFORM_FEEDBACK_MODAL_CLOSE="freeform-feedback-modal-close",a.FREEFORM_FEEDBACK_MODAL_FEEDBACK_INPUT="freeform-feedback-modal-feedback-input",a.FLOWS_BADGE_TOOLTIP="flows-badge-tooltip",a.FLOWS_BADGE="flows-badge",a.AUTOMATED_FOLDER_TOGGLE_TEXT="flows-folder-automation-toggle-text",a.DASHBOARD_OVERVIEW_VIDEO_THUMBNAIL="flows-dashboard-overview-video-thumbnail",a.DASHBOARD_OVERVIEW_VIDEO_LIGHTBOX="flows-dashboard-overview-video-lightbox",a.VIDEO_TO_GIF_MODAL_CLOSE="flows-video-to-gif-modal-close",a.VIDEO_TO_GIF_MODAL_SUBMIT="flows-video-to-gif-modal-submit",a.VIDEO_TO_GIF_TITLE="flows-video-to-gif-modal-title",a.AUTOMATION_PREVIEW_PORTAL="flows-automation-preview-portal",a.WORKFLOW_BUILDER_LAYER_PORTAL="flows-workflow-builder-layer-portal-content",a.SAVED_WORKFLOW_TEMPLATE_PREVIEW="flows-saved-workflow-template-preview",a.SAVED_WORKFLOW_TEMPLATE_INVALID_NAME="flows-saved-workflow-template-invalid-name",a.SAVED_WORKFLOW_TEMPLATE_SAVE_INFO_ICON="flows-saved-workflow-template-save-info-icon";var s,d;!function(e){e.ABOUT_FOLDER_RULES="https://help.dropbox.com"}(s||(s={})),function(e){e.SUPPORT="/support"}(d||(d={}));const u=["audio_conversion","image_conversion","move_file","naming_conventions","pdf_conversion","tag","tidy_up","unzip","video_conversion","watermarking"];var _;!function(e){e.HOURLY="HOURLY",e.SIXHOURS="SIXHOURS",e.DAILY="DAILY",e.WEEKLY="WEEKLY",e.IMMEDIATELY="IMMEDIATELY"}(_||(_={}));const c=["audio_conversion","image_conversion","naming_conventions","pdf_conversion","smart_subfolders","tag","tidy_up","unzip","video_conversion","watermarking","move_file"],f=["file_add","scheduled"],p={file_op:{".tag":"file_add"},".tag":"file_op"},A={triggerType:"file_add",data:{}};function w(e){var t;const o=e.workflow_template?e.workflow_template.sequence[0].workflow_action:null===(t=e.action)||void 0===t?void 0:t.action;if(o){const{".tag":e,...t}=o;if("other"!==e)return{actionType:e,data:t};throw new Error(`Received invalid action ${e} from API v2`)}throw new Error("Missing action in payload from API v2")}function E(e){var t;const o=null===(t=e.trigger)||void 0===t?void 0:t.trigger;if(!o)return A;{const{".tag":e,...t}=o;switch(e){case"file_op":if("file_op"in t&&t.file_op&&"file_add"===t.file_op[".tag"])return A;throw new Error("Received invalid file_op trigger from API v2");case"scheduled":return{triggerType:e,data:t};default:throw new Error(`Received invalid trigger ${e} from API v2`)}}}function T({actionType:e,data:t}){switch(e){case"pdf_conversion":return{".tag":"pdf_conversion",...t};case"unzip":return{".tag":"unzip",...t};case"tag":return{".tag":"tag",...t};case"smart_subfolders":return{".tag":"smart_subfolders",...t};case"image_conversion":return{".tag":"image_conversion",...t};case"video_conversion":return{".tag":"video_conversion",...t};case"tidy_up":return{".tag":"tidy_up",...t};case"naming_conventions":return{".tag":"naming_conventions",...t};case"audio_conversion":return{".tag":"audio_conversion",...t};case"watermarking":return{".tag":"watermarking",...t};case"move_file":return{".tag":"move_file",...t};default:throw new Error(`Undefined .tag ${e}`)}}function g({triggerType:e,data:t}){switch(e){case"file_add":return p;case"scheduled":return{".tag":"scheduled",...t};default:throw new Error(`Undefined trigger .tag ${e}`)}}const m=e=>e.length>1?"multi_step":1===e.length?e[0].actionType:void 0;function O(e,t,o=A){return{enabled:t,action:{action:T(e)},trigger:{trigger:g(o)}}}async function S({actions:e,applyToExistingFiles:t,enabled:r,fqPath:l,papEventProperties:i,trigger:a,inheritable:s}){if(e.length>0&&e.every((e=>{return t=e.actionType,c.includes(t);var t}))&&(d=a.triggerType,f.includes(d)))return o.PapLogger.logInitiateAutoFolderModalUpdateAutomation({actionTag:m(e),workflowTemplate:D(e),seqLength:e.length,applyToExisting:t,...i}),n(l,F({actions:e,inheritable:s,isEnabled:r,trigger:a}),t).then((t=>(o.PapLogger.logSucceedAutoFolderModalUpdateAutomation({actionTag:m(e),workflowTemplate:D(e),seqLength:e.length,...i}),t)),(t=>{throw o.PapLogger.logFailAutoFolderModalUpdateAutomation({actionTag:m(e),workflowTemplate:D(e),seqLength:e.length,...i}),t}));var d;throw new Error(`Undefined action .tag ${e} or trigger .tag ${a}`)}function v(e){return u.includes(e)}function U(e){const t=e.split("/");return t[t.length-1]}function R({workflow_action:e}){if(!e)return;const{".tag":t,...o}=e;return v(t)?{actionType:t,data:o}:void 0}function I(e){var t;const o=null===(t=e.workflow_template)||void 0===t?void 0:t.sequence;return o?o.reduce(((e,t)=>{const o=R(t);return o&&e.push(o),e}),[]):e.action?[w(e)]:[]}function L(e){return{workflow_action:{".tag":e.actionType,...e.data}}}function D(e){return{sequence:e.map(L)}}function k({actions:e,isEnabled:t=!0,trigger:o,inheritable:r}){const l={enabled:t,inheritable:r,workflow_template:{sequence:e.map(L)}};return o&&(l.trigger=function({triggerType:e,data:t}){switch(e){case"file_add":return{trigger:p};case"scheduled":return{trigger:{".tag":"scheduled",...t}};default:throw new Error(`Undefined trigger .tag ${e}`)}}(o)),l}function F(e){return{rules:[k(e)]}}var h=Object.freeze({__proto__:null,DEFAULT_API_V2_FOLDER_TRIGGER:p,DEFAULT_CLIENT_FOLDER_TRIGGER:A,getActionTypeFromActions:m,getApiV2FolderAction:T,getApiV2FolderTrigger:g,getClientFolderActionFromFolderRule:w,getClientFolderTriggerFromFolderRule:E,getClientFolderTriggerFromFolderRuleResult:function(e){var t,o,r,l;const i=null===(o=null===(t=e.folder_rule_set)||void 0===t?void 0:t.rules)||void 0===o?void 0:o[0];if(!i)return;const a=null===(r=i.trigger)||void 0===r?void 0:r.trigger;if(a){const t={folderName:e.fq_path?U(e.fq_path):void 0,fqPath:e.fq_path,nsId:e.ns_id},{".tag":o,...r}=a;switch(o){case"file_op":return"file_op"in r&&"file_add"===(null===(l=r.file_op)||void 0===l?void 0:l[".tag"])?{...A,...t}:void 0;case"scheduled":return{triggerType:o,data:r,...t};default:return}}},getClientWorkflowActionFromApiWorkflowAction:R,getClientWorkflowActionsFromFolderRule:I,getClientWorkflowActionsFromFolderRuleResult:function(e){var t,o;const r=null===(o=null===(t=e.folder_rule_set)||void 0===t?void 0:t.rules)||void 0===o?void 0:o[0];return r?I(r):[]},getFlowsMapValueFromFolderRule:function(e){var t,o,r,l;const i=null===(t=e.workflow_template)||void 0===t?void 0:t.sequence;if(i&&i.length>0){const e=null===(o=i[0].workflow_action)||void 0===o?void 0:o[".tag"];if(e&&v(e))return e}const a=null===(l=null===(r=e.action)||void 0===r?void 0:r.action)||void 0===l?void 0:l[".tag"];if(a&&v(a))return a},getFolderName:U,isValidWorkflowAction:v,makeApiWorkflowAction:L,makeFolderRule:O,makeFolderRuleFromClientWorkflow:k,makeFolderRuleSet:function(e,t,o=A){return{rules:[O(e,t,o)]}},makeFolderRuleSetFromClientWorkflow:F,makeWorkflowTemplate:D,updateFolderRule:S});const P="flows-saved-workflow-template",M=["ai","azw4","binder","djvu","doc","docm","docx","dwg","eps","epub","fdr","fdx","gdoc","gslides","mobi","odp","odt","paper","papert","pps","ppsm","ppsx","ppt","pptm","pptx","ps","rtf","wpd"].concat(["bmp","j2c","j2k","jp2","jpc","jpeg","jpf","jpg","jpg2","jpm","jpx","png","ppm","tga","tif","tiff"]);var N;e.UI_EXPERIMENTS=void 0,(N=e.UI_EXPERIMENTS||(e.UI_EXPERIMENTS={})).SAVED_WORKFLOW_TEMPLATE_CREATE="flows_saved_workflow_template_create",N.ADOPTION_UI_VARIANT="flows_automation_adoption_experience";const W={doc:160,docx:160,docm:160,dot:160,dotx:160,dwg:100,epub:30,mobi:30,azw4:30,djvu:30,ai:256,eps:256,ps:256,gdoc:160,gslides:288,odt:160,odp:160,rtf:160,wpd:160,binder:200,paper:200,papert:200,ppt:288,pps:288,ppsx:288,ppsm:288,pptx:288,pptm:288,fdr:40,fdx:40,bmp:256,j2c:256,j2k:256,jp2:256,jpc:256,jpeg:256,jpf:256,jpg:256,jpg2:256,jpm:256,jpx:256,png:256,ppm:256,tga:256,tif:256,tiff:256},b={ai:W.ai,azw4:W.azw4,binder:W.binder,djvu:W.djvu,doc:W.doc,docm:W.docm,docx:W.docx,dwg:W.dwg,eps:W.eps,epub:W.epub,gdoc:W.gdoc,gslides:W.gslides,mobi:W.mobi,odp:W.odp,odt:W.odt,paper:W.paper,papert:W.papert,pps:W.pps,ppsm:W.ppsm,ppsx:W.ppsx,ppt:W.ppt,pptm:W.pptm,pptx:W.pptx,ps:W.ps,rtf:W.rtf,wpd:W.wpd,pdf:500,bmp:100,gif:100,heic:100,j2c:100,j2k:100,jp2:100,jpc:100,jpeg:100,jpf:100,jpg:100,jpg2:100,jpm:100,jpx:100,png:100,ppm:100,psd:1024,svg:48,tga:100,tif:100,tiff:100,wbmp:100,webp:100,"3fr":200,arw:200,cr2:200,cr3:200,crw:200,dcr:200,dcs:200,dng:200,erf:200,kdc:200,mef:200,mos:200,mrw:200,nef:200,nrw:200,orf:200,pef:200,r3d:200,raf:200,rw2:200,rwl:200,sr2:200,x3f:200};function B(e,o){const r=function(e,o){return t.filename(e.fqPath).toLocaleLowerCase().localeCompare(t.filename(o.fqPath).toLocaleLowerCase())}(e,o);return 0!==r?r:(l=e.fqPath,i=o.fqPath,l.toLocaleLowerCase().localeCompare(i.toLocaleLowerCase()));var l,i}function C(e){const t=new Map;return e.forEach((e=>{t.set(e.fqPath,e)})),t}function G(e,t,o,r){var l,i;const a=[],n=e.rules;if(n&&n.length>0){const e=n[0],r=null===(l=e.action)||void 0===l?void 0:l.action,s=null===(i=e.trigger)||void 0===i?void 0:i.trigger,d=e.workflow_template;(r||d)&&s&&a.push(y(e,t,o))}return a.sort(B),a}function V(e){var t,o,r,l,i;if(!e.err&&(null===(t=e.folder_rule_set)||void 0===t?void 0:t.rules)&&(null===(o=e.folder_rule_set)||void 0===o?void 0:o.rules.length)>0){const t=null===(r=e.folder_rule_set)||void 0===r?void 0:r.rules[0],o=null===(l=t.action)||void 0===l?void 0:l.action,a=null===(i=t.trigger)||void 0===i?void 0:i.trigger,n=t.workflow_template;if(!o&&!n||!a)return;if(e.fq_path)return y(t,e.fq_path,e.ns_id)}}function y(e,t,o,r){return{actions:I(e),fqPath:t,inheritable:!!e.inheritable,inheritedFromFqPath:r,isEnabled:!!e.enabled,nsId:o,trigger:E(e)}}const x={userAutomations:{status:"initial"},userExperiments:{status:"initial"},shouldSubscribeToBolt:!1,workflowStepsConfig:{status:"initial"},inheritanceBlockingFqPaths:new Set};e.AMP_NAMESPACE="flows_js",e.AutomationsReducer=(t=x,o)=>{var r,i;switch(o.type){case e.Actions.SetUserAutomations:return{...t,userAutomations:o.payload};case e.Actions.AddUserAutomation:{const e="completed"===t.userAutomations.status?t.userAutomations.data:void 0;if(!e)return t;const r=function(e,t){let o=0;for(const r of e.values()){if(B(t,r)<0)break;o++}const r=Array.from(e.entries());return r.splice(o,0,[t.fqPath,t]),new Map(r)}(e,o.payload);return{...t,userAutomations:{status:"completed",data:r}}}case e.Actions.EditUserAutomation:case e.Actions.ToggleAutomationStatus:{const e="completed"===t.userAutomations.status?t.userAutomations.data:void 0;if(!e)return t;const r=o.payload,l=new Map(e);if(l.has(r.fqPath)){const e=l.get(r.fqPath);l.set(r.fqPath,{...e,...r})}return{...t,userAutomations:{status:"completed",data:l}}}case e.Actions.RemoveUserAutomation:{const e="completed"===t.userAutomations.status?t.userAutomations.data:void 0;if(!e)return t;const r=o.payload,l=new Map(e);return l.delete(r.fqPath),{...t,userAutomations:{status:"completed",data:l}}}case e.Actions.MergeUserAutomations:{let e;return e="completed"!==t.userAutomations.status?o.payload:function(e,t){const o=new Map,r=e.entries(),l=t.entries();let i=r.next(),a=l.next();for(;!i.done||!a.done;)if(i.done){const[e,t]=a.value;o.set(e,t),a=l.next()}else if(a.done){const[e,t]=i.value;o.set(e,t),i=r.next()}else{const[e,t]=i.value,[n,s]=a.value;B(t,s)<=0?(o.set(e,t),i=r.next()):(o.set(n,s),a=l.next())}return o}(t.userAutomations.data,o.payload),{...t,userAutomations:{status:"completed",data:e}}}case e.Actions.SetUserExperiments:return{...t,userExperiments:o.payload};case e.Actions.SetShouldSubscribeToBolt:return{...t,shouldSubscribeToBolt:o.payload};case e.Actions.InitWorkflowBuilder:return{...t,workflowBuilder:o.payload};case e.Actions.TearDownWorkflowBuilder:return{...t,workflowBuilder:void 0};case e.Actions.SetWorkflowBuilderOperation:{const e=t.workflowBuilder;return e?{...t,workflowBuilder:{...e,operation:o.payload}}:t}case e.Actions.UpdateWorkflowActionStep:{const e=t.workflowBuilder;if(!e||!e.actions)return t;const r=e.actions.findIndex((e=>e.id===o.payload.id));if(-1===r)return t;const i=e.actions[r],{id:a,...n}=o.payload.action,s={...i,...n};if(l.isEqual(i,s))return t;const d=[...e.actions];return d[r]={...d[r],...s},{...t,workflowBuilder:{...e,actions:d}}}case e.Actions.DeleteWorkflowActionStep:{const e=t.workflowBuilder;if(!e||!e.actions)return t;const r=e.actions.filter((e=>e.id!==o.payload.id));return{...t,workflowBuilder:{...e,actions:r}}}case e.Actions.UpdateWorkflowTriggerStep:{const e=t.workflowBuilder;if(!e)return t;if(null==o.payload)return{...t,workflowBuilder:{...e,trigger:void 0}};if(!(null==e?void 0:e.trigger))return t;const r={...e.trigger,...o.payload};return{...t,workflowBuilder:{...e,trigger:r}}}case e.Actions.SetWorkflowBuilderActions:{const e=t.workflowBuilder;return e?{...t,workflowBuilder:{...e,actions:o.payload}}:t}case e.Actions.SetWorkflowStepsConfig:return{...t,workflowStepsConfig:o.payload};case e.Actions.SetWorkflowBuilderWidth:{const e=t.workflowBuilder;return e?{...t,workflowBuilder:{...e,width:o.payload}}:t}case e.Actions.SetWorkflowBuilderApplyToExisting:{const e=t.workflowBuilder;return e?{...t,workflowBuilder:{...e,applyToExistingFiles:o.payload}}:t}case e.Actions.SetWorkflowBuilderInheritable:{const e=t.workflowBuilder;return e?{...t,workflowBuilder:{...e,inheritable:o.payload}}:t}case e.Actions.UpdateWorkflowBuilderIsEnabled:return{...t,...t.workflowBuilder&&{workflowBuilder:{...t.workflowBuilder,isEnabled:o.payload}}};case e.Actions.UpdateWorkflowBuilderPreviewAction:return{...t,...t.workflowBuilder&&{workflowBuilder:{...t.workflowBuilder,previewActionId:o.payload}}};case e.Actions.UpdateSavedWorkflowTemplateState:return{...t,...t.workflowBuilder&&{workflowBuilder:{...t.workflowBuilder,savedWorkflowTemplateState:o.payload}}};case e.Actions.UpdateSavedWorkflowTemplateName:return{...t,...t.workflowBuilder&&{workflowBuilder:{...t.workflowBuilder,savedWorkflowTemplateState:t.workflowBuilder.savedWorkflowTemplateState&&{...t.workflowBuilder.savedWorkflowTemplateState,name:o.payload}}}};case e.Actions.UpdateSavedWorkflowTemplateOptOut:return"A"===(null===(i=null===(r=t.workflowBuilder)||void 0===r?void 0:r.savedWorkflowTemplateState)||void 0===i?void 0:i.variant)?t:{...t,...t.workflowBuilder&&t.workflowBuilder.savedWorkflowTemplateState&&{workflowBuilder:{...t.workflowBuilder,savedWorkflowTemplateState:{...t.workflowBuilder.savedWorkflowTemplateState,optOut:o.payload}}}};case e.Actions.UpdateSavedWorkflowTemplates:return{...t,savedWorkflowTemplates:o.payload};case e.Actions.SetInheritanceBlockingFqPaths:return{...t,inheritanceBlockingFqPaths:new Set([...t.inheritanceBlockingFqPaths,...o.payload])};default:return t}},e.DEFAULT_CLIENT_FOLDER_TRIGGER=A,e.EXCLOG_TAG_BROWSE_ROOT="flows-browse-root",e.EXCLOG_TAG_MODAL="auto-folder-modal",e.EXCLOG_TAG_OWNER="dbx-owner:workflow-automation",e.EXCLOG_TAG_SAVED_WORKFLOW_TEMPLATE=P,e.EXCLOG_TAG_SEARCH_ROOT="flows-search-root",e.FEEDBACK_FORM_MAX_COMMENT_LENGTH=5e3,e.FOLDER_NAME_MAX_LENGTH=255,e.IMAGE_CONVERSION_FILE_SIZE_LIMIT_MAP=b,e.MEDIA_REMUX_FILE_SIZE_LIMIT=2048,e.MODAL_DEFAULT_WIDTH=600,e.MODAL_FULL_WIDTH=1200,e.MODAL_LAYER_PORTAL_SELECTOR="flows-workflow-builder-layer-portal-selector",e.MODAL_PREVIEW_PORTAL_SELECTOR="flows-modal-preview-portal-selector",e.PDF_CONVERSION_FILE_SIZE_LIMIT_MAP=W,e.SUPPORTED_AUDIO_INPUT_EXTENSIONS=["aac","aif","aiff","flac","m4a","m4r","mp3","oga","ogg","wav","wma"],e.SUPPORTED_AUDIO_OUTPUT_CONTAINERS=["mp3","wav","m4a"],e.SUPPORTED_DOC_INPUT_EXTENSIONS=["ai","azw4","binder","djvu","doc","docm","docx","dwg","eps","epub","gdoc","gslides","mobi","odp","odt","paper","papert","pps","ppsm","ppsx","ppt","pptm","pptx","ps","rtf","wpd","pdf"],e.SUPPORTED_IMAGE_INPUT_EXTENSIONS=["bmp","gif","heic","j2c","j2k","jp2","jpc","jpeg","jpf","jpg","jpg2","jpm","jpx","png","ppm","psd","svg","tga","tif","tiff","wbmp","webp","3fr","arw","cr2","cr3","crw","dcr","dcs","dng","erf","kdc","mef","mos","mrw","nef","nrw","orf","pef","r3d","raf","rw2","rwl","sr2","x3f"],e.SUPPORTED_IMAGE_OUTPUT_EXTENSIONS=["jpg","png"],e.SUPPORTED_PDF_EXTENSIONS=M,e.SUPPORTED_SCALE_RESOLUTIONS=[360,720,1080,1440,2160],e.SUPPORTED_SEGMENT_CONCAT_EXTENSIONS=["3g2","3gp","3gpp","3gpp2","asf","avi","dv","flv","m2t","m2ts","m4v","mkv","mov","mp4","mpeg","mpg","mts","mxf","oggtheora","ogv","rm","ts","vob","webm","wmv"],e.SUPPORTED_UNZIP_EXTENSIONS=["7z","bz","bz2","cpio","gz","iso","lha","lz","lzh","lzma","rar","tar","taz","tbz","tbz2","tgz","tlz","txz","tz","xar","xz","z","zip"],e.SUPPORTED_VIDEO_INPUT_EXTENSIONS=["mov","mp4","m4v","avi","mkv","mpeg","mpg"],e.SUPPORTED_VIDEO_OUTPUT_CONTAINERS=["mp4","mov"],e.SUPPORTED_WATERMARKING_EXTENSIONS=["jpeg","jpg","bmp","pdf","png"],e.api_helpers_esnext=h,e.buildAutomationDataFromGetRuleBatchResult=function(e){var t;let o=[];if("folder_rule_batch_result"===(null===(t=e.get_rule_batch_result)||void 0===t?void 0:t[".tag"])){o=function(e){const t=[];for(const o of e){const e=V(o);e&&t.push(e)}return t}((null==e?void 0:e.get_rule_batch_result.folder_rule_results)||[])}return o.sort(B),C(o)},e.commitAutoWatermarkBlocks=function(e,o){const r={filename:e,block_tokens:o};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("auto_watermark_hidden_ns",r,{})},e.convertFolderRuleToAutomation=y,e.convertSubfolderRulesResultToAutomations=function(e,t){const o=e.inherited_rule_set_result,r=e.rule_set_results,l=[];if((null==o?void 0:o.rule_set)&&(null==o?void 0:o.fq_path)){const e=G(o.rule_set,o.fq_path,t);l.push(...e)}if(r)for(const e of r)l.push(...G(e.rule_set,e.fq_path,t));return C(l)},e.createFolder=function(e,r,l){const i={path:e},a=t.UUID.v4(),n=e=>{const o=t.PAP_Create_Folder({eventState:e,folderType:"folder",actionSurface:r,actionElement:l,createFolderModalVersion:"legacy"}),i={eventState:"start"!==e?e:void 0,key:a,tags:{folder_type:"folder",action_surface:r||"unknown",action_element:l||"unknown",create_folder_modal_version:"legacy"}};"start"===e?t.UDCL.logStart(o,i):t.UDCL.logEnd(o,i)};return n("start"),o.PapLogger.logInitiateAutoFolderModalFolderCreate(),t.GetFilesRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("create_folder_v2",i,{}).then((e=>(n("success"),o.PapLogger.logSucceedAutoFolderModalFolderCreate(),e)),(e=>{throw n("failed"),o.PapLogger.logFailAutoFolderModalFolderCreate(),e}))},e.createSavedWorkflowTemplate=function(e,o){const r={template:e,name:o};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("saved_workflow_template/create",r,{})},e.createSavedWorkflowTemplateObject=function(e){var t;const o=[];try{const r=null===(t=e.workflow_template)||void 0===t?void 0:t.sequence;if(r&&r.forEach((e=>{const t=R(e);t&&o.push(t)})),o)return{name:e.name,templateId:e.template_id,clientWorkflowActions:o}}catch(e){r.reportException({err:e,force:!0,tags:[P],severity:"non-critical"})}},e.defaultAutomationsState=x,e.deleteFolderRules=function(e){const o={delete_arg:{".tag":"delete_folder_rule_arg",folder_fq_path:e}};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("delete_rule",o,{})},e.deleteSavedWorkflowTemplate=function(e){const o={template_id:e};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("saved_workflow_template/delete",o,{})},e.getActionTypeFromActions=m,e.getFolderMetadata=function(e){const o={path:e};return t.GetFilesRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("get_metadata",o,{})},e.getFolderName=U,e.getFolderRules=function(e){const o={get_rule_arg:{".tag":"get_folder_rule_arg",folder_fq_path:e}};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("get_rule",o,{})},e.getFolderRulesBatch=function(e){const o={get_rule_batch_arg:{".tag":"get_folder_rule_batch_arg",folder_fq_paths:e}};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("get_rule_batch",o,{})},e.getFolderRulesConfig=function(){return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("get_folder_rules_config",void 0,{})},e.getInheritanceBlockingFqPathResult=function(e){const t=e.inherited_rule_set_result;return(null==t?void 0:t.fq_path)&&!(null==t?void 0:t.rule_set)?[t.fq_path]:[]},e.getPreviewDataByFileIds=function(e){const o={file_ids:[e]};return t.GetPreviewsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("get_preview_data_by_file_ids_batch",o,{})},e.getSavedWorkflowTemplates=function(e){const o={include_deleted:e};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("saved_workflow_template/list",o,{})},e.getSubfolderRules=function(e,o){const r={folder_fq_path:e,inheritance_enabled:o};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("get_subfolder_rules",r,{})},e.getUserExperiments=function(e){const o={features:e};return t.getGatingClientSingleton(t.mustGetActiveUserApiV2Properties()).getVariant(o)},e.isInherited=function(e){return!!e.inheritedFromFqPath},e.logFreeformFeedback=function(e,o,r){const l={log_feedback_arg:{".tag":"log_freeform_feedback_arg",freeform_feedback:e,folder_fq_path:o,feedback_source:r}};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("log_feedback",l,{})},e.makeFolderRuleSetFromClientWorkflow=F,e.makeWorkflowTemplate=D,e.removeFolderRules=function(e,o){const r={remove_rules_arg:{".tag":"remove_folder_rules_arg",folder_fq_path:e,rule_set:o}};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("remove_rules",r,{})},e.submitFileWorkflow=function(e,o,r){const l={template:e,file_ids:o,shared_link_url:r};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("submit_file_workflow",l,{})},e.undoActions=function(e,o){const r={creates:e,moves:o};return t.GetFlowsRoutes(new t.DefaultUserApiV2Client(t.mustGetActiveUserApiV2Properties())).rpc("undo_actions",r,{})},e.updateFolderRule=S,e.updateFolderRules=n}));
//# sourceMappingURL=c_flows_redux_reducer.js-vflQ53-1K.map

//# debugId=90497e61-6dbb-36ce-b8da-97714acc4780