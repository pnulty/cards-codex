!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="42e2acde-9a3b-3136-b278-6103ff5a4e31")}catch(e){}}();
define(["exports","./e_ui_page_files_router","./c_sharing_sharing_pap_logging_copy_shared_link_util","./c_sharing_sharing_pap_logging_common_util","./c_pap-events_share_copy_shared_link","./c_sharing_sharing_pap_logging_shared_link_util"],(function(e,n,t,i,l,o){"use strict";const a=async e=>{const{eventState:l,actionSurface:a,actionElement:r,requestedAccessLevel:s,content:d,contentAction:c,isSm24:u}=e,v=((e,l,o,a,r,s,d)=>{const c=null==r?void 0:r.isDir,u=t.getSharedLinkRequestedAccessLevelFromString(o),v=c?n.getFolderTypeFromString(i.FILE_TYPE_TO_FOLDER_TYPE[null==r?void 0:r.type]):void 0,_=null==r?void 0:r.nsId,h=null==r?void 0:r.fileId,g=c||null==r?void 0:r.ext;return{eventState:e,actionSurface:l,actionElement:a,contentAction:s?n.getContentActionFromString(s):void 0,folderType:v,sharedLinkRequestedAccessLevel:u,isDir:c,includeNsCreation:!1,nsId:_,hasCachedLink:!1,contentIdentifier:h,fileExtension:g,shareModalType:d?i.getShareModalTypeFromString("sm24"):void 0}})(l,a,s,r,d,c,u);let _;if("success"===l&&e.metadata&&e.httpCode){const{metadata:i,httpCode:l}=e;_=await(async(e,i)=>{var l;const a={},r=null==e?void 0:e.url,s=n.getLinkTypeFromUrl(null!=r?r:"");a.httpStatusCode=i,a.createdNewLink=200===i,a.linkType=s;const d="scl"===s?o.getAccessLevelFromLinkAccessLevel(null===(l=null==e?void 0:e.link_permissions)||void 0===l?void 0:l.link_access_level):"viewer";if(a.sharedLinkResolvedAccessLevel=t.getSharedLinkResolvedAccessLevelFromString(d),a.sharedLinkIdentifier=null==e?void 0:e.id,"scl"===s){const{rlkey:e,sckey:t,senderTrackey:i,encryptedRecipientInfo:l}=n.getKeysFromSclUrl(null!=r?r:"");a.rlkeySha1=e?await n.sha1Hash(e):void 0,a.sckeySha1=t?await n.sha1Hash(t):void 0,a.stkey=i,a.encryptedRecipientInfoSha1=l?await n.sha1Hash(l):void 0}else if("s"===s||"sh"===s){const{tkey:e,senderTrackey:t}=n.getKeysFromShmodelUrl(null!=r?r:"");a.tkeySha1=e?await n.sha1Hash(e):void 0,a.stkey=t}return a})(i,l)}else if("failed"===l||"rejected"===l){const{exception:n,httpCode:i}=e;_=((e,n)=>{const i={};return i.httpStatusCode=n,i.createSharedLinkErrorReason=t.getCreateSharedLinkErrorReasonFromString(o.COPY_LINK_EXCEPTION_TO_CREATE_SHARED_LINK_ERROR_REASON[e]),i})(n,i)}return(e=>{const n={};for(const t in e)null===e[t]?n[t]=void 0:n[t]=e[t];return n})({...v,..._})};e.getContentFromContentInfoAndMetadata=(e,n)=>{var t,l,o,a,r;const s=e.isFolder(),d=i.getContentType(e);let c,u;try{c=e.isSharedFolder()?e.sharedFolderId():void 0}catch(e){c=void 0}e.ext()?u=e.ext():(e.filename()||e.displayPath()||(null==n?void 0:n.name))&&(u=i.getFileExtensionFromFileName(null!==(l=null!==(t=e.filename())&&void 0!==t?t:e.displayPath())&&void 0!==l?l:null==n?void 0:n.name));return{type:d,isDir:s,nsId:c,ext:u,fileId:null!==(r=null!==(a=null!==(o=null==n?void 0:n.folder_id)&&void 0!==o?o:null==n?void 0:n.id)&&void 0!==a?a:e.fileId())&&void 0!==r?r:void 0}},e.getFileIdOrPath=e=>e.fileId()||e.displayPath()||"",e.logPAPCreateSharedLinkEvent=async e=>{var t;const i=await a(e),{eventState:o,fileIdOrPath:r,loggingKey:s,isSm24:d,actionSurface:c,actionElement:u,screen:v}=e,_=l.PAP_Create_SharedLink(i);let h={};i&&d&&(h={isSm24:"true",screen:null!=v?v:"unknown",actionSurfaceAndElement:`${null!=c?c:"unknown"}___${null!=u?u:"unknown"}`,...i.isDir&&{folderType:null!==(t=i.folderType)&&void 0!==t?t:"unknown"}});const g={isDir:(null==i?void 0:i.isDir)?"true":"false",...h};"start"===o?n.UDCL.logStart(_,{key:s||r,tags:g}):n.UDCL.logEnd(_,{key:s||r,tags:{createdNewLink:(null==i?void 0:i.createdNewLink)?"true":"false",...g},eventState:o})}}));
//# sourceMappingURL=c_sharing_sharing_pap_logging_create_shared_link_util.js-vflQ88hWc.map

//# debugId=42e2acde-9a3b-3136-b278-6103ff5a4e31